function ge(){}function jc(n,e){for(const t in e)n[t]=e[t];return n}function $s(n){return n()}function Ur(){return Object.create(null)}function bt(n){n.forEach($s)}function Ws(n){return typeof n=="function"}function Le(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function Vc(n){return Object.keys(n).length===0}function Yc(n,...e){if(n==null)return ge;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Se(n,e,t){n.$$.on_destroy.push(Yc(e,t))}function zc(n,e,t,r){if(n){const s=Qs(n,e,t,r);return n[0](s)}}function Qs(n,e,t,r){return n[1]&&r?jc(t.ctx.slice(),n[1](r(e))):t.ctx}function Fc(n,e,t,r){if(n[2]&&r){const s=n[2](r(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const c=[],o=Math.max(e.dirty.length,s.length);for(let i=0;i<o;i+=1)c[i]=e.dirty[i]|s[i];return c}return e.dirty|s}return e.dirty}function Xc(n,e,t,r,s,c){if(s){const o=Qs(e,t,r,c);n.p(o,s)}}function $c(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let r=0;r<t;r++)e[r]=-1;return e}return-1}function Ne(n,e,t){return n.set(t),e}function f(n,e){n.appendChild(e)}function F(n,e,t){n.insertBefore(e,t||null)}function z(n){n.parentNode&&n.parentNode.removeChild(n)}function ht(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function u(n){return document.createElement(n)}function W(n){return document.createTextNode(n)}function O(){return W(" ")}function pt(){return W("")}function Ee(n,e,t,r){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}function m(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Wc(n){return Array.from(n.childNodes)}function J(n,e){e=""+e,n.data!==e&&(n.data=e)}function st(n,e){n.value=e??""}function Qc(n,e,{bubbles:t=!1,cancelable:r=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(n,t,r,e),s}let an;function fn(n){an=n}function Js(){if(!an)throw new Error("Function called outside component initialization");return an}function Jc(n){Js().$$.on_mount.push(n)}function Tn(){const n=Js();return(e,t,{cancelable:r=!1}={})=>{const s=n.$$.callbacks[e];if(s){const c=Qc(e,t,{cancelable:r});return s.slice().forEach(o=>{o.call(n,c)}),!c.defaultPrevented}return!0}}const jt=[],Mr=[];let Xt=[];const Kr=[],eo=Promise.resolve();let nr=!1;function to(){nr||(nr=!0,eo.then(ec))}function rr(n){Xt.push(n)}const Vn=new Set;let Kt=0;function ec(){if(Kt!==0)return;const n=an;do{try{for(;Kt<jt.length;){const e=jt[Kt];Kt++,fn(e),no(e.$$)}}catch(e){throw jt.length=0,Kt=0,e}for(fn(null),jt.length=0,Kt=0;Mr.length;)Mr.pop()();for(let e=0;e<Xt.length;e+=1){const t=Xt[e];Vn.has(t)||(Vn.add(t),t())}Xt.length=0}while(jt.length);for(;Kr.length;)Kr.pop()();nr=!1,Vn.clear(),fn(n)}function no(n){if(n.fragment!==null){n.update(),bt(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(rr)}}function ro(n){const e=[],t=[];Xt.forEach(r=>n.indexOf(r)===-1?e.push(r):t.push(r)),t.forEach(r=>r()),Xt=e}const In=new Set;let Nt;function Qe(){Nt={r:0,c:[],p:Nt}}function Je(){Nt.r||bt(Nt.c),Nt=Nt.p}function Q(n,e){n&&n.i&&(In.delete(n),n.i(e))}function ne(n,e,t,r){if(n&&n.o){if(In.has(n))return;In.add(n),Nt.c.push(()=>{In.delete(n),r&&(t&&n.d(1),r())}),n.o(e)}else r&&r()}function ue(n){n&&n.c()}function ie(n,e,t,r){const{fragment:s,after_update:c}=n.$$;s&&s.m(e,t),r||rr(()=>{const o=n.$$.on_mount.map($s).filter(Ws);n.$$.on_destroy?n.$$.on_destroy.push(...o):bt(o),n.$$.on_mount=[]}),c.forEach(rr)}function ae(n,e){const t=n.$$;t.fragment!==null&&(ro(t.after_update),bt(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function so(n,e){n.$$.dirty[0]===-1&&(jt.push(n),to(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Ze(n,e,t,r,s,c,o,i=[-1]){const l=an;fn(n);const a=n.$$={fragment:null,ctx:[],props:c,update:ge,not_equal:s,bound:Ur(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Ur(),dirty:i,skip_bound:!1,root:e.target||l.$$.root};o&&o(a.root);let d=!1;if(a.ctx=t?t(n,e.props||{},(b,_,...h)=>{const p=h.length?h[0]:_;return a.ctx&&s(a.ctx[b],a.ctx[b]=p)&&(!a.skip_bound&&a.bound[b]&&a.bound[b](p),d&&so(n,b)),_}):[],a.update(),d=!0,bt(a.before_update),a.fragment=r?r(a.ctx):!1,e.target){if(e.hydrate){const b=Wc(e.target);a.fragment&&a.fragment.l(b),b.forEach(z)}else a.fragment&&a.fragment.c();e.intro&&Q(n.$$.fragment),ie(n,e.target,e.anchor,e.customElement),ec()}fn(l)}class De{$destroy(){ae(this,1),this.$destroy=ge}$on(e,t){if(!Ws(t))return ge;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!Vc(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Cn(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function xr(n,...e){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(n.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${n.length}`)}function co(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Cn(n.outputLen),Cn(n.blockLen)}function Qt(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function tc(n,e){xr(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const Yn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const vr=n=>n instanceof Uint8Array,oo=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),zn=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),ut=(n,e)=>n<<32-e|n>>>e,fo=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!fo)throw new Error("Non little-endian hardware is not supported");const lo=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function Ye(n){if(!vr(n))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=lo[n[t]];return e}function en(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function hn(n){if(typeof n=="string"&&(n=en(n)),!vr(n))throw new Error(`expected Uint8Array, got ${typeof n}`);return n}function Br(...n){const e=new Uint8Array(n.reduce((r,s)=>r+s.length,0));let t=0;return n.forEach(r=>{if(!vr(r))throw new Error("Uint8Array expected");e.set(r,t),t+=r.length}),e}class Er{clone(){return this._cloneInto()}}function tn(n){const e=r=>n().update(hn(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function io(n){const e=(r,s)=>n(s).update(hn(r)).digest(),t=n({});return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=r=>n(r),e}function nn(n=32){if(Yn&&typeof Yn.getRandomValues=="function")return Yn.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}function ao(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const s=BigInt(32),c=BigInt(4294967295),o=Number(t>>s&c),i=Number(t&c),l=r?4:0,a=r?0:4;n.setUint32(e+l,o,r),n.setUint32(e+a,i,r)}class nc extends Er{constructor(e,t,r,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=zn(this.buffer)}update(e){Qt(this);const{view:t,buffer:r,blockLen:s}=this;e=hn(e);const c=e.length;for(let o=0;o<c;){const i=Math.min(s-this.pos,c-o);if(i===s){const l=zn(e);for(;s<=c-o;o+=s)this.process(l,o);continue}r.set(e.subarray(o,o+i),this.pos),this.pos+=i,o+=i,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Qt(this),tc(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:s,isLE:c}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let b=o;b<s;b++)t[b]=0;ao(r,s-8,BigInt(this.length*8),c),this.process(r,0);const i=zn(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const a=l/4,d=this.get();if(a>d.length)throw new Error("_sha2: outputLen bigger than state");for(let b=0;b<a;b++)i.setUint32(4*b,d[b],c)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:s,finished:c,destroyed:o,pos:i}=this;return e.length=s,e.pos=i,e.finished=c,e.destroyed=o,s%t&&e.buffer.set(r),e}}const uo=(n,e,t)=>n&e^~n&t,bo=(n,e,t)=>n&e^n&t^e&t,ho=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Bt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Et=new Uint32Array(64);class po extends nc{constructor(){super(64,32,8,!1),this.A=Bt[0]|0,this.B=Bt[1]|0,this.C=Bt[2]|0,this.D=Bt[3]|0,this.E=Bt[4]|0,this.F=Bt[5]|0,this.G=Bt[6]|0,this.H=Bt[7]|0}get(){const{A:e,B:t,C:r,D:s,E:c,F:o,G:i,H:l}=this;return[e,t,r,s,c,o,i,l]}set(e,t,r,s,c,o,i,l){this.A=e|0,this.B=t|0,this.C=r|0,this.D=s|0,this.E=c|0,this.F=o|0,this.G=i|0,this.H=l|0}process(e,t){for(let b=0;b<16;b++,t+=4)Et[b]=e.getUint32(t,!1);for(let b=16;b<64;b++){const _=Et[b-15],h=Et[b-2],p=ut(_,7)^ut(_,18)^_>>>3,g=ut(h,17)^ut(h,19)^h>>>10;Et[b]=g+Et[b-7]+p+Et[b-16]|0}let{A:r,B:s,C:c,D:o,E:i,F:l,G:a,H:d}=this;for(let b=0;b<64;b++){const _=ut(i,6)^ut(i,11)^ut(i,25),h=d+_+uo(i,l,a)+ho[b]+Et[b]|0,g=(ut(r,2)^ut(r,13)^ut(r,22))+bo(r,s,c)|0;d=a,a=l,l=i,i=o+h|0,o=c,c=s,s=r,r=h+g|0}r=r+this.A|0,s=s+this.B|0,c=c+this.C|0,o=o+this.D|0,i=i+this.E|0,l=l+this.F|0,a=a+this.G|0,d=d+this.H|0,this.set(r,s,c,o,i,l,a,d)}roundClean(){Et.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const it=tn(()=>new po);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const rc=BigInt(0),Nn=BigInt(1),_o=BigInt(2),Ln=n=>n instanceof Uint8Array,go=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function Ht(n){if(!Ln(n))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=go[n[t]];return e}function sc(n){const e=n.toString(16);return e.length&1?`0${e}`:e}function kr(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":`0x${n}`)}function Jt(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);const e=n.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let r=0;r<t.length;r++){const s=r*2,c=n.slice(s,s+2),o=Number.parseInt(c,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[r]=o}return t}function qe(n){return kr(Ht(n))}function $t(n){if(!Ln(n))throw new Error("Uint8Array expected");return kr(Ht(Uint8Array.from(n).reverse()))}function Re(n,e){return Jt(n.toString(16).padStart(e*2,"0"))}function un(n,e){return Re(n,e).reverse()}function mo(n){return Jt(sc(n))}function ke(n,e,t){let r;if(typeof e=="string")try{r=Jt(e)}catch(c){throw new Error(`${n} must be valid hex string, got "${e}". Cause: ${c}`)}else if(Ln(e))r=Uint8Array.from(e);else throw new Error(`${n} must be hex string or Uint8Array`);const s=r.length;if(typeof t=="number"&&s!==t)throw new Error(`${n} expected ${t} bytes, got ${s}`);return r}function Ie(...n){const e=new Uint8Array(n.reduce((r,s)=>r+s.length,0));let t=0;return n.forEach(r=>{if(!Ln(r))throw new Error("Uint8Array expected");e.set(r,t),t+=r.length}),e}function yo(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Gn(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function Wt(n){let e;for(e=0;n>rc;n>>=Nn,e+=1);return e}function Pt(n,e){return n>>BigInt(e)&Nn}const _t=(n,e,t)=>n|(t?Nn:rc)<<BigInt(e),rn=n=>(_o<<BigInt(n-1))-Nn,Fn=n=>new Uint8Array(n),Zr=n=>Uint8Array.from(n);function cc(n,e,t){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let r=Fn(n),s=Fn(n),c=0;const o=()=>{r.fill(1),s.fill(0),c=0},i=(...b)=>t(s,r,...b),l=(b=Fn())=>{s=i(Zr([0]),b),r=i(),b.length!==0&&(s=i(Zr([1]),b),r=i())},a=()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let b=0;const _=[];for(;b<e;){r=i();const h=r.slice();_.push(h),b+=r.length}return Ie(..._)};return(b,_)=>{o(),l(b);let h;for(;!(h=_(a()));)l();return o(),h}}const wo={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||n instanceof Uint8Array,isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,e)=>e.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function Ut(n,e,t={}){const r=(s,c,o)=>{const i=wo[c];if(typeof i!="function")throw new Error(`Invalid validator "${c}", expected function`);const l=n[s];if(!(o&&l===void 0)&&!i(l,n))throw new Error(`Invalid param ${String(s)}=${l} (${typeof l}), expected ${c}`)};for(const[s,c]of Object.entries(e))r(s,c,!1);for(const[s,c]of Object.entries(t))r(s,c,!0);return n}const xo=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Pt,bitLen:Wt,bitMask:rn,bitSet:_t,bytesToHex:Ht,bytesToNumberBE:qe,bytesToNumberLE:$t,concatBytes:Ie,createHmacDrbg:cc,ensureBytes:ke,equalBytes:yo,hexToBytes:Jt,hexToNumber:kr,numberToBytesBE:Re,numberToBytesLE:un,numberToHexUnpadded:sc,numberToVarBytesBE:mo,utf8ToBytes:Gn,validateObject:Ut},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Me=BigInt(0),Oe=BigInt(1),Tt=BigInt(2),vo=BigInt(3),sr=BigInt(4),Dr=BigInt(5),jr=BigInt(8);BigInt(9);BigInt(16);function we(n,e){const t=n%e;return t>=Me?t:e+t}function Bo(n,e,t){if(t<=Me||e<Me)throw new Error("Expected power/modulo > 0");if(t===Oe)return Me;let r=Oe;for(;e>Me;)e&Oe&&(r=r*n%t),n=n*n%t,e>>=Oe;return r}function ve(n,e,t){let r=n;for(;e-- >Me;)r*=r,r%=t;return r}function cr(n,e){if(n===Me||e<=Me)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=we(n,e),r=e,s=Me,c=Oe;for(;t!==Me;){const i=r/t,l=r%t,a=s-c*i;r=t,t=l,s=c,c=a}if(r!==Oe)throw new Error("invert: does not exist");return we(s,e)}function Eo(n){const e=(n-Oe)/Tt;let t,r,s;for(t=n-Oe,r=0;t%Tt===Me;t/=Tt,r++);for(s=Tt;s<n&&Bo(s,e,n)!==n-Oe;s++);if(r===1){const o=(n+Oe)/sr;return function(l,a){const d=l.pow(a,o);if(!l.eql(l.sqr(d),a))throw new Error("Cannot find square root");return d}}const c=(t+Oe)/Tt;return function(i,l){if(i.pow(l,e)===i.neg(i.ONE))throw new Error("Cannot find square root");let a=r,d=i.pow(i.mul(i.ONE,s),t),b=i.pow(l,c),_=i.pow(l,t);for(;!i.eql(_,i.ONE);){if(i.eql(_,i.ZERO))return i.ZERO;let h=1;for(let g=i.sqr(_);h<a&&!i.eql(g,i.ONE);h++)g=i.sqr(g);const p=i.pow(d,Oe<<BigInt(a-h-1));d=i.sqr(p),b=i.mul(b,p),_=i.mul(_,d),a=h}return b}}function ko(n){if(n%sr===vo){const e=(n+Oe)/sr;return function(r,s){const c=r.pow(s,e);if(!r.eql(r.sqr(c),s))throw new Error("Cannot find square root");return c}}if(n%jr===Dr){const e=(n-Dr)/jr;return function(r,s){const c=r.mul(s,Tt),o=r.pow(c,e),i=r.mul(s,o),l=r.mul(r.mul(i,Tt),o),a=r.mul(i,r.sub(l,r.ONE));if(!r.eql(r.sqr(a),s))throw new Error("Cannot find square root");return a}}return Eo(n)}const Io=(n,e)=>(we(n,e)&Oe)===Oe,So=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function oc(n){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=So.reduce((r,s)=>(r[s]="function",r),e);return Ut(n,t)}function Un(n,e,t){if(t<Me)throw new Error("Expected power > 0");if(t===Me)return n.ONE;if(t===Oe)return e;let r=n.ONE,s=e;for(;t>Me;)t&Oe&&(r=n.mul(r,s)),s=n.sqr(s),t>>=Oe;return r}function Mn(n,e){const t=new Array(e.length),r=e.reduce((c,o,i)=>n.is0(o)?c:(t[i]=c,n.mul(c,o)),n.ONE),s=n.inv(r);return e.reduceRight((c,o,i)=>n.is0(o)?c:(t[i]=n.mul(c,t[i]),n.mul(c,o)),s),t}function fc(n,e){const t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function yt(n,e,t=!1,r={}){if(n<=Me)throw new Error(`Expected Field ORDER > 0, got ${n}`);const{nBitLength:s,nByteLength:c}=fc(n,e);if(c>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=ko(n),i=Object.freeze({ORDER:n,BITS:s,BYTES:c,MASK:rn(s),ZERO:Me,ONE:Oe,create:l=>we(l,n),isValid:l=>{if(typeof l!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof l}`);return Me<=l&&l<n},is0:l=>l===Me,isOdd:l=>(l&Oe)===Oe,neg:l=>we(-l,n),eql:(l,a)=>l===a,sqr:l=>we(l*l,n),add:(l,a)=>we(l+a,n),sub:(l,a)=>we(l-a,n),mul:(l,a)=>we(l*a,n),pow:(l,a)=>Un(i,l,a),div:(l,a)=>we(l*cr(a,n),n),sqrN:l=>l*l,addN:(l,a)=>l+a,subN:(l,a)=>l-a,mulN:(l,a)=>l*a,inv:l=>cr(l,n),sqrt:r.sqrt||(l=>o(i,l)),invertBatch:l=>Mn(i,l),cmov:(l,a,d)=>d?a:l,toBytes:l=>t?un(l,c):Re(l,c),fromBytes:l=>{if(l.length!==c)throw new Error(`Fp.fromBytes: expected ${c}, got ${l.length}`);return t?$t(l):qe(l)}});return Object.freeze(i)}function Co(n,e){if(!n.isOdd)throw new Error("Field doesn't have isOdd");const t=n.sqrt(e);return n.isOdd(t)?n.neg(t):t}function lc(n){if(typeof n!="bigint")throw new Error("field order must be bigint");const e=n.toString(2).length;return Math.ceil(e/8)}function Ir(n){const e=lc(n);return e+Math.ceil(e/2)}function ic(n,e,t=!1){const r=n.length,s=lc(e),c=Ir(e);if(r<16||r<c||r>1024)throw new Error(`expected ${c}-1024 bytes of input, got ${r}`);const o=t?qe(n):$t(n),i=we(o,e-Oe)+Oe;return t?un(i,s):Re(i,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ao=BigInt(0),Xn=BigInt(1);function ac(n,e){const t=(s,c)=>{const o=c.negate();return s?o:c},r=s=>{const c=Math.ceil(e/s)+1,o=2**(s-1);return{windows:c,windowSize:o}};return{constTimeNegate:t,unsafeLadder(s,c){let o=n.ZERO,i=s;for(;c>Ao;)c&Xn&&(o=o.add(i)),i=i.double(),c>>=Xn;return o},precomputeWindow(s,c){const{windows:o,windowSize:i}=r(c),l=[];let a=s,d=a;for(let b=0;b<o;b++){d=a,l.push(d);for(let _=1;_<i;_++)d=d.add(a),l.push(d);a=d.double()}return l},wNAF(s,c,o){const{windows:i,windowSize:l}=r(s);let a=n.ZERO,d=n.BASE;const b=BigInt(2**s-1),_=2**s,h=BigInt(s);for(let p=0;p<i;p++){const g=p*l;let y=Number(o&b);o>>=h,y>l&&(y-=_,o+=Xn);const B=g,I=g+Math.abs(y)-1,k=p%2!==0,E=y<0;y===0?d=d.add(t(k,c[B])):a=a.add(t(E,c[I]))}return{p:a,f:d}},wNAFCached(s,c,o,i){const l=s._WINDOW_SIZE||1;let a=c.get(s);return a||(a=this.precomputeWindow(s,l),l!==1&&c.set(s,i(a))),this.wNAF(l,a,o)}}}function Sr(n){return oc(n.Fp),Ut(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...fc(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Oo(n){const e=Sr(n);Ut(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:r,a:s}=e;if(t){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:Po,hexToBytes:Ho}=xo,Lt={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(n){const{Err:e}=Lt;if(n.length<2||n[0]!==2)throw new e("Invalid signature integer tag");const t=n[1],r=n.subarray(2,t+2);if(!t||r.length!==t)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Po(r),l:n.subarray(t+2)}},toSig(n){const{Err:e}=Lt,t=typeof n=="string"?Ho(n):n;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let r=t.length;if(r<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:s,l:c}=Lt._parseInt(t.subarray(2)),{d:o,l:i}=Lt._parseInt(c);if(i.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(n){const e=a=>Number.parseInt(a[0],16)&8?"00"+a:a,t=a=>{const d=a.toString(16);return d.length&1?`0${d}`:d},r=e(t(n.s)),s=e(t(n.r)),c=r.length/2,o=s.length/2,i=t(c),l=t(o);return`30${t(o+c+4)}02${l}${s}02${i}${r}`}},lt=BigInt(0),Pe=BigInt(1),kt=BigInt(2),An=BigInt(3),Vr=BigInt(4);function or(n){const e=Oo(n),{Fp:t}=e,r=e.toBytes||((p,g,y)=>{const B=g.toAffine();return Ie(Uint8Array.from([4]),t.toBytes(B.x),t.toBytes(B.y))}),s=e.fromBytes||(p=>{const g=p.subarray(1),y=t.fromBytes(g.subarray(0,t.BYTES)),B=t.fromBytes(g.subarray(t.BYTES,2*t.BYTES));return{x:y,y:B}});function c(p){const{a:g,b:y}=e,B=t.sqr(p),I=t.mul(B,p);return t.add(t.add(I,t.mul(p,g)),y)}if(!t.eql(t.sqr(e.Gy),c(e.Gx)))throw new Error("bad generator point: equation left != right");function o(p){return typeof p=="bigint"&&lt<p&&p<e.n}function i(p){if(!o(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(p){const{allowedPrivateKeyLengths:g,nByteLength:y,wrapPrivateKey:B,n:I}=e;if(g&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=Ht(p)),typeof p!="string"||!g.includes(p.length))throw new Error("Invalid key");p=p.padStart(y*2,"0")}let k;try{k=typeof p=="bigint"?p:qe(ke("private key",p,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof p}`)}return B&&(k=we(k,I)),i(k),k}const a=new Map;function d(p){if(!(p instanceof b))throw new Error("ProjectivePoint expected")}class b{constructor(g,y,B){if(this.px=g,this.py=y,this.pz=B,g==null||!t.isValid(g))throw new Error("x required");if(y==null||!t.isValid(y))throw new Error("y required");if(B==null||!t.isValid(B))throw new Error("z required")}static fromAffine(g){const{x:y,y:B}=g||{};if(!g||!t.isValid(y)||!t.isValid(B))throw new Error("invalid affine point");if(g instanceof b)throw new Error("projective point not allowed");const I=k=>t.eql(k,t.ZERO);return I(y)&&I(B)?b.ZERO:new b(y,B,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(g){const y=t.invertBatch(g.map(B=>B.pz));return g.map((B,I)=>B.toAffine(y[I])).map(b.fromAffine)}static fromHex(g){const y=b.fromAffine(s(ke("pointHex",g)));return y.assertValidity(),y}static fromPrivateKey(g){return b.BASE.multiply(l(g))}_setWindowSize(g){this._WINDOW_SIZE=g,a.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:g,y}=this.toAffine();if(!t.isValid(g)||!t.isValid(y))throw new Error("bad point: x or y not FE");const B=t.sqr(y),I=c(g);if(!t.eql(B,I))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:g}=this.toAffine();if(t.isOdd)return!t.isOdd(g);throw new Error("Field doesn't support isOdd")}equals(g){d(g);const{px:y,py:B,pz:I}=this,{px:k,py:E,pz:v}=g,P=t.eql(t.mul(y,v),t.mul(k,I)),N=t.eql(t.mul(B,v),t.mul(E,I));return P&&N}negate(){return new b(this.px,t.neg(this.py),this.pz)}double(){const{a:g,b:y}=e,B=t.mul(y,An),{px:I,py:k,pz:E}=this;let v=t.ZERO,P=t.ZERO,N=t.ZERO,T=t.mul(I,I),M=t.mul(k,k),q=t.mul(E,E),H=t.mul(I,k);return H=t.add(H,H),N=t.mul(I,E),N=t.add(N,N),v=t.mul(g,N),P=t.mul(B,q),P=t.add(v,P),v=t.sub(M,P),P=t.add(M,P),P=t.mul(v,P),v=t.mul(H,v),N=t.mul(B,N),q=t.mul(g,q),H=t.sub(T,q),H=t.mul(g,H),H=t.add(H,N),N=t.add(T,T),T=t.add(N,T),T=t.add(T,q),T=t.mul(T,H),P=t.add(P,T),q=t.mul(k,E),q=t.add(q,q),T=t.mul(q,H),v=t.sub(v,T),N=t.mul(q,M),N=t.add(N,N),N=t.add(N,N),new b(v,P,N)}add(g){d(g);const{px:y,py:B,pz:I}=this,{px:k,py:E,pz:v}=g;let P=t.ZERO,N=t.ZERO,T=t.ZERO;const M=e.a,q=t.mul(e.b,An);let H=t.mul(y,k),K=t.mul(B,E),j=t.mul(I,v),Z=t.add(y,B),A=t.add(k,E);Z=t.mul(Z,A),A=t.add(H,K),Z=t.sub(Z,A),A=t.add(y,I);let x=t.add(k,v);return A=t.mul(A,x),x=t.add(H,j),A=t.sub(A,x),x=t.add(B,I),P=t.add(E,v),x=t.mul(x,P),P=t.add(K,j),x=t.sub(x,P),T=t.mul(M,A),P=t.mul(q,j),T=t.add(P,T),P=t.sub(K,T),T=t.add(K,T),N=t.mul(P,T),K=t.add(H,H),K=t.add(K,H),j=t.mul(M,j),A=t.mul(q,A),K=t.add(K,j),j=t.sub(H,j),j=t.mul(M,j),A=t.add(A,j),H=t.mul(K,A),N=t.add(N,H),H=t.mul(x,A),P=t.mul(Z,P),P=t.sub(P,H),H=t.mul(Z,K),T=t.mul(x,T),T=t.add(T,H),new b(P,N,T)}subtract(g){return this.add(g.negate())}is0(){return this.equals(b.ZERO)}wNAF(g){return h.wNAFCached(this,a,g,y=>{const B=t.invertBatch(y.map(I=>I.pz));return y.map((I,k)=>I.toAffine(B[k])).map(b.fromAffine)})}multiplyUnsafe(g){const y=b.ZERO;if(g===lt)return y;if(i(g),g===Pe)return this;const{endo:B}=e;if(!B)return h.unsafeLadder(this,g);let{k1neg:I,k1:k,k2neg:E,k2:v}=B.splitScalar(g),P=y,N=y,T=this;for(;k>lt||v>lt;)k&Pe&&(P=P.add(T)),v&Pe&&(N=N.add(T)),T=T.double(),k>>=Pe,v>>=Pe;return I&&(P=P.negate()),E&&(N=N.negate()),N=new b(t.mul(N.px,B.beta),N.py,N.pz),P.add(N)}multiply(g){i(g);let y=g,B,I;const{endo:k}=e;if(k){const{k1neg:E,k1:v,k2neg:P,k2:N}=k.splitScalar(y);let{p:T,f:M}=this.wNAF(v),{p:q,f:H}=this.wNAF(N);T=h.constTimeNegate(E,T),q=h.constTimeNegate(P,q),q=new b(t.mul(q.px,k.beta),q.py,q.pz),B=T.add(q),I=M.add(H)}else{const{p:E,f:v}=this.wNAF(y);B=E,I=v}return b.normalizeZ([B,I])[0]}multiplyAndAddUnsafe(g,y,B){const I=b.BASE,k=(v,P)=>P===lt||P===Pe||!v.equals(I)?v.multiplyUnsafe(P):v.multiply(P),E=k(this,y).add(k(g,B));return E.is0()?void 0:E}toAffine(g){const{px:y,py:B,pz:I}=this,k=this.is0();g==null&&(g=k?t.ONE:t.inv(I));const E=t.mul(y,g),v=t.mul(B,g),P=t.mul(I,g);if(k)return{x:t.ZERO,y:t.ZERO};if(!t.eql(P,t.ONE))throw new Error("invZ was invalid");return{x:E,y:v}}isTorsionFree(){const{h:g,isTorsionFree:y}=e;if(g===Pe)return!0;if(y)return y(b,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:g,clearCofactor:y}=e;return g===Pe?this:y?y(b,this):this.multiplyUnsafe(e.h)}toRawBytes(g=!0){return this.assertValidity(),r(b,this,g)}toHex(g=!0){return Ht(this.toRawBytes(g))}}b.BASE=new b(e.Gx,e.Gy,t.ONE),b.ZERO=new b(t.ZERO,t.ONE,t.ZERO);const _=e.nBitLength,h=ac(b,e.endo?Math.ceil(_/2):_);return{CURVE:e,ProjectivePoint:b,normPrivateKeyToScalar:l,weierstrassEquation:c,isWithinCurveOrder:o}}function Ro(n){const e=Sr(n);return Ut(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function qo(n){const e=Ro(n),{Fp:t,n:r}=e,s=t.BYTES+1,c=2*t.BYTES+1;function o(A){return lt<A&&A<t.ORDER}function i(A){return we(A,r)}function l(A){return cr(A,r)}const{ProjectivePoint:a,normPrivateKeyToScalar:d,weierstrassEquation:b,isWithinCurveOrder:_}=or({...e,toBytes(A,x,S){const C=x.toAffine(),R=t.toBytes(C.x),G=Ie;return S?G(Uint8Array.from([x.hasEvenY()?2:3]),R):G(Uint8Array.from([4]),R,t.toBytes(C.y))},fromBytes(A){const x=A.length,S=A[0],C=A.subarray(1);if(x===s&&(S===2||S===3)){const R=qe(C);if(!o(R))throw new Error("Point is not on curve");const G=b(R);let V=t.sqrt(G);const U=(V&Pe)===Pe;return(S&1)===1!==U&&(V=t.neg(V)),{x:R,y:V}}else if(x===c&&S===4){const R=t.fromBytes(C.subarray(0,t.BYTES)),G=t.fromBytes(C.subarray(t.BYTES,2*t.BYTES));return{x:R,y:G}}else throw new Error(`Point of length ${x} was invalid. Expected ${s} compressed bytes or ${c} uncompressed bytes`)}}),h=A=>Ht(Re(A,e.nByteLength));function p(A){const x=r>>Pe;return A>x}function g(A){return p(A)?i(-A):A}const y=(A,x,S)=>qe(A.slice(x,S));class B{constructor(x,S,C){this.r=x,this.s=S,this.recovery=C,this.assertValidity()}static fromCompact(x){const S=e.nByteLength;return x=ke("compactSignature",x,S*2),new B(y(x,0,S),y(x,S,2*S))}static fromDER(x){const{r:S,s:C}=Lt.toSig(ke("DER",x));return new B(S,C)}assertValidity(){if(!_(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!_(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(x){return new B(this.r,this.s,x)}recoverPublicKey(x){const{r:S,s:C,recovery:R}=this,G=N(ke("msgHash",x));if(R==null||![0,1,2,3].includes(R))throw new Error("recovery id invalid");const V=R===2||R===3?S+e.n:S;if(V>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const U=R&1?"03":"02",D=a.fromHex(U+h(V)),L=l(V),X=i(-G*L),$=i(C*L),re=a.BASE.multiplyAndAddUnsafe(D,X,$);if(!re)throw new Error("point at infinify");return re.assertValidity(),re}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new B(this.r,i(-this.s),this.recovery):this}toDERRawBytes(){return Jt(this.toDERHex())}toDERHex(){return Lt.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Jt(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}const I={isValidPrivateKey(A){try{return d(A),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const A=Ir(e.n);return ic(e.randomBytes(A),e.n)},precompute(A=8,x=a.BASE){return x._setWindowSize(A),x.multiply(BigInt(3)),x}};function k(A,x=!0){return a.fromPrivateKey(A).toRawBytes(x)}function E(A){const x=A instanceof Uint8Array,S=typeof A=="string",C=(x||S)&&A.length;return x?C===s||C===c:S?C===2*s||C===2*c:A instanceof a}function v(A,x,S=!0){if(E(A))throw new Error("first arg must be private key");if(!E(x))throw new Error("second arg must be public key");return a.fromHex(x).multiply(d(A)).toRawBytes(S)}const P=e.bits2int||function(A){const x=qe(A),S=A.length*8-e.nBitLength;return S>0?x>>BigInt(S):x},N=e.bits2int_modN||function(A){return i(P(A))},T=rn(e.nBitLength);function M(A){if(typeof A!="bigint")throw new Error("bigint expected");if(!(lt<=A&&A<T))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Re(A,e.nByteLength)}function q(A,x,S=H){if(["recovered","canonical"].some(fe=>fe in S))throw new Error("sign() legacy options not supported");const{hash:C,randomBytes:R}=e;let{lowS:G,prehash:V,extraEntropy:U}=S;G==null&&(G=!0),A=ke("msgHash",A),V&&(A=ke("prehashed msgHash",C(A)));const D=N(A),L=d(x),X=[M(L),M(D)];if(U!=null){const fe=U===!0?R(t.BYTES):U;X.push(ke("extraEntropy",fe))}const $=Ie(...X),re=D;function ce(fe){const _e=P(fe);if(!_(_e))return;const be=l(_e),xe=a.BASE.multiply(_e).toAffine(),se=i(xe.x);if(se===lt)return;const ye=i(be*i(re+se*L));if(ye===lt)return;let et=(xe.x===se?0:2)|Number(xe.y&Pe),at=ye;return G&&p(ye)&&(at=g(ye),et^=1),new B(se,at,et)}return{seed:$,k2sig:ce}}const H={lowS:e.lowS,prehash:!1},K={lowS:e.lowS,prehash:!1};function j(A,x,S=H){const{seed:C,k2sig:R}=q(A,x,S),G=e;return cc(G.hash.outputLen,G.nByteLength,G.hmac)(C,R)}a.BASE._setWindowSize(8);function Z(A,x,S,C=K){var xe;const R=A;if(x=ke("msgHash",x),S=ke("publicKey",S),"strict"in C)throw new Error("options.strict was renamed to lowS");const{lowS:G,prehash:V}=C;let U,D;try{if(typeof R=="string"||R instanceof Uint8Array)try{U=B.fromDER(R)}catch(se){if(!(se instanceof Lt.Err))throw se;U=B.fromCompact(R)}else if(typeof R=="object"&&typeof R.r=="bigint"&&typeof R.s=="bigint"){const{r:se,s:ye}=R;U=new B(se,ye)}else throw new Error("PARSE");D=a.fromHex(S)}catch(se){if(se.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(G&&U.hasHighS())return!1;V&&(x=e.hash(x));const{r:L,s:X}=U,$=N(x),re=l(X),ce=i($*re),fe=i(L*re),_e=(xe=a.BASE.multiplyAndAddUnsafe(D,ce,fe))==null?void 0:xe.toAffine();return _e?i(_e.x)===L:!1}return{CURVE:e,getPublicKey:k,getSharedSecret:v,sign:j,verify:Z,ProjectivePoint:a,Signature:B,utils:I}}function To(n,e){const t=n.ORDER;let r=lt;for(let p=t-Pe;p%kt===lt;p/=kt)r+=Pe;const s=r,c=kt<<s-Pe-Pe,o=c*kt,i=(t-Pe)/o,l=(i-Pe)/kt,a=o-Pe,d=c,b=n.pow(e,i),_=n.pow(e,(i+Pe)/kt);let h=(p,g)=>{let y=b,B=n.pow(g,a),I=n.sqr(B);I=n.mul(I,g);let k=n.mul(p,I);k=n.pow(k,l),k=n.mul(k,B),B=n.mul(k,g),I=n.mul(k,p);let E=n.mul(I,B);k=n.pow(E,d);let v=n.eql(k,n.ONE);B=n.mul(I,_),k=n.mul(E,y),I=n.cmov(B,I,v),E=n.cmov(k,E,v);for(let P=s;P>Pe;P--){let N=P-kt;N=kt<<N-Pe;let T=n.pow(E,N);const M=n.eql(T,n.ONE);B=n.mul(I,y),y=n.mul(y,y),T=n.mul(E,y),I=n.cmov(B,I,M),E=n.cmov(T,E,M)}return{isValid:v,value:I}};if(n.ORDER%Vr===An){const p=(n.ORDER-An)/Vr,g=n.sqrt(n.neg(e));h=(y,B)=>{let I=n.sqr(B);const k=n.mul(y,B);I=n.mul(I,k);let E=n.pow(I,p);E=n.mul(E,k);const v=n.mul(E,g),P=n.mul(n.sqr(E),B),N=n.eql(P,y);let T=n.cmov(v,E,N);return{isValid:N,value:T}}}return h}function uc(n,e){if(oc(n),!n.isValid(e.A)||!n.isValid(e.B)||!n.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const t=To(n,e.Z);if(!n.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let s,c,o,i,l,a,d,b;s=n.sqr(r),s=n.mul(s,e.Z),c=n.sqr(s),c=n.add(c,s),o=n.add(c,n.ONE),o=n.mul(o,e.B),i=n.cmov(e.Z,n.neg(c),!n.eql(c,n.ZERO)),i=n.mul(i,e.A),c=n.sqr(o),a=n.sqr(i),l=n.mul(a,e.A),c=n.add(c,l),c=n.mul(c,o),a=n.mul(a,i),l=n.mul(a,e.B),c=n.add(c,l),d=n.mul(s,o);const{isValid:_,value:h}=t(c,a);b=n.mul(s,r),b=n.mul(b,h),d=n.cmov(d,o,_),b=n.cmov(b,h,_);const p=n.isOdd(r)===n.isOdd(b);return b=n.cmov(n.neg(b),b,p),d=n.div(d,i),{x:d,y:b}}}function No(n){if(n instanceof Uint8Array)return n;if(typeof n=="string")return Gn(n);throw new Error("DST must be Uint8Array or string")}const Lo=qe;function At(n,e){if(n<0||n>=1<<8*e)throw new Error(`bad I2OSP call: value=${n} length=${e}`);const t=Array.from({length:e}).fill(0);for(let r=e-1;r>=0;r--)t[r]=n&255,n>>>=8;return new Uint8Array(t)}function Go(n,e){const t=new Uint8Array(n.length);for(let r=0;r<n.length;r++)t[r]=n[r]^e[r];return t}function dn(n){if(!(n instanceof Uint8Array))throw new Error("Uint8Array expected")}function Cr(n){if(!Number.isSafeInteger(n))throw new Error("number expected")}function Uo(n,e,t,r){dn(n),dn(e),Cr(t),e.length>255&&(e=r(Ie(Gn("H2C-OVERSIZE-DST-"),e)));const{outputLen:s,blockLen:c}=r,o=Math.ceil(t/s);if(o>255)throw new Error("Invalid xmd length");const i=Ie(e,At(e.length,1)),l=At(0,c),a=At(t,2),d=new Array(o),b=r(Ie(l,n,a,At(0,1),i));d[0]=r(Ie(b,At(1,1),i));for(let h=1;h<=o;h++){const p=[Go(b,d[h-1]),At(h+1,1),i];d[h]=r(Ie(...p))}return Ie(...d).slice(0,t)}function Mo(n,e,t,r,s){if(dn(n),dn(e),Cr(t),e.length>255){const c=Math.ceil(2*r/8);e=s.create({dkLen:c}).update(Gn("H2C-OVERSIZE-DST-")).update(e).digest()}if(t>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:t}).update(n).update(At(t,2)).update(e).update(At(e.length,1)).digest()}function Yr(n,e,t){Ut(t,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:r,k:s,m:c,hash:o,expand:i,DST:l}=t;dn(n),Cr(e);const a=No(l),d=r.toString(2).length,b=Math.ceil((d+s)/8),_=e*c*b;let h;if(i==="xmd")h=Uo(n,a,_,o);else if(i==="xof")h=Mo(n,a,_,s,o);else if(i==="_internal_pass")h=n;else throw new Error('expand must be "xmd" or "xof"');const p=new Array(e);for(let g=0;g<e;g++){const y=new Array(c);for(let B=0;B<c;B++){const I=b*(B+g*c),k=h.subarray(I,I+b);y[B]=we(Lo(k),r)}p[g]=y}return p}function dc(n,e){const t=e.map(r=>Array.from(r).reverse());return(r,s)=>{const[c,o,i,l]=t.map(a=>a.reduce((d,b)=>n.add(n.mul(d,r),b)));return r=n.div(c,o),s=n.mul(s,n.div(i,l)),{x:r,y:s}}}function zr(n,e,t){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(r,s){const c=Yr(r,2,{...t,DST:t.DST,...s}),o=n.fromAffine(e(c[0])),i=n.fromAffine(e(c[1])),l=o.add(i).clearCofactor();return l.assertValidity(),l},encodeToCurve(r,s){const c=Yr(r,1,{...t,DST:t.encodeDST,...s}),o=n.fromAffine(e(c[0])).clearCofactor();return o.assertValidity(),o}}}class bc extends Er{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,co(e);const r=hn(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,c=new Uint8Array(s);c.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<c.length;o++)c[o]^=54;this.iHash.update(c),this.oHash=e.create();for(let o=0;o<c.length;o++)c[o]^=106;this.oHash.update(c),c.fill(0)}update(e){return Qt(this),this.iHash.update(e),this}digestInto(e){Qt(this),xr(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:s,destroyed:c,blockLen:o,outputLen:i}=this;return e=e,e.finished=s,e.destroyed=c,e.blockLen=o,e.outputLen=i,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hc=(n,e,t)=>new bc(n,e).update(t).digest();hc.create=(n,e)=>new bc(n,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ko(n){return{hash:n,hmac:(e,...t)=>hc(n,e,Br(...t)),randomBytes:nn}}function pn(n,e){const t=r=>qo({...n,...Ko(r)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Kn=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),On=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),pc=BigInt(1),Pn=BigInt(2),Fr=(n,e)=>(n+e/Pn)/e;function _c(n){const e=Kn,t=BigInt(3),r=BigInt(6),s=BigInt(11),c=BigInt(22),o=BigInt(23),i=BigInt(44),l=BigInt(88),a=n*n*n%e,d=a*a*n%e,b=ve(d,t,e)*d%e,_=ve(b,t,e)*d%e,h=ve(_,Pn,e)*a%e,p=ve(h,s,e)*h%e,g=ve(p,c,e)*p%e,y=ve(g,i,e)*g%e,B=ve(y,l,e)*y%e,I=ve(B,i,e)*g%e,k=ve(I,t,e)*d%e,E=ve(k,o,e)*p%e,v=ve(E,r,e)*a%e,P=ve(v,Pn,e);if(!fr.eql(fr.sqr(P),n))throw new Error("Cannot find square root");return P}const fr=yt(Kn,void 0,void 0,{sqrt:_c}),$e=pn({a:BigInt(0),b:BigInt(7),Fp:fr,n:On,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const e=On,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-pc*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),c=t,o=BigInt("0x100000000000000000000000000000000"),i=Fr(c*n,e),l=Fr(-r*n,e);let a=we(n-i*t-l*s,e),d=we(-i*r-l*c,e);const b=a>o,_=d>o;if(b&&(a=e-a),_&&(d=e-d),a>o||d>o)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:b,k1:a,k2neg:_,k2:d}}}},it),Zn=BigInt(0),gc=n=>typeof n=="bigint"&&Zn<n&&n<Kn,Zo=n=>typeof n=="bigint"&&Zn<n&&n<On,Xr={};function Hn(n,...e){let t=Xr[n];if(t===void 0){const r=it(Uint8Array.from(n,s=>s.charCodeAt(0)));t=Ie(r,r),Xr[n]=t}return it(Ie(t,...e))}const Ar=n=>n.toRawBytes(!0).slice(1),lr=n=>Re(n,32),$n=n=>we(n,Kn),bn=n=>we(n,On),Or=$e.ProjectivePoint,Do=(n,e,t)=>Or.BASE.multiplyAndAddUnsafe(n,e,t);function ir(n){let e=$e.utils.normPrivateKeyToScalar(n),t=Or.fromPrivateKey(e);return{scalar:t.hasEvenY()?e:bn(-e),bytes:Ar(t)}}function mc(n){if(!gc(n))throw new Error("bad x: need 0 < x < p");const e=$n(n*n),t=$n(e*n+BigInt(7));let r=_c(t);r%Pn!==Zn&&(r=$n(-r));const s=new Or(n,r,pc);return s.assertValidity(),s}function yc(...n){return bn(qe(Hn("BIP0340/challenge",...n)))}function jo(n){return ir(n).bytes}function Vo(n,e,t=nn(32)){const r=ke("message",n),{bytes:s,scalar:c}=ir(e),o=ke("auxRand",t,32),i=lr(c^qe(Hn("BIP0340/aux",o))),l=Hn("BIP0340/nonce",i,s,r),a=bn(qe(l));if(a===Zn)throw new Error("sign failed: k is zero");const{bytes:d,scalar:b}=ir(a),_=yc(d,s,r),h=new Uint8Array(64);if(h.set(d,0),h.set(lr(bn(b+_*c)),32),!wc(h,r,s))throw new Error("sign: Invalid signature produced");return h}function wc(n,e,t){const r=ke("signature",n,64),s=ke("message",e),c=ke("publicKey",t,32);try{const o=mc(qe(c)),i=qe(r.subarray(0,32));if(!gc(i))return!1;const l=qe(r.subarray(32,64));if(!Zo(l))return!1;const a=yc(lr(i),Ar(o),s),d=Do(o,l,bn(-a));return!(!d||!d.hasEvenY()||d.toAffine().x!==i)}catch{return!1}}const Yo=(()=>({getPublicKey:jo,sign:Vo,verify:wc,utils:{randomPrivateKey:$e.utils.randomPrivateKey,lift_x:mc,pointToBytes:Ar,numberToBytesBE:Re,bytesToNumberBE:qe,taggedHash:Hn,mod:we}}))(),xn=BigInt(2**32-1),ar=BigInt(32);function xc(n,e=!1){return e?{h:Number(n&xn),l:Number(n>>ar&xn)}:{h:Number(n>>ar&xn)|0,l:Number(n&xn)|0}}function vc(n,e=!1){let t=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let s=0;s<n.length;s++){const{h:c,l:o}=xc(n[s],e);[t[s],r[s]]=[c,o]}return[t,r]}const zo=(n,e)=>BigInt(n>>>0)<<ar|BigInt(e>>>0),Fo=(n,e,t)=>n>>>t,Xo=(n,e,t)=>n<<32-t|e>>>t,$o=(n,e,t)=>n>>>t|e<<32-t,Wo=(n,e,t)=>n<<32-t|e>>>t,Qo=(n,e,t)=>n<<64-t|e>>>t-32,Jo=(n,e,t)=>n>>>t-32|e<<64-t,ef=(n,e)=>e,tf=(n,e)=>n,Bc=(n,e,t)=>n<<t|e>>>32-t,Ec=(n,e,t)=>e<<t|n>>>32-t,kc=(n,e,t)=>e<<t-32|n>>>64-t,Ic=(n,e,t)=>n<<t-32|e>>>64-t;function nf(n,e,t,r){const s=(e>>>0)+(r>>>0);return{h:n+t+(s/2**32|0)|0,l:s|0}}const rf=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),sf=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,cf=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),of=(n,e,t,r,s)=>e+t+r+s+(n/2**32|0)|0,ff=(n,e,t,r,s)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(s>>>0),lf=(n,e,t,r,s,c)=>e+t+r+s+c+(n/2**32|0)|0,af={fromBig:xc,split:vc,toBig:zo,shrSH:Fo,shrSL:Xo,rotrSH:$o,rotrSL:Wo,rotrBH:Qo,rotrBL:Jo,rotr32H:ef,rotr32L:tf,rotlSH:Bc,rotlSL:Ec,rotlBH:kc,rotlBL:Ic,add:nf,add3L:rf,add3H:sf,add4L:cf,add4H:of,add5H:lf,add5L:ff},me=af,[Sc,Cc,Ac]=[[],[],[]],uf=BigInt(0),on=BigInt(1),df=BigInt(2),bf=BigInt(7),hf=BigInt(256),pf=BigInt(113);for(let n=0,e=on,t=1,r=0;n<24;n++){[t,r]=[r,(2*t+3*r)%5],Sc.push(2*(5*r+t)),Cc.push((n+1)*(n+2)/2%64);let s=uf;for(let c=0;c<7;c++)e=(e<<on^(e>>bf)*pf)%hf,e&df&&(s^=on<<(on<<BigInt(c))-on);Ac.push(s)}const[_f,gf]=vc(Ac,!0),$r=(n,e,t)=>t>32?kc(n,e,t):Bc(n,e,t),Wr=(n,e,t)=>t>32?Ic(n,e,t):Ec(n,e,t);function mf(n,e=24){const t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)t[o]=n[o]^n[o+10]^n[o+20]^n[o+30]^n[o+40];for(let o=0;o<10;o+=2){const i=(o+8)%10,l=(o+2)%10,a=t[l],d=t[l+1],b=$r(a,d,1)^t[i],_=Wr(a,d,1)^t[i+1];for(let h=0;h<50;h+=10)n[o+h]^=b,n[o+h+1]^=_}let s=n[2],c=n[3];for(let o=0;o<24;o++){const i=Cc[o],l=$r(s,c,i),a=Wr(s,c,i),d=Sc[o];s=n[d],c=n[d+1],n[d]=l,n[d+1]=a}for(let o=0;o<50;o+=10){for(let i=0;i<10;i++)t[i]=n[o+i];for(let i=0;i<10;i++)n[o+i]^=~t[(i+2)%10]&t[(i+4)%10]}n[0]^=_f[r],n[1]^=gf[r]}t.fill(0)}class Dn extends Er{constructor(e,t,r,s=!1,c=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=s,this.rounds=c,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Cn(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=oo(this.state)}keccak(){mf(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Qt(this);const{blockLen:t,state:r}=this;e=hn(e);const s=e.length;for(let c=0;c<s;){const o=Math.min(t-this.pos,s-c);for(let i=0;i<o;i++)r[this.pos++]^=e[c++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:s}=this;e[r]^=t,t&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Qt(this,!1),xr(e),this.finish();const t=this.state,{blockLen:r}=this;for(let s=0,c=e.length;s<c;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,c-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Cn(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(tc(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:s,rounds:c,enableXOF:o}=this;return e||(e=new Dn(t,r,s,o,c)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=c,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const sn=(n,e,t)=>tn(()=>new Dn(e,n,t)),Pr=sn(6,136,256/8),yf=sn(6,104,384/8),wf=sn(6,72,512/8),Hr=sn(1,136,256/8),xf=sn(1,104,384/8),vf=sn(1,72,512/8),Bf=(n,e,t)=>io((r={})=>new Dn(e,n,r.dkLen===void 0?t:r.dkLen,!0)),Oc=Bf(31,136,256/8),Pc=(n,e,t,r,s,c,o)=>{const i=yt(t),l=i.create(n);return pn({a:l,b:e,Fp:i,n:r,Gx:c,Gy:o,h:s,lowS:!1},it)},Ke=n=>n.toString(),Sn=n=>!/[^0-9]/.test(n),ur=n=>{try{return typeof BigInt(n)=="bigint"}catch{return!1}},Ef=n=>/[^0-9A-F]/gi.test(n),Ot=n=>n.message.split(/\r?\n/),vn="0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",kf="0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",If="0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef01",Sf="0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef01",Rn=[{type:"ECDSA",list:["secp256k1","P256","P384","P521"]},{type:"Schnorr",list:["secp256k1"]},{type:"EdDSA",list:["ed25519","ed448"]},{type:"BLS",list:["bls12-381"],options:["G1","G2"]}],We={NO_MESSAGE:"Provide a message to sign to see the results.",POSITIVE_INT:"must be positive and non-floating point integer.",INT:"must be non-floating point integer."},dr={a:-3n,b:41058363725152142129326129780047268409114441015993725554835256314039467401291n,p:115792089210356248762697446949407573530086143415290314195533631308867097853951n,n:115792089210356248762697446949407573529996955224135760342422259061068512044369n,h:1n,Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},Zt=[];function _n(n,e=ge){let t;const r=new Set;function s(i){if(Le(n,i)&&(n=i,t)){const l=!Zt.length;for(const a of r)a[1](),Zt.push(a,n);if(l){for(let a=0;a<Zt.length;a+=2)Zt[a][0](Zt[a+1]);Zt.length=0}}}function c(i){s(i(n))}function o(i,l=ge){const a=[i,l];return r.add(a),r.size===1&&(t=e(s)||ge),i(n),()=>{r.delete(a),r.size===0&&t&&(t(),t=null)}}return{set:s,update:c,subscribe:o}}const dt=_n(""),nt=_n(""),Ve=_n(0n),br=_n(""),hr=_n("");function Cf(n){let e,t,r,s,c,o;const i=n[1].default,l=zc(i,n,n[0],null);return{c(){e=u("div"),t=u("div"),r=u("div"),r.textContent="Hash function",s=O(),c=u("div"),l&&l.c(),m(r,"class","hashes-list__title"),m(t,"class","hashes-list"),m(e,"class","hashes-list-container svelte-wqqbct")},m(a,d){F(a,e,d),f(e,t),f(t,r),f(t,s),f(t,c),l&&l.m(c,null),o=!0},p(a,[d]){l&&l.p&&(!o||d&1)&&Xc(l,i,a,a[0],o?Fc(i,a[0],d,null):$c(a[0]),null)},i(a){o||(Q(l,a),o=!0)},o(a){ne(l,a),o=!1},d(a){a&&z(e),l&&l.d(a)}}}function Af(n,e,t){let{$$slots:r={},$$scope:s}=e;return n.$$set=c=>{"$$scope"in c&&t(0,s=c.$$scope)},[s,r]}class gn extends De{constructor(e){super(),Ze(this,e,Af,Cf,Le,{})}}function Of(n){let e,t,r,s,c,o,i;return{c(){e=u("span"),t=u("input"),r=O(),s=u("label"),c=W(n[0]),m(t,"type","radio"),m(t,"name","hash"),t.value=n[0],m(t,"id",n[0]),t.checked=n[1],m(s,"for",n[0]),m(e,"class","hash-radio svelte-3qb93j")},m(l,a){F(l,e,a),f(e,t),f(e,r),f(e,s),f(s,c),o||(i=Ee(t,"change",n[3]),o=!0)},p(l,[a]){a&1&&(t.value=l[0]),a&1&&m(t,"id",l[0]),a&2&&(t.checked=l[1]),a&1&&J(c,l[0]),a&1&&m(s,"for",l[0])},i:ge,o:ge,d(l){l&&z(e),o=!1,i()}}}function Pf(n,e,t){const r=Tn();let{hash:s}=e,{checked:c}=e;const o=()=>{r("change",s)};return n.$$set=i=>{"hash"in i&&t(0,s=i.hash),"checked"in i&&t(1,c=i.checked)},[s,c,r,o]}class mn extends De{constructor(e){super(),Ze(this,e,Pf,Of,Le,{hash:0,checked:1})}}function Hf(n){let e,t,r,s,c,o,i;return{c(){e=u("div"),t=u("label"),t.innerHTML="<strong>Message to sign</strong>",r=O(),s=u("div"),c=u("input"),m(t,"for","sign-message-input"),m(c,"class","text-input"),m(c,"id","sign-message-input"),m(c,"type","text"),m(c,"maxlength","512"),m(s,"class","sign-message__input-container svelte-nq1zbe"),m(e,"class","sign-message svelte-nq1zbe")},m(l,a){F(l,e,a),f(e,t),f(e,r),f(e,s),f(s,c),st(c,n[0]),o||(i=Ee(c,"input",n[1]),o=!0)},p(l,[a]){a&1&&c.value!==l[0]&&st(c,l[0])},i:ge,o:ge,d(l){l&&z(e),o=!1,i()}}}function Rf(n,e,t){let r;Se(n,nt,c=>t(0,r=c));function s(){r=this.value,nt.set(r)}return[r,s]}class wt extends De{constructor(e){super(),Ze(this,e,Rf,Hf,Le,{})}}function Qr(n,e,t){const r=n.slice();return r[17]=e[t],r[19]=t,r}function Jr(n){let e,t;return e=new mn({props:{hash:n[17],checked:n[19]===0}}),e.$on("change",n[11]),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p:ge,i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function qf(n){let e,t,r=n[10],s=[];for(let o=0;o<r.length;o+=1)s[o]=Jr(Qr(n,r,o));const c=o=>ne(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=pt()},m(o,i){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(o,i);F(o,e,i),t=!0},p(o,i){if(i&3072){r=o[10];let l;for(l=0;l<r.length;l+=1){const a=Qr(o,r,l);s[l]?(s[l].p(a,i),Q(s[l],1)):(s[l]=Jr(a),s[l].c(),Q(s[l],1),s[l].m(e.parentNode,e))}for(Qe(),l=r.length;l<s.length;l+=1)c(l);Je()}},i(o){if(!t){for(let i=0;i<r.length;i+=1)Q(s[i]);t=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)ne(s[i]);t=!1},d(o){ht(s,o),o&&z(e)}}}function Tf(n){let e;return{c(){e=u("p"),e.textContent=`${We.NO_MESSAGE}`},m(t,r){F(t,e,r)},p:ge,d(t){t&&z(e)}}}function Nf(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A;return{c(){e=u("table"),t=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",c=u("td"),o=u("code"),i=W(n[9]),l=O(),a=u("tr"),d=u("td"),d.textContent="r",b=u("td"),_=u("code"),h=W(n[5]),p=O(),g=u("tr"),y=u("td"),y.textContent="s",B=u("td"),I=u("code"),k=W(n[6]),E=O(),v=u("tr"),P=u("td"),P.textContent="compact",N=u("td"),T=u("code"),M=W(n[7]),q=O(),H=u("tr"),K=u("td"),K.textContent="der",j=u("td"),Z=u("code"),A=W(n[8]),m(s,"class","curve-data__key"),m(d,"class","curve-data__key"),m(y,"class","curve-data__key"),m(P,"class","curve-data__key"),m(K,"class","curve-data__key"),m(e,"class","curve-data__table")},m(x,S){F(x,e,S),f(e,t),f(t,r),f(r,s),f(r,c),f(c,o),f(o,i),f(t,l),f(t,a),f(a,d),f(a,b),f(b,_),f(_,h),f(t,p),f(t,g),f(g,y),f(g,B),f(B,I),f(I,k),f(t,E),f(t,v),f(v,P),f(v,N),f(N,T),f(T,M),f(t,q),f(t,H),f(H,K),f(H,j),f(j,Z),f(Z,A)},p(x,S){S&512&&J(i,x[9]),S&32&&J(h,x[5]),S&64&&J(k,x[6]),S&128&&J(M,x[7]),S&256&&J(A,x[8])},d(x){x&&z(e)}}}function Lf(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A,x,S,C,R,G;x=new wt({}),C=new gn({props:{$$slots:{default:[qf]},$$scope:{ctx:n}}});function V(L,X){return L[0]?Nf:Tf}let U=V(n),D=U(n);return{c(){e=u("div"),t=u("h4"),t.textContent="Public key",r=O(),s=u("table"),c=u("tbody"),o=u("tr"),i=u("td"),i.textContent="x",l=u("td"),a=u("code"),d=W(n[1]),b=O(),_=u("tr"),h=u("td"),h.textContent="y",p=u("td"),g=u("code"),y=W(n[2]),B=O(),I=u("tr"),k=u("td"),k.textContent="33b hex",E=u("td"),v=u("code"),P=W(n[3]),N=O(),T=u("tr"),M=u("td"),M.textContent="64b hex",q=u("td"),H=u("code"),K=W(n[4]),j=O(),Z=u("h4"),Z.textContent="Signature",A=O(),ue(x.$$.fragment),S=O(),ue(C.$$.fragment),R=O(),D.c(),m(t,"class","curve-data__header"),m(i,"class","curve-data__key"),m(h,"class","curve-data__key"),m(k,"class","curve-data__key"),m(M,"class","curve-data__key"),m(s,"class","curve-data__table"),m(Z,"class","curve-data__header"),m(e,"class","curve-data")},m(L,X){F(L,e,X),f(e,t),f(e,r),f(e,s),f(s,c),f(c,o),f(o,i),f(o,l),f(l,a),f(a,d),f(c,b),f(c,_),f(_,h),f(_,p),f(p,g),f(g,y),f(c,B),f(c,I),f(I,k),f(I,E),f(E,v),f(v,P),f(c,N),f(c,T),f(T,M),f(T,q),f(q,H),f(H,K),f(e,j),f(e,Z),f(e,A),ie(x,e,null),f(e,S),ie(C,e,null),f(e,R),D.m(e,null),G=!0},p(L,[X]){(!G||X&2)&&J(d,L[1]),(!G||X&4)&&J(y,L[2]),(!G||X&8)&&J(P,L[3]),(!G||X&16)&&J(K,L[4]);const $={};X&1048576&&($.$$scope={dirty:X,ctx:L}),C.$set($),U===(U=V(L))&&D?D.p(L,X):(D.d(1),D=U(L),D&&(D.c(),D.m(e,null)))},i(L){G||(Q(x.$$.fragment,L),Q(C.$$.fragment,L),G=!0)},o(L){ne(x.$$.fragment,L),ne(C.$$.fragment,L),G=!1},d(L){L&&z(e),ae(x),ae(C),D.d()}}}function Gf(n,e,t){let r,s,c;Se(n,nt,E=>t(14,s=E)),Se(n,Ve,E=>t(15,c=E));let{privKey:o}=e,i,l,a,d,b,_,h,p,g;Ne(Ve,c=$e.CURVE.n,c);let y="sha256";const B={sha256:it,sha3_256:Pr,keccak_256:Hr},I=Object.keys(B),k=E=>{t(13,y=E.detail)};return n.$$set=E=>{"privKey"in E&&t(12,o=E.privKey)},n.$$.update=()=>{if(n.$$.dirty&16384&&t(0,r=s.length>0),n.$$.dirty&4096){const E=$e.getPublicKey(o),v=$e.ProjectivePoint.fromHex(E);t(1,[i,l]=[v.x,v.y].map(P=>Ke(P)),i,(t(2,l),t(12,o))),t(3,a=v.toHex(!0)),t(4,d=v.toHex(!1))}if(n.$$.dirty&28673&&r){const E=B[y],v=E(s),P=$e.sign(v,o);t(5,[b,_]=[P.r,P.s].map(N=>Ke(N)),b,(t(6,_),t(0,r),t(13,y),t(14,s),t(12,o))),t(7,h=P.toCompactHex()),t(8,p=P.toDERHex()),t(9,g=Ye(v))}},[r,i,l,a,d,b,_,h,p,g,I,k,o,y,s]}class Uf extends De{constructor(e){super(),Ze(this,e,Gf,Lf,Le,{privKey:12})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Hc=yt(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),Mf=Hc.create(BigInt("-3")),Kf=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gt=pn({a:Mf,b:Kf,Fp:Hc,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},it);function es(n,e,t){const r=n.slice();return r[17]=e[t],r[19]=t,r}function ts(n){let e,t;return e=new mn({props:{hash:n[17],checked:n[19]===0}}),e.$on("change",n[11]),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p:ge,i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function Zf(n){let e,t,r=n[10],s=[];for(let o=0;o<r.length;o+=1)s[o]=ts(es(n,r,o));const c=o=>ne(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=pt()},m(o,i){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(o,i);F(o,e,i),t=!0},p(o,i){if(i&3072){r=o[10];let l;for(l=0;l<r.length;l+=1){const a=es(o,r,l);s[l]?(s[l].p(a,i),Q(s[l],1)):(s[l]=ts(a),s[l].c(),Q(s[l],1),s[l].m(e.parentNode,e))}for(Qe(),l=r.length;l<s.length;l+=1)c(l);Je()}},i(o){if(!t){for(let i=0;i<r.length;i+=1)Q(s[i]);t=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)ne(s[i]);t=!1},d(o){ht(s,o),o&&z(e)}}}function Df(n){let e;return{c(){e=u("p"),e.textContent=`${We.NO_MESSAGE}`},m(t,r){F(t,e,r)},p:ge,d(t){t&&z(e)}}}function jf(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A;return{c(){e=u("table"),t=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",c=u("td"),o=u("code"),i=W(n[9]),l=O(),a=u("tr"),d=u("td"),d.textContent="r",b=u("td"),_=u("code"),h=W(n[5]),p=O(),g=u("tr"),y=u("td"),y.textContent="s",B=u("td"),I=u("code"),k=W(n[6]),E=O(),v=u("tr"),P=u("td"),P.textContent="compact",N=u("td"),T=u("code"),M=W(n[7]),q=O(),H=u("tr"),K=u("td"),K.textContent="der",j=u("td"),Z=u("code"),A=W(n[8]),m(s,"class","curve-data__key"),m(d,"class","curve-data__key"),m(y,"class","curve-data__key"),m(P,"class","curve-data__key"),m(K,"class","curve-data__key"),m(e,"class","curve-data__table")},m(x,S){F(x,e,S),f(e,t),f(t,r),f(r,s),f(r,c),f(c,o),f(o,i),f(t,l),f(t,a),f(a,d),f(a,b),f(b,_),f(_,h),f(t,p),f(t,g),f(g,y),f(g,B),f(B,I),f(I,k),f(t,E),f(t,v),f(v,P),f(v,N),f(N,T),f(T,M),f(t,q),f(t,H),f(H,K),f(H,j),f(j,Z),f(Z,A)},p(x,S){S&512&&J(i,x[9]),S&32&&J(h,x[5]),S&64&&J(k,x[6]),S&128&&J(M,x[7]),S&256&&J(A,x[8])},d(x){x&&z(e)}}}function Vf(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A,x,S,C,R,G;x=new wt({}),C=new gn({props:{$$slots:{default:[Zf]},$$scope:{ctx:n}}});function V(L,X){return L[0]?jf:Df}let U=V(n),D=U(n);return{c(){e=u("div"),t=u("h4"),t.textContent="Public key",r=O(),s=u("table"),c=u("tbody"),o=u("tr"),i=u("td"),i.textContent="x",l=u("td"),a=u("code"),d=W(n[1]),b=O(),_=u("tr"),h=u("td"),h.textContent="y",p=u("td"),g=u("code"),y=W(n[2]),B=O(),I=u("tr"),k=u("td"),k.textContent="33b hex",E=u("td"),v=u("code"),P=W(n[3]),N=O(),T=u("tr"),M=u("td"),M.textContent="64b hex",q=u("td"),H=u("code"),K=W(n[4]),j=O(),Z=u("h4"),Z.textContent="Signature",A=O(),ue(x.$$.fragment),S=O(),ue(C.$$.fragment),R=O(),D.c(),m(t,"class","curve-data__header"),m(i,"class","curve-data__key"),m(h,"class","curve-data__key"),m(k,"class","curve-data__key"),m(M,"class","curve-data__key"),m(s,"class","curve-data__table"),m(Z,"class","curve-data__header"),m(e,"class","curve-data")},m(L,X){F(L,e,X),f(e,t),f(e,r),f(e,s),f(s,c),f(c,o),f(o,i),f(o,l),f(l,a),f(a,d),f(c,b),f(c,_),f(_,h),f(_,p),f(p,g),f(g,y),f(c,B),f(c,I),f(I,k),f(I,E),f(E,v),f(v,P),f(c,N),f(c,T),f(T,M),f(T,q),f(q,H),f(H,K),f(e,j),f(e,Z),f(e,A),ie(x,e,null),f(e,S),ie(C,e,null),f(e,R),D.m(e,null),G=!0},p(L,[X]){(!G||X&2)&&J(d,L[1]),(!G||X&4)&&J(y,L[2]),(!G||X&8)&&J(P,L[3]),(!G||X&16)&&J(K,L[4]);const $={};X&1048576&&($.$$scope={dirty:X,ctx:L}),C.$set($),U===(U=V(L))&&D?D.p(L,X):(D.d(1),D=U(L),D&&(D.c(),D.m(e,null)))},i(L){G||(Q(x.$$.fragment,L),Q(C.$$.fragment,L),G=!0)},o(L){ne(x.$$.fragment,L),ne(C.$$.fragment,L),G=!1},d(L){L&&z(e),ae(x),ae(C),D.d()}}}function Yf(n,e,t){let r,s,c;Se(n,nt,E=>t(14,s=E)),Se(n,Ve,E=>t(15,c=E));let{privKey:o}=e,i,l,a,d,b,_,h,p,g;Ne(Ve,c=Gt.CURVE.n,c);let y="sha256";const B={sha256:it,sha3_256:Pr,keccak_256:Hr},I=Object.keys(B),k=E=>{t(13,y=E.detail)};return n.$$set=E=>{"privKey"in E&&t(12,o=E.privKey)},n.$$.update=()=>{if(n.$$.dirty&16384&&t(0,r=s.length>0),n.$$.dirty&4096){const E=Gt.getPublicKey(o),v=Gt.ProjectivePoint.fromHex(E);t(1,[i,l]=[v.x,v.y].map(P=>Ke(P)),i,(t(2,l),t(12,o))),t(3,a=v.toHex(!0)),t(4,d=v.toHex(!1))}if(n.$$.dirty&28673&&r){const E=B[y],v=E(s),P=Gt.sign(v,o);t(5,[b,_]=[P.r,P.s].map(N=>Ke(N)),b,(t(6,_),t(0,r),t(13,y),t(14,s),t(12,o))),t(7,h=P.toCompactHex()),t(8,p=P.toDERHex()),t(9,g=Ye(v))}},[r,i,l,a,d,b,_,h,p,g,I,k,o,y,s]}class zf extends De{constructor(e){super(),Ze(this,e,Yf,Vf,Le,{privKey:12})}}const[Ff,Xf]=(()=>me.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))))(),It=new Uint32Array(80),St=new Uint32Array(80);class Rc extends nc{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:s,Ch:c,Cl:o,Dh:i,Dl:l,Eh:a,El:d,Fh:b,Fl:_,Gh:h,Gl:p,Hh:g,Hl:y}=this;return[e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y]}set(e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=s|0,this.Ch=c|0,this.Cl=o|0,this.Dh=i|0,this.Dl=l|0,this.Eh=a|0,this.El=d|0,this.Fh=b|0,this.Fl=_|0,this.Gh=h|0,this.Gl=p|0,this.Hh=g|0,this.Hl=y|0}process(e,t){for(let k=0;k<16;k++,t+=4)It[k]=e.getUint32(t),St[k]=e.getUint32(t+=4);for(let k=16;k<80;k++){const E=It[k-15]|0,v=St[k-15]|0,P=me.rotrSH(E,v,1)^me.rotrSH(E,v,8)^me.shrSH(E,v,7),N=me.rotrSL(E,v,1)^me.rotrSL(E,v,8)^me.shrSL(E,v,7),T=It[k-2]|0,M=St[k-2]|0,q=me.rotrSH(T,M,19)^me.rotrBH(T,M,61)^me.shrSH(T,M,6),H=me.rotrSL(T,M,19)^me.rotrBL(T,M,61)^me.shrSL(T,M,6),K=me.add4L(N,H,St[k-7],St[k-16]),j=me.add4H(K,P,q,It[k-7],It[k-16]);It[k]=j|0,St[k]=K|0}let{Ah:r,Al:s,Bh:c,Bl:o,Ch:i,Cl:l,Dh:a,Dl:d,Eh:b,El:_,Fh:h,Fl:p,Gh:g,Gl:y,Hh:B,Hl:I}=this;for(let k=0;k<80;k++){const E=me.rotrSH(b,_,14)^me.rotrSH(b,_,18)^me.rotrBH(b,_,41),v=me.rotrSL(b,_,14)^me.rotrSL(b,_,18)^me.rotrBL(b,_,41),P=b&h^~b&g,N=_&p^~_&y,T=me.add5L(I,v,N,Xf[k],St[k]),M=me.add5H(T,B,E,P,Ff[k],It[k]),q=T|0,H=me.rotrSH(r,s,28)^me.rotrBH(r,s,34)^me.rotrBH(r,s,39),K=me.rotrSL(r,s,28)^me.rotrBL(r,s,34)^me.rotrBL(r,s,39),j=r&c^r&i^c&i,Z=s&o^s&l^o&l;B=g|0,I=y|0,g=h|0,y=p|0,h=b|0,p=_|0,{h:b,l:_}=me.add(a|0,d|0,M|0,q|0),a=i|0,d=l|0,i=c|0,l=o|0,c=r|0,o=s|0;const A=me.add3L(q,K,Z);r=me.add3H(A,M,H,j),s=A|0}({h:r,l:s}=me.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:c,l:o}=me.add(this.Bh|0,this.Bl|0,c|0,o|0),{h:i,l}=me.add(this.Ch|0,this.Cl|0,i|0,l|0),{h:a,l:d}=me.add(this.Dh|0,this.Dl|0,a|0,d|0),{h:b,l:_}=me.add(this.Eh|0,this.El|0,b|0,_|0),{h,l:p}=me.add(this.Fh|0,this.Fl|0,h|0,p|0),{h:g,l:y}=me.add(this.Gh|0,this.Gl|0,g|0,y|0),{h:B,l:I}=me.add(this.Hh|0,this.Hl|0,B|0,I|0),this.set(r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I)}roundClean(){It.fill(0),St.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class $f extends Rc{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const jn=tn(()=>new Rc),qc=tn(()=>new $f);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Wf=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),Tc=yt(Wf),Qf=Tc.create(BigInt("-3")),Jf=BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Vt=pn({a:Qf,b:Jf,Fp:Tc,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},qc);function ns(n,e,t){const r=n.slice();return r[17]=e[t],r[19]=t,r}function rs(n){let e,t;return e=new mn({props:{hash:n[17],checked:n[19]===0}}),e.$on("change",n[11]),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p:ge,i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function el(n){let e,t,r=n[10],s=[];for(let o=0;o<r.length;o+=1)s[o]=rs(ns(n,r,o));const c=o=>ne(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=pt()},m(o,i){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(o,i);F(o,e,i),t=!0},p(o,i){if(i&3072){r=o[10];let l;for(l=0;l<r.length;l+=1){const a=ns(o,r,l);s[l]?(s[l].p(a,i),Q(s[l],1)):(s[l]=rs(a),s[l].c(),Q(s[l],1),s[l].m(e.parentNode,e))}for(Qe(),l=r.length;l<s.length;l+=1)c(l);Je()}},i(o){if(!t){for(let i=0;i<r.length;i+=1)Q(s[i]);t=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)ne(s[i]);t=!1},d(o){ht(s,o),o&&z(e)}}}function tl(n){let e;return{c(){e=u("p"),e.textContent=`${We.NO_MESSAGE}`},m(t,r){F(t,e,r)},p:ge,d(t){t&&z(e)}}}function nl(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A;return{c(){e=u("table"),t=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",c=u("td"),o=u("code"),i=W(n[9]),l=O(),a=u("tr"),d=u("td"),d.textContent="r",b=u("td"),_=u("code"),h=W(n[5]),p=O(),g=u("tr"),y=u("td"),y.textContent="s",B=u("td"),I=u("code"),k=W(n[6]),E=O(),v=u("tr"),P=u("td"),P.textContent="compact",N=u("td"),T=u("code"),M=W(n[7]),q=O(),H=u("tr"),K=u("td"),K.textContent="der",j=u("td"),Z=u("code"),A=W(n[8]),m(s,"class","curve-data__key"),m(d,"class","curve-data__key"),m(y,"class","curve-data__key"),m(P,"class","curve-data__key"),m(K,"class","curve-data__key"),m(e,"class","curve-data__table")},m(x,S){F(x,e,S),f(e,t),f(t,r),f(r,s),f(r,c),f(c,o),f(o,i),f(t,l),f(t,a),f(a,d),f(a,b),f(b,_),f(_,h),f(t,p),f(t,g),f(g,y),f(g,B),f(B,I),f(I,k),f(t,E),f(t,v),f(v,P),f(v,N),f(N,T),f(T,M),f(t,q),f(t,H),f(H,K),f(H,j),f(j,Z),f(Z,A)},p(x,S){S&512&&J(i,x[9]),S&32&&J(h,x[5]),S&64&&J(k,x[6]),S&128&&J(M,x[7]),S&256&&J(A,x[8])},d(x){x&&z(e)}}}function rl(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A,x,S,C,R,G;x=new wt({}),C=new gn({props:{$$slots:{default:[el]},$$scope:{ctx:n}}});function V(L,X){return L[0]?nl:tl}let U=V(n),D=U(n);return{c(){e=u("div"),t=u("h4"),t.textContent="Public key",r=O(),s=u("table"),c=u("tbody"),o=u("tr"),i=u("td"),i.textContent="x",l=u("td"),a=u("code"),d=W(n[1]),b=O(),_=u("tr"),h=u("td"),h.textContent="y",p=u("td"),g=u("code"),y=W(n[2]),B=O(),I=u("tr"),k=u("td"),k.textContent="33b hex",E=u("td"),v=u("code"),P=W(n[3]),N=O(),T=u("tr"),M=u("td"),M.textContent="64b hex",q=u("td"),H=u("code"),K=W(n[4]),j=O(),Z=u("h4"),Z.textContent="Signature",A=O(),ue(x.$$.fragment),S=O(),ue(C.$$.fragment),R=O(),D.c(),m(t,"class","curve-data__header"),m(i,"class","curve-data__key"),m(h,"class","curve-data__key"),m(k,"class","curve-data__key"),m(M,"class","curve-data__key"),m(s,"class","curve-data__table"),m(Z,"class","curve-data__header"),m(e,"class","curve-data")},m(L,X){F(L,e,X),f(e,t),f(e,r),f(e,s),f(s,c),f(c,o),f(o,i),f(o,l),f(l,a),f(a,d),f(c,b),f(c,_),f(_,h),f(_,p),f(p,g),f(g,y),f(c,B),f(c,I),f(I,k),f(I,E),f(E,v),f(v,P),f(c,N),f(c,T),f(T,M),f(T,q),f(q,H),f(H,K),f(e,j),f(e,Z),f(e,A),ie(x,e,null),f(e,S),ie(C,e,null),f(e,R),D.m(e,null),G=!0},p(L,[X]){(!G||X&2)&&J(d,L[1]),(!G||X&4)&&J(y,L[2]),(!G||X&8)&&J(P,L[3]),(!G||X&16)&&J(K,L[4]);const $={};X&1048576&&($.$$scope={dirty:X,ctx:L}),C.$set($),U===(U=V(L))&&D?D.p(L,X):(D.d(1),D=U(L),D&&(D.c(),D.m(e,null)))},i(L){G||(Q(x.$$.fragment,L),Q(C.$$.fragment,L),G=!0)},o(L){ne(x.$$.fragment,L),ne(C.$$.fragment,L),G=!1},d(L){L&&z(e),ae(x),ae(C),D.d()}}}function sl(n,e,t){let r,s,c;Se(n,nt,E=>t(14,s=E)),Se(n,Ve,E=>t(15,c=E));let{privKey:o}=e,i,l,a,d,b,_,h,p,g;Ne(Ve,c=Vt.CURVE.n,c);let y="sha384";const B={sha384:qc,sha3_384:yf,keccak_384:xf},I=Object.keys(B),k=E=>{t(13,y=E.detail)};return n.$$set=E=>{"privKey"in E&&t(12,o=E.privKey)},n.$$.update=()=>{if(n.$$.dirty&16384&&t(0,r=s.length>0),n.$$.dirty&4096){const E=Vt.getPublicKey(o),v=Vt.ProjectivePoint.fromHex(E);t(1,[i,l]=[v.x,v.y].map(P=>Ke(P)),i,(t(2,l),t(12,o))),t(3,a=v.toHex(!0)),t(4,d=v.toHex(!1))}if(n.$$.dirty&28673&&r){const E=B[y],v=E(s),P=Vt.sign(v,o);t(5,[b,_]=[P.r,P.s].map(N=>Ke(N)),b,(t(6,_),t(0,r),t(13,y),t(14,s),t(12,o))),t(7,h=P.toCompactHex()),t(8,p=P.toDERHex()),t(9,g=Ye(v))}},[r,i,l,a,d,b,_,h,p,g,I,k,o,y,s]}class cl extends De{constructor(e){super(),Ze(this,e,sl,rl,Le,{privKey:12})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ol=BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),pr=yt(ol),Dt={a:pr.create(BigInt("-3")),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Fp:pr,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1)},Yt=pn({a:Dt.a,b:Dt.b,Fp:pr,n:Dt.n,Gx:Dt.Gx,Gy:Dt.Gy,h:Dt.h,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},jn);function ss(n,e,t){const r=n.slice();return r[17]=e[t],r[19]=t,r}function cs(n){let e,t;return e=new mn({props:{hash:n[17],checked:n[19]===0}}),e.$on("change",n[11]),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p:ge,i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function fl(n){let e,t,r=n[10],s=[];for(let o=0;o<r.length;o+=1)s[o]=cs(ss(n,r,o));const c=o=>ne(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=pt()},m(o,i){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(o,i);F(o,e,i),t=!0},p(o,i){if(i&3072){r=o[10];let l;for(l=0;l<r.length;l+=1){const a=ss(o,r,l);s[l]?(s[l].p(a,i),Q(s[l],1)):(s[l]=cs(a),s[l].c(),Q(s[l],1),s[l].m(e.parentNode,e))}for(Qe(),l=r.length;l<s.length;l+=1)c(l);Je()}},i(o){if(!t){for(let i=0;i<r.length;i+=1)Q(s[i]);t=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)ne(s[i]);t=!1},d(o){ht(s,o),o&&z(e)}}}function ll(n){let e;return{c(){e=u("p"),e.textContent=`${We.NO_MESSAGE}`},m(t,r){F(t,e,r)},p:ge,d(t){t&&z(e)}}}function il(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A;return{c(){e=u("table"),t=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",c=u("td"),o=u("code"),i=W(n[9]),l=O(),a=u("tr"),d=u("td"),d.textContent="r",b=u("td"),_=u("code"),h=W(n[5]),p=O(),g=u("tr"),y=u("td"),y.textContent="s",B=u("td"),I=u("code"),k=W(n[6]),E=O(),v=u("tr"),P=u("td"),P.textContent="compact",N=u("td"),T=u("code"),M=W(n[7]),q=O(),H=u("tr"),K=u("td"),K.textContent="der",j=u("td"),Z=u("code"),A=W(n[8]),m(s,"class","curve-data__key"),m(d,"class","curve-data__key"),m(y,"class","curve-data__key"),m(P,"class","curve-data__key"),m(K,"class","curve-data__key"),m(e,"class","curve-data__table")},m(x,S){F(x,e,S),f(e,t),f(t,r),f(r,s),f(r,c),f(c,o),f(o,i),f(t,l),f(t,a),f(a,d),f(a,b),f(b,_),f(_,h),f(t,p),f(t,g),f(g,y),f(g,B),f(B,I),f(I,k),f(t,E),f(t,v),f(v,P),f(v,N),f(N,T),f(T,M),f(t,q),f(t,H),f(H,K),f(H,j),f(j,Z),f(Z,A)},p(x,S){S&512&&J(i,x[9]),S&32&&J(h,x[5]),S&64&&J(k,x[6]),S&128&&J(M,x[7]),S&256&&J(A,x[8])},d(x){x&&z(e)}}}function al(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A,x,S,C,R,G;x=new wt({}),C=new gn({props:{$$slots:{default:[fl]},$$scope:{ctx:n}}});function V(L,X){return L[0]?il:ll}let U=V(n),D=U(n);return{c(){e=u("div"),t=u("h4"),t.textContent="Public key",r=O(),s=u("table"),c=u("tbody"),o=u("tr"),i=u("td"),i.textContent="x",l=u("td"),a=u("code"),d=W(n[1]),b=O(),_=u("tr"),h=u("td"),h.textContent="y",p=u("td"),g=u("code"),y=W(n[2]),B=O(),I=u("tr"),k=u("td"),k.textContent="33b hex",E=u("td"),v=u("code"),P=W(n[3]),N=O(),T=u("tr"),M=u("td"),M.textContent="64b hex",q=u("td"),H=u("code"),K=W(n[4]),j=O(),Z=u("h4"),Z.textContent="Signature",A=O(),ue(x.$$.fragment),S=O(),ue(C.$$.fragment),R=O(),D.c(),m(t,"class","curve-data__header"),m(i,"class","curve-data__key"),m(h,"class","curve-data__key"),m(k,"class","curve-data__key"),m(M,"class","curve-data__key"),m(s,"class","curve-data__table"),m(Z,"class","curve-data__header"),m(e,"class","curve-data")},m(L,X){F(L,e,X),f(e,t),f(e,r),f(e,s),f(s,c),f(c,o),f(o,i),f(o,l),f(l,a),f(a,d),f(c,b),f(c,_),f(_,h),f(_,p),f(p,g),f(g,y),f(c,B),f(c,I),f(I,k),f(I,E),f(E,v),f(v,P),f(c,N),f(c,T),f(T,M),f(T,q),f(q,H),f(H,K),f(e,j),f(e,Z),f(e,A),ie(x,e,null),f(e,S),ie(C,e,null),f(e,R),D.m(e,null),G=!0},p(L,[X]){(!G||X&2)&&J(d,L[1]),(!G||X&4)&&J(y,L[2]),(!G||X&8)&&J(P,L[3]),(!G||X&16)&&J(K,L[4]);const $={};X&1048576&&($.$$scope={dirty:X,ctx:L}),C.$set($),U===(U=V(L))&&D?D.p(L,X):(D.d(1),D=U(L),D&&(D.c(),D.m(e,null)))},i(L){G||(Q(x.$$.fragment,L),Q(C.$$.fragment,L),G=!0)},o(L){ne(x.$$.fragment,L),ne(C.$$.fragment,L),G=!1},d(L){L&&z(e),ae(x),ae(C),D.d()}}}function ul(n,e,t){let r,s,c;Se(n,nt,E=>t(14,s=E)),Se(n,Ve,E=>t(15,c=E));let{privKey:o}=e,i,l,a,d,b,_,h,p,g;Ne(Ve,c=Yt.CURVE.n,c);let y="sha512";const B={sha512:jn,sha3_512:wf,keccak_512:vf},I=Object.keys(B),k=E=>{t(13,y=E.detail)};return n.$$set=E=>{"privKey"in E&&t(12,o=E.privKey)},n.$$.update=()=>{if(n.$$.dirty&16384&&t(0,r=s.length>0),n.$$.dirty&4096){const E=Yt.getPublicKey(o),v=Yt.ProjectivePoint.fromHex(E);t(1,[i,l]=[v.x,v.y].map(P=>Ke(P)),i,(t(2,l),t(12,o))),t(3,a=v.toHex(!0)),t(4,d=v.toHex(!1))}if(n.$$.dirty&28673&&r){const E=B[y],v=E(s),P=Yt.sign(v,o);t(5,[b,_]=[P.r,P.s].map(N=>Ke(N)),b,(t(6,_),t(0,r),t(13,y),t(14,s),t(12,o))),t(7,h=P.toCompactHex()),t(8,p=P.toDERHex()),t(9,g=Ye(v))}},[r,i,l,a,d,b,_,h,p,g,I,k,o,y,s]}class dl extends De{constructor(e){super(),Ze(this,e,ul,al,Le,{privKey:12})}}function bl(n){let e;return{c(){e=u("p"),e.textContent=`${We.NO_MESSAGE}`},m(t,r){F(t,e,r)},p:ge,d(t){t&&z(e)}}}function hl(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k;return{c(){e=u("table"),t=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msg",c=u("td"),o=u("code"),i=W(n[1]),l=O(),a=u("tr"),d=u("td"),d.textContent="auxRand",b=u("td"),_=u("code"),h=W(n[2]),p=O(),g=u("tr"),y=u("td"),y.textContent="sigHex",B=u("td"),I=u("code"),k=W(n[3]),m(s,"class","curve-data__key"),m(d,"class","curve-data__key"),m(y,"class","curve-data__key"),m(e,"class","curve-data__table")},m(E,v){F(E,e,v),f(e,t),f(t,r),f(r,s),f(r,c),f(c,o),f(o,i),f(t,l),f(t,a),f(a,d),f(a,b),f(b,_),f(_,h),f(t,p),f(t,g),f(g,y),f(g,B),f(B,I),f(I,k)},p(E,v){v&2&&J(i,E[1]),v&4&&J(h,E[2]),v&8&&J(k,E[3])},d(E){E&&z(e)}}}function pl(n){let e,t,r,s,c,o;s=new wt({});function i(d,b){return d[0]?hl:bl}let l=i(n),a=l(n);return{c(){e=u("div"),t=u("h3"),t.textContent="Signature",r=O(),ue(s.$$.fragment),c=O(),a.c(),m(t,"class","curve-data__header"),m(e,"class","curve-data")},m(d,b){F(d,e,b),f(e,t),f(e,r),ie(s,e,null),f(e,c),a.m(e,null),o=!0},p(d,[b]){l===(l=i(d))&&a?a.p(d,b):(a.d(1),a=l(d),a&&(a.c(),a.m(e,null)))},i(d){o||(Q(s.$$.fragment,d),o=!0)},o(d){ne(s.$$.fragment,d),o=!1},d(d){d&&z(e),ae(s),a.d()}}}function _l(n,e,t){let r,s,c;Se(n,nt,d=>t(5,s=d)),Se(n,Ve,d=>t(6,c=d));let{privKey:o}=e,i,l,a;return Ne(Ve,c=$e.CURVE.n,c),n.$$set=d=>{"privKey"in d&&t(4,o=d.privKey)},n.$$.update=()=>{if(n.$$.dirty&32&&t(0,r=s.length>0),n.$$.dirty&49&&r){const d=en(s),b=nn(),_=Yo.sign(d,o,b);t(1,i=Ye(d)),t(2,l=Ye(b)),t(3,a=Ye(_))}},[r,i,l,a,o,s]}class gl extends De{constructor(e){super(),Ze(this,e,_l,pl,Le,{privKey:4})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ft=BigInt(0),tt=BigInt(1),Bn=BigInt(2),ml=BigInt(8),yl={zip215:!0};function wl(n){const e=Sr(n);return Ut(n,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function yn(n){const e=wl(n),{Fp:t,n:r,prehash:s,hash:c,randomBytes:o,nByteLength:i,h:l}=e,a=Bn<<BigInt(i*8)-tt,d=t.create,b=e.uvRatio||((C,R)=>{try{return{isValid:!0,value:t.sqrt(C*t.inv(R))}}catch{return{isValid:!1,value:ft}}}),_=e.adjustScalarBytes||(C=>C),h=e.domain||((C,R,G)=>{if(R.length||G)throw new Error("Contexts/pre-hash are not supported");return C}),p=C=>typeof C=="bigint"&&ft<C,g=(C,R)=>p(C)&&p(R)&&C<R,y=C=>C===ft||g(C,a);function B(C,R){if(g(C,R))return C;throw new Error(`Expected valid scalar < ${R}, got ${typeof C} ${C}`)}function I(C){return C===ft?C:B(C,r)}const k=new Map;function E(C){if(!(C instanceof v))throw new Error("ExtendedPoint expected")}class v{constructor(R,G,V,U){if(this.ex=R,this.ey=G,this.ez=V,this.et=U,!y(R))throw new Error("x required");if(!y(G))throw new Error("y required");if(!y(V))throw new Error("z required");if(!y(U))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(R){if(R instanceof v)throw new Error("extended point not allowed");const{x:G,y:V}=R||{};if(!y(G)||!y(V))throw new Error("invalid affine point");return new v(G,V,tt,d(G*V))}static normalizeZ(R){const G=t.invertBatch(R.map(V=>V.ez));return R.map((V,U)=>V.toAffine(G[U])).map(v.fromAffine)}_setWindowSize(R){this._WINDOW_SIZE=R,k.delete(this)}assertValidity(){const{a:R,d:G}=e;if(this.is0())throw new Error("bad point: ZERO");const{ex:V,ey:U,ez:D,et:L}=this,X=d(V*V),$=d(U*U),re=d(D*D),ce=d(re*re),fe=d(X*R),_e=d(re*d(fe+$)),be=d(ce+d(G*d(X*$)));if(_e!==be)throw new Error("bad point: equation left != right (1)");const xe=d(V*U),se=d(D*L);if(xe!==se)throw new Error("bad point: equation left != right (2)")}equals(R){E(R);const{ex:G,ey:V,ez:U}=this,{ex:D,ey:L,ez:X}=R,$=d(G*X),re=d(D*U),ce=d(V*X),fe=d(L*U);return $===re&&ce===fe}is0(){return this.equals(v.ZERO)}negate(){return new v(d(-this.ex),this.ey,this.ez,d(-this.et))}double(){const{a:R}=e,{ex:G,ey:V,ez:U}=this,D=d(G*G),L=d(V*V),X=d(Bn*d(U*U)),$=d(R*D),re=G+V,ce=d(d(re*re)-D-L),fe=$+L,_e=fe-X,be=$-L,xe=d(ce*_e),se=d(fe*be),ye=d(ce*be),et=d(_e*fe);return new v(xe,se,et,ye)}add(R){E(R);const{a:G,d:V}=e,{ex:U,ey:D,ez:L,et:X}=this,{ex:$,ey:re,ez:ce,et:fe}=R;if(G===BigInt(-1)){const ze=d((D-U)*(re+$)),Fe=d((D+U)*(re-$)),Ce=d(Fe-ze);if(Ce===ft)return this.double();const Ge=d(L*Bn*fe),Mt=d(X*Bn*ce),vt=Mt+Ge,Xe=Fe+ze,ee=Mt-Ge,de=d(vt*Ce),ot=d(Xe*ee),Ue=d(vt*ee),he=d(Ce*Xe);return new v(de,ot,he,Ue)}const _e=d(U*$),be=d(D*re),xe=d(X*V*fe),se=d(L*ce),ye=d((U+D)*($+re)-_e-be),et=se-xe,at=se+xe,rt=d(be-G*_e),Be=d(ye*et),Rt=d(at*rt),Ae=d(ye*rt),xt=d(et*at);return new v(Be,Rt,xt,Ae)}subtract(R){return this.add(R.negate())}wNAF(R){return T.wNAFCached(this,k,R,v.normalizeZ)}multiply(R){const{p:G,f:V}=this.wNAF(B(R,r));return v.normalizeZ([G,V])[0]}multiplyUnsafe(R){let G=I(R);return G===ft?N:this.equals(N)||G===tt?this:this.equals(P)?this.wNAF(G).p:T.unsafeLadder(this,G)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}isTorsionFree(){return T.unsafeLadder(this,r).is0()}toAffine(R){const{ex:G,ey:V,ez:U}=this,D=this.is0();R==null&&(R=D?ml:t.inv(U));const L=d(G*R),X=d(V*R),$=d(U*R);if(D)return{x:ft,y:tt};if($!==tt)throw new Error("invZ was invalid");return{x:L,y:X}}clearCofactor(){const{h:R}=e;return R===tt?this:this.multiplyUnsafe(R)}static fromHex(R,G=!1){const{d:V,a:U}=e,D=t.BYTES;R=ke("pointHex",R,D);const L=R.slice(),X=R[D-1];L[D-1]=X&-129;const $=$t(L);$===ft||(G?B($,a):B($,t.ORDER));const re=d($*$),ce=d(re-tt),fe=d(V*re-U);let{isValid:_e,value:be}=b(ce,fe);if(!_e)throw new Error("Point.fromHex: invalid y coordinate");const xe=(be&tt)===tt,se=(X&128)!==0;if(!G&&be===ft&&se)throw new Error("Point.fromHex: x=0 and x_0=1");return se!==xe&&(be=d(-be)),v.fromAffine({x:be,y:$})}static fromPrivateKey(R){return H(R).point}toRawBytes(){const{x:R,y:G}=this.toAffine(),V=un(G,t.BYTES);return V[V.length-1]|=R&tt?128:0,V}toHex(){return Ht(this.toRawBytes())}}v.BASE=new v(e.Gx,e.Gy,tt,d(e.Gx*e.Gy)),v.ZERO=new v(ft,tt,tt,ft);const{BASE:P,ZERO:N}=v,T=ac(v,i*8);function M(C){return we(C,r)}function q(C){return M($t(C))}function H(C){const R=i;C=ke("private key",C,R);const G=ke("hashed private key",c(C),2*R),V=_(G.slice(0,R)),U=G.slice(R,2*R),D=q(V),L=P.multiply(D),X=L.toRawBytes();return{head:V,prefix:U,scalar:D,point:L,pointBytes:X}}function K(C){return H(C).pointBytes}function j(C=new Uint8Array,...R){const G=Ie(...R);return q(c(h(G,ke("context",C),!!s)))}function Z(C,R,G={}){C=ke("message",C),s&&(C=s(C));const{prefix:V,scalar:U,pointBytes:D}=H(R),L=j(G.context,V,C),X=P.multiply(L).toRawBytes(),$=j(G.context,X,D,C),re=M(L+$*U);I(re);const ce=Ie(X,un(re,t.BYTES));return ke("result",ce,i*2)}const A=yl;function x(C,R,G,V=A){const{context:U,zip215:D}=V,L=t.BYTES;C=ke("signature",C,2*L),R=ke("message",R),s&&(R=s(R));const X=$t(C.slice(L,2*L));let $,re,ce;try{$=v.fromHex(G,D),re=v.fromHex(C.slice(0,L),D),ce=P.multiplyUnsafe(X)}catch{return!1}if(!D&&$.isSmallOrder())return!1;const fe=j(U,re.toRawBytes(),$.toRawBytes(),R);return re.add($.multiplyUnsafe(fe)).subtract(ce).clearCofactor().equals(v.ZERO)}return P._setWindowSize(8),{CURVE:e,getPublicKey:K,sign:Z,verify:x,ExtendedPoint:v,utils:{getExtendedPublicKey:H,randomPrivateKey:()=>o(t.BYTES),precompute(C=8,R=v.BASE){return R._setWindowSize(C),R.multiply(BigInt(3)),R}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Rr=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),os=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const xl=BigInt(1),_r=BigInt(2),vl=BigInt(5),fs=BigInt(10),Bl=BigInt(20),El=BigInt(40),ls=BigInt(80);function kl(n){const e=Rr,r=n*n%e*n%e,s=ve(r,_r,e)*r%e,c=ve(s,xl,e)*n%e,o=ve(c,vl,e)*c%e,i=ve(o,fs,e)*o%e,l=ve(i,Bl,e)*i%e,a=ve(l,El,e)*l%e,d=ve(a,ls,e)*a%e,b=ve(d,ls,e)*a%e,_=ve(b,fs,e)*o%e;return{pow_p_5_8:ve(_,_r,e)*n%e,b2:r}}function Il(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}function Sl(n,e){const t=Rr,r=we(e*e*e,t),s=we(r*r*e,t),c=kl(n*s).pow_p_5_8;let o=we(n*r*c,t);const i=we(e*o*o,t),l=o,a=we(o*os,t),d=i===n,b=i===we(-n,t),_=i===we(-n*os,t);return d&&(o=l),(b||_)&&(o=a),Io(o,t)&&(o=we(-o,t)),{isValid:d||b,value:o}}const mt=yt(Rr,void 0,!0),qr={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:mt,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:jn,randomBytes:nn,adjustScalarBytes:Il,uvRatio:Sl},zt=yn(qr);function Nc(n,e,t){if(e.length>255)throw new Error("Context is too big");return Br(en("SigEd25519 no Ed25519 collisions"),new Uint8Array([t?1:0,e.length]),e,n)}({...qr});({...qr});const Cl=(mt.ORDER+BigInt(3))/BigInt(8);mt.pow(_r,Cl);mt.sqrt(mt.neg(mt.ONE));(mt.ORDER-BigInt(5))/BigInt(8);BigInt(486662);Co(mt,mt.neg(BigInt(486664)));BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235");BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578");BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838");BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Al(n){let e;return{c(){e=u("p"),e.textContent=`${We.NO_MESSAGE}`},m(t,r){F(t,e,r)},p:ge,d(t){t&&z(e)}}}function Ol(n){let e,t,r,s,c,o,i,l,a,d,b,_,h;return{c(){e=u("table"),t=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msg",c=u("td"),o=u("code"),i=W(n[4]),l=O(),a=u("tr"),d=u("td"),d.textContent="sigHex",b=u("td"),_=u("code"),h=W(n[5]),m(s,"class","curve-data__key"),m(d,"class","curve-data__key"),m(e,"class","curve-data__table")},m(p,g){F(p,e,g),f(e,t),f(t,r),f(r,s),f(r,c),f(c,o),f(o,i),f(t,l),f(t,a),f(a,d),f(a,b),f(b,_),f(_,h)},p(p,g){g&16&&J(i,p[4]),g&32&&J(h,p[5])},d(p){p&&z(e)}}}function Pl(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K;q=new wt({});function j(x,S){return x[0]?Ol:Al}let Z=j(n),A=Z(n);return{c(){e=u("div"),t=u("h4"),t.textContent="Public key",r=O(),s=u("table"),c=u("tbody"),o=u("tr"),i=u("td"),i.textContent="x",l=u("td"),a=u("code"),d=W(n[1]),b=O(),_=u("tr"),h=u("td"),h.textContent="y",p=u("td"),g=u("code"),y=W(n[2]),B=O(),I=u("tr"),k=u("td"),k.textContent="hex",E=u("td"),v=u("code"),P=W(n[3]),N=O(),T=u("h4"),T.textContent="Signature",M=O(),ue(q.$$.fragment),H=O(),A.c(),m(t,"class","curve-data__header"),m(i,"class","curve-data__key"),m(h,"class","curve-data__key"),m(k,"class","curve-data__key"),m(s,"class","curve-data__table"),m(T,"class","curve-data__header"),m(e,"class","curve-data")},m(x,S){F(x,e,S),f(e,t),f(e,r),f(e,s),f(s,c),f(c,o),f(o,i),f(o,l),f(l,a),f(a,d),f(c,b),f(c,_),f(_,h),f(_,p),f(p,g),f(g,y),f(c,B),f(c,I),f(I,k),f(I,E),f(E,v),f(v,P),f(e,N),f(e,T),f(e,M),ie(q,e,null),f(e,H),A.m(e,null),K=!0},p(x,[S]){(!K||S&2)&&J(d,x[1]),(!K||S&4)&&J(y,x[2]),(!K||S&8)&&J(P,x[3]),Z===(Z=j(x))&&A?A.p(x,S):(A.d(1),A=Z(x),A&&(A.c(),A.m(e,null)))},i(x){K||(Q(q.$$.fragment,x),K=!0)},o(x){ne(q.$$.fragment,x),K=!1},d(x){x&&z(e),ae(q),A.d()}}}function Hl(n,e,t){let r,s,c;Se(n,nt,_=>t(7,s=_)),Se(n,Ve,_=>t(8,c=_));let{privKey:o}=e,i,l,a,d,b;return Ne(Ve,c=zt.CURVE.n,c),n.$$set=_=>{"privKey"in _&&t(6,o=_.privKey)},n.$$.update=()=>{if(n.$$.dirty&128&&t(0,r=s.length>0),n.$$.dirty&193){const _=zt.getPublicKey(o),h=zt.ExtendedPoint.fromHex(_);if(t(1,[i,l]=[h.x,h.y].map(p=>Ke(p)),i,(t(2,l),t(6,o),t(0,r),t(7,s))),t(3,a=h.toHex()),r){const p=en(s),g=zt.sign(p,o);t(4,d=Ye(p)),t(5,b=Ye(g))}}},[r,i,l,a,d,b,o,s]}class Rl extends De{constructor(e){super(),Ze(this,e,Hl,Pl,Le,{privKey:6})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ql=tn(()=>Oc.create({dkLen:114})),Tl=tn(()=>Oc.create({dkLen:64})),Tr=BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439"),Nl=BigInt(1),is=BigInt(2),as=BigInt(3);BigInt(4);const Ll=BigInt(11),Gl=BigInt(22),us=BigInt(44),Ul=BigInt(88),Ml=BigInt(223);function Kl(n){const e=Tr,t=n*n*n%e,r=t*t*n%e,s=ve(r,as,e)*r%e,c=ve(s,as,e)*r%e,o=ve(c,is,e)*t%e,i=ve(o,Ll,e)*o%e,l=ve(i,Gl,e)*i%e,a=ve(l,us,e)*l%e,d=ve(a,Ul,e)*a%e,b=ve(d,us,e)*l%e,_=ve(b,is,e)*t%e,h=ve(_,Nl,e)*n%e;return ve(h,Ml,e)*_%e}function Zl(n){return n[0]&=252,n[55]|=128,n[56]=0,n}function Dl(n,e){const t=Tr,r=we(n*n*e,t),s=we(r*n,t),c=we(s*r*e,t),o=Kl(c),i=we(s*o,t),l=we(i*i,t);return{isValid:we(l*e,t)===n,value:i}}const Lc=yt(Tr,456,!0),Gc={a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:Lc,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:ql,randomBytes:nn,adjustScalarBytes:Zl,domain:(n,e,t)=>{if(e.length>255)throw new Error(`Context is too big: ${e.length}`);return Br(en("SigEd448"),new Uint8Array([t?1:0,e.length]),e,n)},uvRatio:Dl},Ft=yn(Gc);({...Gc});(Lc.ORDER-BigInt(3))/BigInt(4);BigInt(156326);BigInt("39082");BigInt("78163");BigInt("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214");BigInt("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716");BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function jl(n){let e;return{c(){e=u("p"),e.textContent=`${We.NO_MESSAGE}`},m(t,r){F(t,e,r)},p:ge,d(t){t&&z(e)}}}function Vl(n){let e,t,r,s,c,o,i,l,a,d,b,_,h;return{c(){e=u("table"),t=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msg",c=u("td"),o=u("code"),i=W(n[4]),l=O(),a=u("tr"),d=u("td"),d.textContent="sigHex",b=u("td"),_=u("code"),h=W(n[5]),m(s,"class","curve-data__key"),m(d,"class","curve-data__key"),m(e,"class","curve-data__table")},m(p,g){F(p,e,g),f(e,t),f(t,r),f(r,s),f(r,c),f(c,o),f(o,i),f(t,l),f(t,a),f(a,d),f(a,b),f(b,_),f(_,h)},p(p,g){g&16&&J(i,p[4]),g&32&&J(h,p[5])},d(p){p&&z(e)}}}function Yl(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K;q=new wt({});function j(x,S){return x[0]?Vl:jl}let Z=j(n),A=Z(n);return{c(){e=u("div"),t=u("h4"),t.textContent="Public key",r=O(),s=u("table"),c=u("tbody"),o=u("tr"),i=u("td"),i.textContent="x",l=u("td"),a=u("code"),d=W(n[1]),b=O(),_=u("tr"),h=u("td"),h.textContent="y",p=u("td"),g=u("code"),y=W(n[2]),B=O(),I=u("tr"),k=u("td"),k.textContent="hex",E=u("td"),v=u("code"),P=W(n[3]),N=O(),T=u("h4"),T.textContent="Signature",M=O(),ue(q.$$.fragment),H=O(),A.c(),m(t,"class","curve-data__header"),m(i,"class","curve-data__key"),m(h,"class","curve-data__key"),m(k,"class","curve-data__key"),m(s,"class","curve-data__table"),m(T,"class","curve-data__header"),m(e,"class","curve-data")},m(x,S){F(x,e,S),f(e,t),f(e,r),f(e,s),f(s,c),f(c,o),f(o,i),f(o,l),f(l,a),f(a,d),f(c,b),f(c,_),f(_,h),f(_,p),f(p,g),f(g,y),f(c,B),f(c,I),f(I,k),f(I,E),f(E,v),f(v,P),f(e,N),f(e,T),f(e,M),ie(q,e,null),f(e,H),A.m(e,null),K=!0},p(x,[S]){(!K||S&2)&&J(d,x[1]),(!K||S&4)&&J(y,x[2]),(!K||S&8)&&J(P,x[3]),Z===(Z=j(x))&&A?A.p(x,S):(A.d(1),A=Z(x),A&&(A.c(),A.m(e,null)))},i(x){K||(Q(q.$$.fragment,x),K=!0)},o(x){ne(q.$$.fragment,x),K=!1},d(x){x&&z(e),ae(q),A.d()}}}function zl(n,e,t){let r,s,c;Se(n,nt,_=>t(7,s=_)),Se(n,Ve,_=>t(8,c=_));let{privKey:o}=e,i,l,a,d,b;return Ne(Ve,c=Ft.CURVE.n,c),n.$$set=_=>{"privKey"in _&&t(6,o=_.privKey)},n.$$.update=()=>{if(n.$$.dirty&128&&t(0,r=s.length>0),n.$$.dirty&193){const _=Ft.getPublicKey(o),h=Ft.ExtendedPoint.fromHex(_);if(t(1,[i,l]=[h.x,h.y].map(p=>Ke(p)),i,(t(2,l),t(6,o),t(0,r),t(7,s))),t(3,a=h.toHex()),r){const p=en(s),g=Ft.sign(p,o);t(4,d=Ye(p)),t(5,b=Ye(g))}}},[r,i,l,a,d,b,o,s]}class Fl extends De{constructor(e){super(),Ze(this,e,zl,Yl,Le,{privKey:6})}}const Wn=BigInt(2),En=BigInt(3);function Xl(n){const{Fp:e,Fr:t,Fp2:r,Fp6:s,Fp12:c}=n.fields,o=Wt(n.params.x);function i(q){const{x:H,y:K}=q,j=H,Z=K,A=r.ONE;let x=j,S=Z,C=A,R=[];for(let G=o-2;G>=0;G--){let V=r.sqr(S),U=r.sqr(C),D=r.multiplyByB(r.mul(U,En)),L=r.mul(D,En),X=r.sub(r.sub(r.sqr(r.add(S,C)),U),V);if(R.push([r.sub(D,V),r.mul(r.sqr(x),En),r.neg(X)]),x=r.div(r.mul(r.mul(r.sub(V,L),x),S),Wn),S=r.sub(r.sqr(r.div(r.add(V,L),Wn)),r.mul(r.sqr(D),En)),C=r.mul(V,X),Pt(n.params.x,G)){let $=r.sub(S,r.mul(Z,C)),re=r.sub(x,r.mul(j,C));R.push([r.sub(r.mul($,j),r.mul(re,Z)),r.neg($),re]);let ce=r.sqr(re),fe=r.mul(ce,re),_e=r.mul(ce,x),be=r.add(r.sub(fe,r.mul(_e,Wn)),r.mul(r.sqr($),C));x=r.mul(re,be),S=r.sub(r.mul(r.sub(_e,be),$),r.mul(fe,S)),C=r.mul(C,fe)}}return R}function l(q,H){const{x:K}=n.params,j=H[0],Z=H[1];let A=c.ONE;for(let x=0,S=o-2;S>=0;S--,x++){const C=q[x];if(A=c.multiplyBy014(A,C[0],r.mul(C[1],j),r.mul(C[2],Z)),Pt(K,S)){x+=1;const R=q[x];A=c.multiplyBy014(A,R[0],r.mul(R[1],j),r.mul(R[2],Z))}S!==0&&(A=c.sqr(A))}return c.conjugate(A)}const a={randomPrivateKey:()=>{const q=Ir(t.ORDER);return ic(n.randomBytes(q),t.ORDER)},calcPairingPrecomputes:i},d=or({n:t.ORDER,...n.G1}),b=Object.assign(d,zr(d.ProjectivePoint,n.G1.mapToCurve,{...n.htfDefaults,...n.G1.htfDefaults}));function _(q){const H=q;return H._PPRECOMPUTES||(H._PPRECOMPUTES=i(q.toAffine())),H._PPRECOMPUTES}const h=or({n:t.ORDER,...n.G2}),p=Object.assign(h,zr(h.ProjectivePoint,n.G2.mapToCurve,{...n.htfDefaults,...n.G2.htfDefaults})),{Signature:g}=n.G2;function y(q,H,K=!0){if(q.equals(b.ProjectivePoint.ZERO)||H.equals(p.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");q.assertValidity(),H.assertValidity();const j=q.toAffine(),Z=l(_(H),[j.x,j.y]);return K?c.finalExponentiate(Z):Z}function B(q){return q instanceof b.ProjectivePoint?q:b.ProjectivePoint.fromHex(q)}function I(q){return q instanceof p.ProjectivePoint?q:g.fromHex(q)}function k(q,H){return q instanceof p.ProjectivePoint?q:p.hashToCurve(ke("point",q),H)}function E(q){return b.ProjectivePoint.fromPrivateKey(q).toRawBytes(!0)}function v(q,H,K){const j=k(q,K);j.assertValidity();const Z=j.multiply(b.normPrivateKeyToScalar(H));return q instanceof p.ProjectivePoint?Z:g.toRawBytes(Z)}function P(q,H,K,j){const Z=B(K),A=k(H,j),x=b.ProjectivePoint.BASE,S=I(q),C=y(Z.negate(),A,!1),R=y(x,S,!1),G=c.finalExponentiate(c.mul(R,C));return c.eql(G,c.ONE)}function N(q){if(!q.length)throw new Error("Expected non-empty array");const K=q.map(B).reduce((j,Z)=>j.add(Z),b.ProjectivePoint.ZERO);return q[0]instanceof b.ProjectivePoint?(K.assertValidity(),K):K.toRawBytes(!0)}function T(q){if(!q.length)throw new Error("Expected non-empty array");const K=q.map(I).reduce((j,Z)=>j.add(Z),p.ProjectivePoint.ZERO);return q[0]instanceof p.ProjectivePoint?(K.assertValidity(),K):g.toRawBytes(K)}function M(q,H,K,j){if(!H.length)throw new Error("Expected non-empty messages array");if(K.length!==H.length)throw new Error("Pubkey count should equal msg count");const Z=I(q),A=H.map(S=>k(S,j)),x=K.map(B);try{const S=[];for(const G of new Set(A)){const V=A.reduce((U,D,L)=>D===G?U.add(x[L]):U,b.ProjectivePoint.ZERO);S.push(y(V,G,!1))}S.push(y(b.ProjectivePoint.BASE.negate(),Z,!1));const C=S.reduce((G,V)=>c.mul(G,V),c.ONE),R=c.finalExponentiate(C);return c.eql(R,c.ONE)}catch{return!1}}return b.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:E,sign:v,verify:P,verifyBatch:M,aggregatePublicKeys:N,aggregateSignatures:T,millerLoop:l,pairing:y,G1:b,G2:p,Signature:g,fields:{Fr:t,Fp:e,Fp2:r,Fp6:s,Fp12:c},params:{x:n.params.x,r:n.params.r,G1b:n.G1.b,G2b:n.G2.b},utils:a}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const je=BigInt(0),gt=BigInt(1),Te=BigInt(2),Qn=BigInt(3),ln=BigInt(4),$l=BigInt(8),Wl=BigInt(16),gr=BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),Y=yt(gr),ds=yt(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),bs=({c0:n,c1:e},{c0:t,c1:r})=>({c0:Y.add(n,t),c1:Y.add(e,r)}),hs=({c0:n,c1:e},{c0:t,c1:r})=>({c0:Y.sub(n,t),c1:Y.sub(e,r)}),ps=({c0:n,c1:e},t)=>{if(typeof t=="bigint")return{c0:Y.mul(n,t),c1:Y.mul(e,t)};const{c0:r,c1:s}=t;let c=Y.mul(n,r),o=Y.mul(e,s);const i=Y.sub(c,o),l=Y.sub(Y.mul(Y.add(n,e),Y.add(r,s)),Y.add(c,o));return{c0:i,c1:l}},_s=({c0:n,c1:e})=>{const t=Y.add(n,e),r=Y.sub(n,e),s=Y.add(n,n);return{c0:Y.mul(t,r),c1:Y.mul(s,e)}},kn=gr*gr,w={ORDER:kn,BITS:Wt(kn),BYTES:Math.ceil(Wt(kn)/8),MASK:rn(Wt(kn)),ZERO:{c0:Y.ZERO,c1:Y.ZERO},ONE:{c0:Y.ONE,c1:Y.ZERO},create:n=>n,isValid:({c0:n,c1:e})=>typeof n=="bigint"&&typeof e=="bigint",is0:({c0:n,c1:e})=>Y.is0(n)&&Y.is0(e),eql:({c0:n,c1:e},{c0:t,c1:r})=>Y.eql(n,t)&&Y.eql(e,r),neg:({c0:n,c1:e})=>({c0:Y.neg(n),c1:Y.neg(e)}),pow:(n,e)=>Un(w,n,e),invertBatch:n=>Mn(w,n),add:bs,sub:hs,mul:ps,sqr:_s,addN:bs,subN:hs,mulN:ps,sqrN:_s,div:(n,e)=>w.mul(n,typeof e=="bigint"?Y.inv(Y.create(e)):w.inv(e)),inv:({c0:n,c1:e})=>{const t=Y.inv(Y.create(n*n+e*e));return{c0:Y.mul(t,Y.create(n)),c1:Y.mul(t,Y.create(-e))}},sqrt:n=>{if(w.eql(n,w.ZERO))return w.ZERO;const e=w.pow(n,(w.ORDER+$l)/Wl),t=w.div(w.sqr(e),n),r=Jl,s=[r[0],r[2],r[4],r[6]].find(h=>w.eql(h,t));if(!s)throw new Error("No root");const c=r.indexOf(s),o=r[c/2];if(!o)throw new Error("Invalid root");const i=w.div(e,o),l=w.neg(i),{re:a,im:d}=w.reim(i),{re:b,im:_}=w.reim(l);return d>_||d===_&&a>b?i:l},isOdd:n=>{const{re:e,im:t}=w.reim(n),r=e%Te,s=e===je,c=t%Te;return BigInt(r||s&&c)==gt},fromBytes(n){if(n.length!==w.BYTES)throw new Error(`fromBytes wrong length=${n.length}`);return{c0:Y.fromBytes(n.subarray(0,Y.BYTES)),c1:Y.fromBytes(n.subarray(Y.BYTES))}},toBytes:({c0:n,c1:e})=>Ie(Y.toBytes(n),Y.toBytes(e)),cmov:({c0:n,c1:e},{c0:t,c1:r},s)=>({c0:Y.cmov(n,t,s),c1:Y.cmov(e,r,s)}),reim:({c0:n,c1:e})=>({re:n,im:e}),mulByNonresidue:({c0:n,c1:e})=>({c0:Y.sub(n,e),c1:Y.add(n,e)}),multiplyByB:({c0:n,c1:e})=>{let t=Y.mul(n,ln),r=Y.mul(e,ln);return{c0:Y.sub(t,r),c1:Y.add(t,r)}},fromBigTuple:n=>{if(n.length!==2)throw new Error("Invalid tuple");const e=n.map(t=>Y.create(t));return{c0:e[0],c1:e[1]}},frobeniusMap:({c0:n,c1:e},t)=>({c0:n,c1:Y.mul(e,Ql[t%2])})},Ql=[BigInt("0x1"),BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaa")].map(n=>Y.create(n)),Ct=BigInt("0x6af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09"),Jl=[[gt,je],[Ct,-Ct],[je,gt],[Ct,Ct],[-gt,je],[-Ct,Ct],[je,-gt],[-Ct,-Ct]].map(n=>w.fromBigTuple(n)),gs=({c0:n,c1:e,c2:t},{c0:r,c1:s,c2:c})=>({c0:w.add(n,r),c1:w.add(e,s),c2:w.add(t,c)}),ms=({c0:n,c1:e,c2:t},{c0:r,c1:s,c2:c})=>({c0:w.sub(n,r),c1:w.sub(e,s),c2:w.sub(t,c)}),ys=({c0:n,c1:e,c2:t},r)=>{if(typeof r=="bigint")return{c0:w.mul(n,r),c1:w.mul(e,r),c2:w.mul(t,r)};const{c0:s,c1:c,c2:o}=r,i=w.mul(n,s),l=w.mul(e,c),a=w.mul(t,o);return{c0:w.add(i,w.mulByNonresidue(w.sub(w.mul(w.add(e,t),w.add(c,o)),w.add(l,a)))),c1:w.add(w.sub(w.mul(w.add(n,e),w.add(s,c)),w.add(i,l)),w.mulByNonresidue(a)),c2:w.sub(w.add(l,w.mul(w.add(n,t),w.add(s,o))),w.add(i,a))}},ws=({c0:n,c1:e,c2:t})=>{let r=w.sqr(n),s=w.mul(w.mul(n,e),Te),c=w.mul(w.mul(e,t),Te),o=w.sqr(t);return{c0:w.add(w.mulByNonresidue(c),r),c1:w.add(w.mulByNonresidue(o),s),c2:w.sub(w.sub(w.add(w.add(s,w.sqr(w.add(w.sub(n,e),t))),c),r),o)}},te={ORDER:w.ORDER,BITS:3*w.BITS,BYTES:3*w.BYTES,MASK:rn(3*w.BITS),ZERO:{c0:w.ZERO,c1:w.ZERO,c2:w.ZERO},ONE:{c0:w.ONE,c1:w.ZERO,c2:w.ZERO},create:n=>n,isValid:({c0:n,c1:e,c2:t})=>w.isValid(n)&&w.isValid(e)&&w.isValid(t),is0:({c0:n,c1:e,c2:t})=>w.is0(n)&&w.is0(e)&&w.is0(t),neg:({c0:n,c1:e,c2:t})=>({c0:w.neg(n),c1:w.neg(e),c2:w.neg(t)}),eql:({c0:n,c1:e,c2:t},{c0:r,c1:s,c2:c})=>w.eql(n,r)&&w.eql(e,s)&&w.eql(t,c),sqrt:()=>{throw new Error("Not implemented")},div:(n,e)=>te.mul(n,typeof e=="bigint"?Y.inv(Y.create(e)):te.inv(e)),pow:(n,e)=>Un(te,n,e),invertBatch:n=>Mn(te,n),add:gs,sub:ms,mul:ys,sqr:ws,addN:gs,subN:ms,mulN:ys,sqrN:ws,inv:({c0:n,c1:e,c2:t})=>{let r=w.sub(w.sqr(n),w.mulByNonresidue(w.mul(t,e))),s=w.sub(w.mulByNonresidue(w.sqr(t)),w.mul(n,e)),c=w.sub(w.sqr(e),w.mul(n,t)),o=w.inv(w.add(w.mulByNonresidue(w.add(w.mul(t,s),w.mul(e,c))),w.mul(n,r)));return{c0:w.mul(o,r),c1:w.mul(o,s),c2:w.mul(o,c)}},fromBytes:n=>{if(n.length!==te.BYTES)throw new Error(`fromBytes wrong length=${n.length}`);return{c0:w.fromBytes(n.subarray(0,w.BYTES)),c1:w.fromBytes(n.subarray(w.BYTES,2*w.BYTES)),c2:w.fromBytes(n.subarray(2*w.BYTES))}},toBytes:({c0:n,c1:e,c2:t})=>Ie(w.toBytes(n),w.toBytes(e),w.toBytes(t)),cmov:({c0:n,c1:e,c2:t},{c0:r,c1:s,c2:c},o)=>({c0:w.cmov(n,r,o),c1:w.cmov(e,s,o),c2:w.cmov(t,c,o)}),fromBigSix:n=>{if(!Array.isArray(n)||n.length!==6)throw new Error("Invalid Fp6 usage");return{c0:w.fromBigTuple(n.slice(0,2)),c1:w.fromBigTuple(n.slice(2,4)),c2:w.fromBigTuple(n.slice(4,6))}},frobeniusMap:({c0:n,c1:e,c2:t},r)=>({c0:w.frobeniusMap(n,r),c1:w.mul(w.frobeniusMap(e,r),ei[r%6]),c2:w.mul(w.frobeniusMap(t,r),ti[r%6])}),mulByNonresidue:({c0:n,c1:e,c2:t})=>({c0:w.mulByNonresidue(t),c1:n,c2:e}),multiplyBy1:({c0:n,c1:e,c2:t},r)=>({c0:w.mulByNonresidue(w.mul(t,r)),c1:w.mul(n,r),c2:w.mul(e,r)}),multiplyBy01({c0:n,c1:e,c2:t},r,s){let c=w.mul(n,r),o=w.mul(e,s);return{c0:w.add(w.mulByNonresidue(w.sub(w.mul(w.add(e,t),s),o)),c),c1:w.sub(w.sub(w.mul(w.add(r,s),w.add(n,e)),c),o),c2:w.add(w.sub(w.mul(w.add(n,t),r),c),o)}},multiplyByFp2:({c0:n,c1:e,c2:t},r)=>({c0:w.mul(n,r),c1:w.mul(e,r),c2:w.mul(t,r)})},ei=[[BigInt("0x1"),BigInt("0x0")],[BigInt("0x0"),BigInt("0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaac")],[BigInt("0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),BigInt("0x0")],[BigInt("0x0"),BigInt("0x1")],[BigInt("0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaac"),BigInt("0x0")],[BigInt("0x0"),BigInt("0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe")]].map(n=>w.fromBigTuple(n)),ti=[[BigInt("0x1"),BigInt("0x0")],[BigInt("0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaad"),BigInt("0x0")],[BigInt("0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaac"),BigInt("0x0")],[BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaa"),BigInt("0x0")],[BigInt("0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),BigInt("0x0")],[BigInt("0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffff"),BigInt("0x0")]].map(n=>w.fromBigTuple(n)),Nr=BigInt("0xd201000000010000"),ni=Wt(Nr),xs=({c0:n,c1:e},{c0:t,c1:r})=>({c0:te.add(n,t),c1:te.add(e,r)}),vs=({c0:n,c1:e},{c0:t,c1:r})=>({c0:te.sub(n,t),c1:te.sub(e,r)}),Bs=({c0:n,c1:e},t)=>{if(typeof t=="bigint")return{c0:te.mul(n,t),c1:te.mul(e,t)};let{c0:r,c1:s}=t,c=te.mul(n,r),o=te.mul(e,s);return{c0:te.add(c,te.mulByNonresidue(o)),c1:te.sub(te.mul(te.add(n,e),te.add(r,s)),te.add(c,o))}},Es=({c0:n,c1:e})=>{let t=te.mul(n,e);return{c0:te.sub(te.sub(te.mul(te.add(te.mulByNonresidue(e),n),te.add(n,e)),t),te.mulByNonresidue(t)),c1:te.add(t,t)}};function Jn(n,e){const t=w.sqr(n),r=w.sqr(e);return{first:w.add(w.mulByNonresidue(r),t),second:w.sub(w.sub(w.sqr(w.add(n,e)),t),r)}}const oe={ORDER:w.ORDER,BITS:2*w.BITS,BYTES:2*w.BYTES,MASK:rn(2*w.BITS),ZERO:{c0:te.ZERO,c1:te.ZERO},ONE:{c0:te.ONE,c1:te.ZERO},create:n=>n,isValid:({c0:n,c1:e})=>te.isValid(n)&&te.isValid(e),is0:({c0:n,c1:e})=>te.is0(n)&&te.is0(e),neg:({c0:n,c1:e})=>({c0:te.neg(n),c1:te.neg(e)}),eql:({c0:n,c1:e},{c0:t,c1:r})=>te.eql(n,t)&&te.eql(e,r),sqrt:()=>{throw new Error("Not implemented")},inv:({c0:n,c1:e})=>{let t=te.inv(te.sub(te.sqr(n),te.mulByNonresidue(te.sqr(e))));return{c0:te.mul(n,t),c1:te.neg(te.mul(e,t))}},div:(n,e)=>oe.mul(n,typeof e=="bigint"?Y.inv(Y.create(e)):oe.inv(e)),pow:(n,e)=>Un(oe,n,e),invertBatch:n=>Mn(oe,n),add:xs,sub:vs,mul:Bs,sqr:Es,addN:xs,subN:vs,mulN:Bs,sqrN:Es,fromBytes:n=>{if(n.length!==oe.BYTES)throw new Error(`fromBytes wrong length=${n.length}`);return{c0:te.fromBytes(n.subarray(0,te.BYTES)),c1:te.fromBytes(n.subarray(te.BYTES))}},toBytes:({c0:n,c1:e})=>Ie(te.toBytes(n),te.toBytes(e)),cmov:({c0:n,c1:e},{c0:t,c1:r},s)=>({c0:te.cmov(n,t,s),c1:te.cmov(e,r,s)}),fromBigTwelve:n=>({c0:te.fromBigSix(n.slice(0,6)),c1:te.fromBigSix(n.slice(6,12))}),frobeniusMap(n,e){const t=te.frobeniusMap(n.c0,e),{c0:r,c1:s,c2:c}=te.frobeniusMap(n.c1,e),o=ri[e%12];return{c0:t,c1:te.create({c0:w.mul(r,o),c1:w.mul(s,o),c2:w.mul(c,o)})}},multiplyBy014:({c0:n,c1:e},t,r,s)=>{let c=te.multiplyBy01(n,t,r),o=te.multiplyBy1(e,s);return{c0:te.add(te.mulByNonresidue(o),c),c1:te.sub(te.sub(te.multiplyBy01(te.add(e,n),t,w.add(r,s)),c),o)}},multiplyByFp2:({c0:n,c1:e},t)=>({c0:te.multiplyByFp2(n,t),c1:te.multiplyByFp2(e,t)}),conjugate:({c0:n,c1:e})=>({c0:n,c1:te.neg(e)}),_cyclotomicSquare:({c0:n,c1:e})=>{const{c0:t,c1:r,c2:s}=n,{c0:c,c1:o,c2:i}=e,{first:l,second:a}=Jn(t,o),{first:d,second:b}=Jn(c,s),{first:_,second:h}=Jn(r,i);let p=w.mulByNonresidue(h);return{c0:te.create({c0:w.add(w.mul(w.sub(l,t),Te),l),c1:w.add(w.mul(w.sub(d,r),Te),d),c2:w.add(w.mul(w.sub(_,s),Te),_)}),c1:te.create({c0:w.add(w.mul(w.add(p,c),Te),p),c1:w.add(w.mul(w.add(a,o),Te),a),c2:w.add(w.mul(w.add(b,i),Te),b)})}},_cyclotomicExp(n,e){let t=oe.ONE;for(let r=ni-1;r>=0;r--)t=oe._cyclotomicSquare(t),Pt(e,r)&&(t=oe.mul(t,n));return t},finalExponentiate:n=>{const e=Nr,t=oe.div(oe.frobeniusMap(n,6),n),r=oe.mul(oe.frobeniusMap(t,2),t),s=oe.conjugate(oe._cyclotomicExp(r,e)),c=oe.mul(oe.conjugate(oe._cyclotomicSquare(r)),s),o=oe.conjugate(oe._cyclotomicExp(c,e)),i=oe.conjugate(oe._cyclotomicExp(o,e)),l=oe.mul(oe.conjugate(oe._cyclotomicExp(i,e)),oe._cyclotomicSquare(s)),a=oe.conjugate(oe._cyclotomicExp(l,e)),d=oe.frobeniusMap(oe.mul(s,i),2),b=oe.frobeniusMap(oe.mul(o,r),3),_=oe.frobeniusMap(oe.mul(l,oe.conjugate(r)),1),h=oe.mul(oe.mul(a,oe.conjugate(c)),r);return oe.mul(oe.mul(oe.mul(d,b),_),h)}},ri=[[BigInt("0x1"),BigInt("0x0")],[BigInt("0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8"),BigInt("0x00fc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3")],[BigInt("0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffff"),BigInt("0x0")],[BigInt("0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2"),BigInt("0x06af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09")],[BigInt("0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),BigInt("0x0")],[BigInt("0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995"),BigInt("0x05b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116")],[BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaa"),BigInt("0x0")],[BigInt("0x00fc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3"),BigInt("0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8")],[BigInt("0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaac"),BigInt("0x0")],[BigInt("0x06af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09"),BigInt("0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2")],[BigInt("0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaad"),BigInt("0x0")],[BigInt("0x05b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116"),BigInt("0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995")]].map(n=>w.fromBigTuple(n)),si=dc(w,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(n=>n.map(e=>w.fromBigTuple(e.map(BigInt))))),ci=dc(Y,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(n=>n.map(e=>BigInt(e)))),oi=uc(w,{A:w.create({c0:Y.create(je),c1:Y.create(BigInt(240))}),B:w.create({c0:Y.create(BigInt(1012)),c1:Y.create(BigInt(1012))}),Z:w.create({c0:Y.create(BigInt(-2)),c1:Y.create(BigInt(-1))})}),fi=uc(Y,{A:Y.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:Y.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:Y.create(BigInt(11))}),Uc=te.create({c0:w.ZERO,c1:w.ONE,c2:w.ZERO}),Mc=oe.create({c0:Uc,c1:te.ZERO}),Kc=oe.create({c0:te.ZERO,c1:Uc}),[li,ii]=oe.invertBatch([Mc,Kc]);function ai(n,e){const t=oe.mul(oe.frobeniusMap(oe.multiplyByFp2(li,n),1),Mc).c0.c0,r=oe.mul(oe.frobeniusMap(oe.multiplyByFp2(ii,e),1),Kc).c0.c0;return[t,r]}function ks(n,e){const t=e.toAffine(),r=ai(t.x,t.y);return new n(r[0],r[1],w.ONE)}const ui=BigInt("0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaac");function di(n,e){return[w.mul(n,ui),w.neg(e)]}function bi(n,e){const t=e.toAffine(),r=di(t.x,t.y);return new n(r[0],r[1],w.ONE)}const er=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:Y.ORDER,m:2,k:128,expand:"xmd",hash:it}),tr=Y.BITS,mr=Y.BITS+1,qn=Y.BITS+2,yr=Y.toBytes(_t(_t(je,mr,!0),qn,!0));function Is(n){n.assertValidity();const e=Y.BYTES;if(n.equals(He.G2.ProjectivePoint.ZERO))return Ie(yr,Re(je,e));const{x:t,y:r}=n.toAffine(),{re:s,im:c}=w.reim(t),{re:o,im:i}=w.reim(r),l=i>je?i*Te:o*Te,a=Boolean(l/Y.ORDER&gt),d=_t(_t(c,381,a),qn,!0),b=s;return Ie(Re(d,e),Re(b,e))}const He=Xl({fields:{Fp:Y,Fp2:w,Fp6:te,Fp12:oe,Fr:ds},G1:{Fp:Y,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:Y.ZERO,b:ln,htfDefaults:{...er,m:1},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(n,e)=>{const t=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),r=new n(Y.mul(e.px,t),e.py,e.pz);return e.multiplyUnsafe(He.params.x).negate().multiplyUnsafe(He.params.x).equals(r)},clearCofactor:(n,e)=>e.multiplyUnsafe(He.params.x).add(e),mapToCurve:n=>{const{x:e,y:t}=fi(Y.create(n[0]));return ci(e,t)},fromBytes:n=>{if(n=n.slice(),n.length===48){const e=Y.ORDER,t=qe(n);if(Pt(t,mr)===gt)return{x:je,y:je};const s=Y.create(t&Y.MASK),c=Y.add(Y.pow(s,Qn),Y.create(He.params.G1b));let o=Y.sqrt(c);if(!o)throw new Error("Invalid compressed G1 point");const i=Pt(t,tr);return o*Te/e!==i&&(o=Y.neg(o)),{x:Y.create(s),y:Y.create(o)}}else if(n.length===96){if(n[0]&1<<6)return He.G1.ProjectivePoint.ZERO.toAffine();const e=qe(n.subarray(0,Y.BYTES)),t=qe(n.subarray(Y.BYTES));return{x:Y.create(e),y:Y.create(t)}}else throw new Error("Invalid point G1, expected 48/96 bytes")},toBytes:(n,e,t)=>{const r=e.equals(n.ZERO),{x:s,y:c}=e.toAffine();if(t){if(r)return yr.slice();const o=Y.ORDER;let i;return i=_t(s,tr,Boolean(c*Te/o)),i=_t(i,qn,!0),Re(i,Y.BYTES)}else return r?Ie(new Uint8Array([64]),new Uint8Array(2*Y.BYTES-1)):Ie(Re(s,Y.BYTES),Re(c,Y.BYTES))}},G2:{Fp:w,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:w.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:w.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:w.ZERO,b:w.fromBigTuple([ln,ln]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...er},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:n=>{const{x:e,y:t}=oi(w.fromBigTuple(n));return si(e,t)},isTorsionFree:(n,e)=>e.multiplyUnsafe(He.params.x).negate().equals(ks(n,e)),clearCofactor:(n,e)=>{const t=He.params.x;let r=e.multiplyUnsafe(t).negate(),s=ks(n,e),c=e.double();return c=bi(n,c),c=c.subtract(s),s=r.add(s),s=s.multiplyUnsafe(t).negate(),c=c.add(s),c=c.subtract(r),c.subtract(e)},fromBytes:n=>{n=n.slice();const e=n[0]&224;if(e===32||e===96||e===224)throw new Error("Invalid encoding flag: "+e);const t=e&128,r=e&64,s=e&32,c=Y.BYTES,o=(i,l,a)=>qe(i.slice(l,a));if(n.length===96&&t){const i=He.params.G2b,l=Y.ORDER;if(n[0]=n[0]&31,r){if(n.reduce((g,y)=>g!==0?y+1:y,0)>0)throw new Error("Invalid compressed G2 point");return{x:w.ZERO,y:w.ZERO}}const a=o(n,0,c),d=o(n,c,2*c),b=w.create({c0:Y.create(d),c1:Y.create(a)}),_=w.add(w.pow(b,Qn),i);let h=w.sqrt(_);const p=h.c1===je?h.c0*Te/l:h.c1*Te/l?gt:je;return h=s>0&&p>0?h:w.neg(h),{x:b,y:h}}else if(n.length===192&&!t){if(n[0]&1<<6)return{x:w.ZERO,y:w.ZERO};const i=o(n,0,c),l=o(n,c,2*c),a=o(n,2*c,3*c),d=o(n,3*c,4*c);return{x:w.fromBigTuple([l,i]),y:w.fromBigTuple([d,a])}}else throw new Error("Invalid point G2, expected 96/192 bytes")},toBytes:(n,e,t)=>{const{BYTES:r,ORDER:s}=Y,c=e.equals(n.ZERO),{x:o,y:i}=e.toAffine();if(t){if(c)return Ie(yr,Re(je,r));const l=Boolean(i.c1===je?i.c0*Te/s:i.c1*Te/s);let a=_t(o.c1,tr,l);return a=_t(a,qn,!0),Ie(Re(a,r),Re(o.c0,r))}else{if(c)return Ie(new Uint8Array([64]),new Uint8Array(4*r-1));const{re:l,im:a}=w.reim(o),{re:d,im:b}=w.reim(i);return Ie(Re(a,r),Re(l,r),Re(b,r),Re(d,r))}},Signature:{fromHex(n){n=ke("signatureHex",n);const e=Y.ORDER,t=n.length/2;if(t!==48&&t!==96)throw new Error("Invalid compressed signature length, must be 96 or 192");const r=qe(n.slice(0,t)),s=qe(n.slice(t));if(Pt(r,mr)===gt)return He.G2.ProjectivePoint.ZERO;const o=Y.create(r&Y.MASK),i=Y.create(s),l=w.create({c0:i,c1:o}),a=w.add(w.pow(l,Qn),He.params.G2b);let d=w.sqrt(a);if(!d)throw new Error("Failed to find a square root");const{re:b,im:_}=w.reim(d),h=Pt(r,381),p=_>je&&_*Te/e!==h,g=_===je&&b*Te/e!==h;(p||g)&&(d=w.neg(d));const y=He.G2.ProjectivePoint.fromAffine({x:l,y:d});return y.assertValidity(),y},toRawBytes(n){return Is(n)},toHex(n){return Ht(Is(n))}}},params:{x:Nr,r:ds.ORDER},htfDefaults:er,hash:it,randomBytes:nn});function hi(n){let e;return{c(){e=u("p"),e.textContent=`${We.NO_MESSAGE}`},m(t,r){F(t,e,r)},p:ge,d(t){t&&z(e)}}}function pi(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A,x,S,C,R;return{c(){e=u("table"),t=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",c=u("td"),o=u("code"),i=W(n[4]),l=O(),a=u("tr"),d=u("td"),d.textContent="x",b=u("td"),_=u("code"),h=W(n[5]),p=W(" +"),g=u("br"),y=u("code"),B=W(n[6]),I=W("i"),k=O(),E=u("tr"),v=u("td"),v.textContent="y",P=u("td"),N=u("code"),T=W(n[7]),M=W(" +"),q=u("br"),H=u("code"),K=W(n[8]),j=W("i"),Z=O(),A=u("tr"),x=u("td"),x.textContent="sigHex",S=u("td"),C=u("code"),R=W(n[9]),m(s,"class","curve-data__key"),m(d,"class","curve-data__key"),m(v,"class","curve-data__key"),m(x,"class","curve-data__key"),m(e,"class","curve-data__table")},m(G,V){F(G,e,V),f(e,t),f(t,r),f(r,s),f(r,c),f(c,o),f(o,i),f(t,l),f(t,a),f(a,d),f(a,b),f(b,_),f(_,h),f(b,p),f(b,g),f(b,y),f(y,B),f(y,I),f(t,k),f(t,E),f(E,v),f(E,P),f(P,N),f(N,T),f(P,M),f(P,q),f(P,H),f(H,K),f(H,j),f(t,Z),f(t,A),f(A,x),f(A,S),f(S,C),f(C,R)},p(G,V){V&16&&J(i,G[4]),V&32&&J(h,G[5]),V&64&&J(B,G[6]),V&128&&J(T,G[7]),V&256&&J(K,G[8]),V&512&&J(R,G[9])},d(G){G&&z(e)}}}function _i(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z;K=new wt({});function A(C,R){return C[0]?pi:hi}let x=A(n),S=x(n);return{c(){e=u("div"),t=u("h4"),t.textContent="Public key G1",r=O(),s=u("table"),c=u("tbody"),o=u("tr"),i=u("td"),i.textContent="x",l=u("td"),a=u("code"),d=W(n[1]),b=O(),_=u("tr"),h=u("td"),h.textContent="y",p=u("td"),g=u("code"),y=W(n[2]),B=O(),I=u("tr"),k=u("td"),k.textContent="hex",E=u("td"),v=u("code"),P=W(n[3]),N=O(),T=u("h4"),T.textContent="Signature G2",M=O(),q=u("div"),q.innerHTML="<small>bls consists of two curves: G1 (ordinary) and G2 (complex numbers). Most implementations use G1 for pubkeys and G2 for signatures. So, signatures will coordinates in form of <code>(x, xi), (y, yi)</code></small>",H=O(),ue(K.$$.fragment),j=O(),S.c(),m(t,"class","curve-data__header"),m(i,"class","curve-data__key"),m(h,"class","curve-data__key"),m(k,"class","curve-data__key"),m(s,"class","curve-data__table"),m(T,"class","curve-data__header"),m(e,"class","curve-data")},m(C,R){F(C,e,R),f(e,t),f(e,r),f(e,s),f(s,c),f(c,o),f(o,i),f(o,l),f(l,a),f(a,d),f(c,b),f(c,_),f(_,h),f(_,p),f(p,g),f(g,y),f(c,B),f(c,I),f(I,k),f(I,E),f(E,v),f(v,P),f(e,N),f(e,T),f(e,M),f(e,q),f(e,H),ie(K,e,null),f(e,j),S.m(e,null),Z=!0},p(C,[R]){(!Z||R&2)&&J(d,C[1]),(!Z||R&4)&&J(y,C[2]),(!Z||R&8)&&J(P,C[3]),x===(x=A(C))&&S?S.p(C,R):(S.d(1),S=x(C),S&&(S.c(),S.m(e,null)))},i(C){Z||(Q(K.$$.fragment,C),Z=!0)},o(C){ne(K.$$.fragment,C),Z=!1},d(C){C&&z(e),ae(K),S.d()}}}function gi(n,e,t){let r,s,c;Se(n,nt,y=>t(11,s=y)),Se(n,Ve,y=>t(12,c=y));let{privKey:o}=e,i,l,a,d,b,_,h,p,g;return Ne(Ve,c=He.CURVE.r,c),n.$$set=y=>{"privKey"in y&&t(10,o=y.privKey)},n.$$.update=()=>{if(n.$$.dirty&2048&&t(0,r=s.length>0),n.$$.dirty&3073){const y=He.getPublicKey(o),B=He.G1.ProjectivePoint.fromHex(y);if(t(1,[i,l]=[B.x,B.y].map(I=>Ke(I)),i,(t(2,l),t(10,o),t(0,r),t(11,s))),t(3,a=Ye(y)),r){const I=it(s),k=He.sign(I,o),E=He.G2.ProjectivePoint.fromHex(k);t(5,[b,_,h,p]=[E.x.c0,E.x.c1,E.y.c0,E.y.c1].map(v=>Ke(v)),b,(t(6,_),t(10,o),t(0,r),t(11,s)),(t(7,h),t(10,o),t(0,r),t(11,s)),(t(8,p),t(10,o),t(0,r),t(11,s))),t(4,d=Ye(I)),t(9,g=Ye(k))}}},[r,i,l,a,d,b,_,h,p,g,o,s]}class mi extends De{constructor(e){super(),Ze(this,e,gi,_i,Le,{privKey:10})}}function Ss(n,e,t){const r=n.slice();return r[18]=e[t],r[20]=t,r}function yi(n){let e;return{c(){e=u("p"),e.textContent=`${wr}`,m(e,"class","error svelte-t5ype6")},m(t,r){F(t,e,r)},p:ge,d(t){t&&z(e)}}}function Cs(n){let e,t;return e=new mn({props:{hash:n[18],checked:n[20]===0}}),e.$on("change",n[11]),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p:ge,i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function wi(n){let e,t,r=n[10],s=[];for(let o=0;o<r.length;o+=1)s[o]=Cs(Ss(n,r,o));const c=o=>ne(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=pt()},m(o,i){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(o,i);F(o,e,i),t=!0},p(o,i){if(i&3072){r=o[10];let l;for(l=0;l<r.length;l+=1){const a=Ss(o,r,l);s[l]?(s[l].p(a,i),Q(s[l],1)):(s[l]=Cs(a),s[l].c(),Q(s[l],1),s[l].m(e.parentNode,e))}for(Qe(),l=r.length;l<s.length;l+=1)c(l);Je()}},i(o){if(!t){for(let i=0;i<r.length;i+=1)Q(s[i]);t=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)ne(s[i]);t=!1},d(o){ht(s,o),o&&z(e)}}}function xi(n){let e;return{c(){e=u("p"),e.textContent=`${We.NO_MESSAGE}`},m(t,r){F(t,e,r)},p:ge,d(t){t&&z(e)}}}function vi(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A;return{c(){e=u("table"),t=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",c=u("td"),o=u("code"),i=W(n[9]),l=O(),a=u("tr"),d=u("td"),d.textContent="r",b=u("td"),_=u("code"),h=W(n[5]),p=O(),g=u("tr"),y=u("td"),y.textContent="s",B=u("td"),I=u("code"),k=W(n[6]),E=O(),v=u("tr"),P=u("td"),P.textContent="compact",N=u("td"),T=u("code"),M=W(n[7]),q=O(),H=u("tr"),K=u("td"),K.textContent="der",j=u("td"),Z=u("code"),A=W(n[8]),m(s,"class","curve-data__key"),m(d,"class","curve-data__key"),m(y,"class","curve-data__key"),m(P,"class","curve-data__key"),m(K,"class","curve-data__key"),m(e,"class","curve-data__table")},m(x,S){F(x,e,S),f(e,t),f(t,r),f(r,s),f(r,c),f(c,o),f(o,i),f(t,l),f(t,a),f(a,d),f(a,b),f(b,_),f(_,h),f(t,p),f(t,g),f(g,y),f(g,B),f(B,I),f(I,k),f(t,E),f(t,v),f(v,P),f(v,N),f(N,T),f(T,M),f(t,q),f(t,H),f(H,K),f(H,j),f(j,Z),f(Z,A)},p(x,S){S&512&&J(i,x[9]),S&32&&J(h,x[5]),S&64&&J(k,x[6]),S&128&&J(M,x[7]),S&256&&J(A,x[8])},d(x){x&&z(e)}}}function Bi(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A,x,S,C,R,G,V,U=wr.length&&yi();S=new wt({}),R=new gn({props:{$$slots:{default:[wi]},$$scope:{ctx:n}}});function D($,re){return $[0]?vi:xi}let L=D(n),X=L(n);return{c(){U&&U.c(),e=O(),t=u("div"),r=u("h4"),r.textContent="Public key",s=O(),c=u("table"),o=u("tbody"),i=u("tr"),l=u("td"),l.textContent="x",a=u("td"),d=u("code"),b=W(n[1]),_=O(),h=u("tr"),p=u("td"),p.textContent="y",g=u("td"),y=u("code"),B=W(n[2]),I=O(),k=u("tr"),E=u("td"),E.textContent="33b hex",v=u("td"),P=u("code"),N=W(n[3]),T=O(),M=u("tr"),q=u("td"),q.textContent="64b hex",H=u("td"),K=u("code"),j=W(n[4]),Z=O(),A=u("h4"),A.textContent="Signature",x=O(),ue(S.$$.fragment),C=O(),ue(R.$$.fragment),G=O(),X.c(),m(r,"class","curve-data__header"),m(l,"class","curve-data__key"),m(p,"class","curve-data__key"),m(E,"class","curve-data__key"),m(q,"class","curve-data__key"),m(c,"class","curve-data__table"),m(A,"class","curve-data__header"),m(t,"class","curve-data")},m($,re){U&&U.m($,re),F($,e,re),F($,t,re),f(t,r),f(t,s),f(t,c),f(c,o),f(o,i),f(i,l),f(i,a),f(a,d),f(d,b),f(o,_),f(o,h),f(h,p),f(h,g),f(g,y),f(y,B),f(o,I),f(o,k),f(k,E),f(k,v),f(v,P),f(P,N),f(o,T),f(o,M),f(M,q),f(M,H),f(H,K),f(K,j),f(t,Z),f(t,A),f(t,x),ie(S,t,null),f(t,C),ie(R,t,null),f(t,G),X.m(t,null),V=!0},p($,[re]){wr.length&&U.p($,re),(!V||re&2)&&J(b,$[1]),(!V||re&4)&&J(B,$[2]),(!V||re&8)&&J(N,$[3]),(!V||re&16)&&J(j,$[4]);const ce={};re&2097152&&(ce.$$scope={dirty:re,ctx:$}),R.$set(ce),L===(L=D($))&&X?X.p($,re):(X.d(1),X=L($),X&&(X.c(),X.m(t,null)))},i($){V||(Q(S.$$.fragment,$),Q(R.$$.fragment,$),V=!0)},o($){ne(S.$$.fragment,$),ne(R.$$.fragment,$),V=!1},d($){U&&U.d($),$&&z(e),$&&z(t),ae(S),ae(R),X.d()}}}let wr="";function Ei(n,e,t){let r,s,c;Se(n,br,v=>t(16,s=v)),Se(n,nt,v=>t(15,c=v));let{privKey:o}=e,{CURVE:i}=e,l,a,d,b,_,h,p,g,y,B="sha256";const I={sha256:it,sha3_256:Pr,keccak_256:Hr},k=Object.keys(I),E=v=>{t(14,B=v.detail)};return n.$$set=v=>{"privKey"in v&&t(12,o=v.privKey),"CURVE"in v&&t(13,i=v.CURVE)},n.$$.update=()=>{if(n.$$.dirty&32768&&t(0,r=c.length>0),n.$$.dirty&61441)try{const v=i.getPublicKey(o),P=i.ProjectivePoint.fromHex(v);if(t(1,[l,a]=[P.x,P.y].map(N=>Ke(N)),l,(t(2,a),t(13,i),t(12,o),t(0,r),t(14,B),t(15,c))),t(3,d=P.toHex(!0)),t(4,b=P.toHex(!1)),r){const N=I[B],T=N(c),M=i.sign(T,o);t(5,[_,h]=[M.r,M.s].map(q=>Ke(q)),_,(t(6,h),t(13,i),t(12,o),t(0,r),t(14,B),t(15,c))),t(7,p=M.toCompactHex()),t(8,g=M.toDERHex()),t(9,y=Ye(T))}}catch(v){Ne(br,s=Ot(v),s)}},[r,l,a,d,b,_,h,p,g,y,k,E,o,i,B,c]}class ki extends De{constructor(e){super(),Ze(this,e,Ei,Bi,Le,{privKey:12,CURVE:13})}}function Ii(n){let e,t,r,s,c,o,i,l,a,d,b,_,h;return{c(){e=u("div"),t=u("div"),r=u("label"),r.innerHTML="<strong>Private key in hex format</strong>",s=O(),c=u("button"),c.textContent="Generate Random",o=O(),i=u("div"),l=u("input"),a=O(),d=u("div"),b=W(n[1]),m(r,"for","priv-key-input"),m(r,"class","priv-key__label svelte-rjm8o7"),m(c,"type","button"),m(c,"class","priv-key__btn button svelte-rjm8o7"),m(t,"class","priv-key__header svelte-rjm8o7"),m(l,"class","text-input"),m(l,"id","priv-key-input"),m(l,"type","text"),m(l,"maxlength",n[0]),l.value=n[2],m(d,"class","error svelte-rjm8o7"),m(e,"class","priv-key svelte-rjm8o7")},m(p,g){F(p,e,g),f(e,t),f(t,r),f(t,s),f(t,c),f(e,o),f(e,i),f(i,l),f(e,a),f(e,d),f(d,b),_||(h=[Ee(c,"click",n[3]),Ee(l,"input",n[4])],_=!0)},p(p,[g]){g&1&&m(l,"maxlength",p[0]),g&4&&l.value!==p[2]&&(l.value=p[2]),g&2&&J(b,p[1])},i:ge,o:ge,d(p){p&&z(e),_=!1,bt(h)}}}function Si(n){return/[^0-9A-Fa-f]/g.test(n)}function Ci(n,e,t){let r,s;Se(n,dt,b=>t(2,r=b)),Se(n,Ve,b=>t(7,s=b));let{keyLength:c}=e,{curve:o}=e,i=o,l="";function a(){const b=window.crypto.getRandomValues(new Uint8Array(c/2));Ne(dt,r=Ye(b),r),t(1,l="")}function d(b){const _=b.target.value,h=o.split("_").join(" ");_.length!==c||Si(_)?t(1,l=`Key must be ${c/2} bytes (${c} hex digits) for ${h}`):BigInt(`0x${_}`)>=s?t(1,l="Key is out of curve's order (n)"):(Ne(dt,r=_,r),t(1,l=""))}return n.$$set=b=>{"keyLength"in b&&t(0,c=b.keyLength),"curve"in b&&t(5,o=b.curve)},n.$$.update=()=>{n.$$.dirty&96&&i!==o&&(t(6,i=o),t(1,l=""))},[c,l,r,a,d,o,i]}class Ai extends De{constructor(e){super(),Ze(this,e,Ci,Ii,Le,{keyLength:0,curve:5})}}function As(n){let e,t;return{c(){e=u("div"),t=W(n[6]),m(e,"class","error svelte-1rwp4r1")},m(r,s){F(r,e,s),f(e,t)},p(r,s){s&64&&J(t,r[6])},d(r){r&&z(e)}}}function Os(n){let e,t;return{c(){e=u("div"),t=W(n[7]),m(e,"class","error svelte-1rwp4r1")},m(r,s){F(r,e,s),f(e,t)},p(r,s){s&128&&J(t,r[7])},d(r){r&&z(e)}}}function Ps(n){let e,t;return{c(){e=u("div"),t=W(n[8]),m(e,"class","error svelte-1rwp4r1")},m(r,s){F(r,e,s),f(e,t)},p(r,s){s&256&&J(t,r[8])},d(r){r&&z(e)}}}function Hs(n){let e,t;return{c(){e=u("div"),t=W(n[9]),m(e,"class","error svelte-1rwp4r1")},m(r,s){F(r,e,s),f(e,t)},p(r,s){s&512&&J(t,r[9])},d(r){r&&z(e)}}}function Rs(n){let e,t;return{c(){e=u("div"),t=W(n[10]),m(e,"class","error svelte-1rwp4r1")},m(r,s){F(r,e,s),f(e,t)},p(r,s){s&1024&&J(t,r[10])},d(r){r&&z(e)}}}function qs(n){let e;return{c(){e=u("small"),e.textContent="(random coordinates for points will be generated)",m(e,"class","create-note svelte-1rwp4r1")},m(t,r){F(t,e,r)},d(t){t&&z(e)}}}function Oi(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A,x,S,C,R,G,V,U,D,L,X,$,re=n[6]&&As(n),ce=n[7]&&Os(n),fe=n[8]&&Ps(n),_e=n[9]&&Hs(n),be=n[10]&&Rs(n),xe=n[0]==2&&qs();return{c(){e=u("h3"),e.textContent="Define custom weierstrass curve",t=O(),r=u("div"),r.innerHTML=`<div class="subheader svelte-1rwp4r1">Curve&#39;s formula is <b>y = x + ax + b</b></div> 
  <div>Generator point (<b>G</b>) used for curve calculator:
    <ul class="curve-desc__coords svelte-1rwp4r1"><li class="svelte-1rwp4r1"><b class="svelte-1rwp4r1">Gx</b>: <code class="svelte-1rwp4r1">0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296</code></li> 
      <li class="svelte-1rwp4r1"><b class="svelte-1rwp4r1">Gy</b>: <code class="svelte-1rwp4r1">0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5</code></li></ul> 
    <b>a</b> and <b>b</b> params must be non-floating point integers. <b>P</b>, <b>n</b> and <b>h</b> must be positive and non-floating point integers.</div>`,s=O(),c=u("div"),o=u("div"),i=u("label"),i.innerHTML="<strong>a</strong> - constant &quot;a&quot;",l=O(),a=u("input"),d=O(),re&&re.c(),b=O(),_=u("div"),h=u("label"),h.innerHTML="<strong>b</strong> - constant &quot;b&quot;",p=O(),g=u("input"),y=O(),ce&&ce.c(),B=O(),I=u("div"),k=u("label"),k.innerHTML="<strong>P</strong> - modulus at <b>y  x + ax + b (mod p)</b>",E=O(),v=u("input"),P=O(),fe&&fe.c(),N=O(),T=u("div"),M=u("label"),M.innerHTML="<strong>n</strong> - curve order, the count of all possible EC points",q=O(),H=u("input"),K=O(),_e&&_e.c(),j=O(),Z=u("div"),A=u("label"),A.innerHTML="<strong>h</strong> - cofactor, the number of subgroups",x=O(),S=u("input"),C=O(),be&&be.c(),R=O(),G=u("div"),V=W(n[11]),U=O(),D=u("button"),D.textContent="Create curve",L=O(),xe&&xe.c(),m(e,"class","header svelte-1rwp4r1"),m(r,"class","curve-desc svelte-1rwp4r1"),m(i,"for","a"),m(i,"class","priv-key__label"),m(a,"class","text-input svelte-1rwp4r1"),m(a,"id","a"),m(a,"type","text"),m(a,"name","a"),m(a,"placeholder","a"),m(o,"class","curve__field svelte-1rwp4r1"),m(h,"for","b"),m(h,"class","priv-key__label"),m(g,"class","text-input svelte-1rwp4r1"),m(g,"id","b"),m(g,"type","text"),m(g,"name","b"),m(g,"placeholder","b"),m(_,"class","curve__field svelte-1rwp4r1"),m(k,"for","P"),m(k,"class","priv-key__label"),m(v,"class","text-input svelte-1rwp4r1"),m(v,"id","P"),m(v,"type","text"),m(v,"name","P"),m(v,"placeholder","P"),m(I,"class","curve__field svelte-1rwp4r1"),m(M,"for","n"),m(M,"class","priv-key__label"),m(H,"class","text-input svelte-1rwp4r1"),m(H,"id","n"),m(H,"type","text"),m(H,"name","n"),m(H,"placeholder","n"),m(T,"class","curve__field svelte-1rwp4r1"),m(A,"for","h"),m(A,"class","priv-key__label"),m(S,"class","text-input svelte-1rwp4r1"),m(S,"id","h"),m(S,"type","text"),m(S,"name","h"),m(S,"placeholder","h"),m(Z,"class","curve__field svelte-1rwp4r1"),m(G,"class","error svelte-1rwp4r1"),m(D,"class","button svelte-1rwp4r1"),m(c,"class","curve svelte-1rwp4r1")},m(se,ye){F(se,e,ye),F(se,t,ye),F(se,r,ye),F(se,s,ye),F(se,c,ye),f(c,o),f(o,i),f(o,l),f(o,a),st(a,n[1]),f(o,d),re&&re.m(o,null),f(c,b),f(c,_),f(_,h),f(_,p),f(_,g),st(g,n[2]),f(_,y),ce&&ce.m(_,null),f(c,B),f(c,I),f(I,k),f(I,E),f(I,v),st(v,n[3]),f(I,P),fe&&fe.m(I,null),f(c,N),f(c,T),f(T,M),f(T,q),f(T,H),st(H,n[4]),f(T,K),_e&&_e.m(T,null),f(c,j),f(c,Z),f(Z,A),f(Z,x),f(Z,S),st(S,n[5]),f(Z,C),be&&be.m(Z,null),f(c,R),f(c,G),f(G,V),f(c,U),f(c,D),f(c,L),xe&&xe.m(c,null),X||($=[Ee(a,"input",n[15]),Ee(g,"input",n[16]),Ee(v,"input",n[17]),Ee(H,"input",n[18]),Ee(S,"input",n[19]),Ee(D,"click",n[12])],X=!0)},p(se,[ye]){ye&2&&a.value!==se[1]&&st(a,se[1]),se[6]?re?re.p(se,ye):(re=As(se),re.c(),re.m(o,null)):re&&(re.d(1),re=null),ye&4&&g.value!==se[2]&&st(g,se[2]),se[7]?ce?ce.p(se,ye):(ce=Os(se),ce.c(),ce.m(_,null)):ce&&(ce.d(1),ce=null),ye&8&&v.value!==se[3]&&st(v,se[3]),se[8]?fe?fe.p(se,ye):(fe=Ps(se),fe.c(),fe.m(I,null)):fe&&(fe.d(1),fe=null),ye&16&&H.value!==se[4]&&st(H,se[4]),se[9]?_e?_e.p(se,ye):(_e=Hs(se),_e.c(),_e.m(T,null)):_e&&(_e.d(1),_e=null),ye&32&&S.value!==se[5]&&st(S,se[5]),se[10]?be?be.p(se,ye):(be=Rs(se),be.c(),be.m(Z,null)):be&&(be.d(1),be=null),ye&2048&&J(V,se[11]),se[0]==2?xe||(xe=qs(),xe.c(),xe.m(c,null)):xe&&(xe.d(1),xe=null)},i:ge,o:ge,d(se){se&&z(e),se&&z(t),se&&z(r),se&&z(s),se&&z(c),re&&re.d(),ce&&ce.d(),fe&&fe.d(),_e&&_e.d(),be&&be.d(),xe&&xe.d(),X=!1,bt($)}}}function Pi(n,e,t){let r,s,c;Se(n,hr,H=>t(13,s=H)),Se(n,br,H=>t(14,c=H));let{demo:o}=e;const i=Tn();let l="",{a,b:d,p:b,n:_,h}=dr;const{Gx:p,Gy:g}=dr;let y="",B="",I="",k="",E="";const v=()=>{if(r)return;if(t(1,a=BigInt(a)),t(2,d=BigInt(d)),t(3,b=BigInt(b)),t(4,_=BigInt(_)),t(5,h=BigInt(h)),we(g**2n,b)!==we(p**3n+a*p+d,b)){t(11,l="Values of a, b, p, Gx, and Gy do not match the equation y  x + ax + b (mod p)");return}let H;try{H=Pc(a,d,b,_,h,p,g)}catch(K){t(11,l=Ot(K));return}t(11,l=""),i("showData",H)};function P(){a=this.value,t(1,a)}function N(){d=this.value,t(2,d)}function T(){b=this.value,t(3,b)}function M(){_=this.value,t(4,_)}function q(){h=this.value,t(5,h)}return n.$$set=H=>{"demo"in H&&t(0,o=H.demo)},n.$$.update=()=>{n.$$.dirty&16385&&o==1&&t(11,l=c),n.$$.dirty&8193&&o==2&&t(11,l=s),n.$$.dirty&62&&(t(6,y=t(7,B=t(8,I=t(9,k=t(10,E=""))))),ur(a)||t(6,y=`a ${We.INT}`),ur(d)||t(7,B=`b ${We.INT}`),Sn(b)||t(8,I=`P ${We.POSITIVE_INT}`),Sn(_)||t(9,k=`n ${We.POSITIVE_INT}`),Sn(h)||t(10,E=`h ${We.POSITIVE_INT}`)),n.$$.dirty&1984&&(r=y.length||B.length||I.length||k.length||E.length)},[o,a,d,b,_,h,y,B,I,k,E,l,v,s,c,P,N,T,M,q]}class Zc extends De{constructor(e){super(),Ze(this,e,Pi,Oi,Le,{demo:0})}}function Ts(n){let e,t;return{c(){e=u("div"),t=W(n[3]),m(e,"class","error svelte-oqfmga")},m(r,s){F(r,e,s),f(e,t)},p(r,s){s&8&&J(t,r[3])},d(r){r&&z(e)}}}function Hi(n){let e,t,r,s,c,o,i,l,a,d,b=n[3].length&&Ts(n);return{c(){e=u("div"),t=u("label"),r=u("strong"),s=W(n[2]),c=O(),o=u("input"),i=O(),b&&b.c(),l=pt(),m(t,"class","point-input__label svelte-oqfmga"),m(t,"for",n[0]),m(o,"class","text-input"),m(o,"id",n[0]),m(o,"type","text"),o.value=n[1],m(e,"class","point-input svelte-oqfmga")},m(_,h){F(_,e,h),f(e,t),f(t,r),f(r,s),f(e,c),f(e,o),F(_,i,h),b&&b.m(_,h),F(_,l,h),a||(d=Ee(o,"input",n[4]),a=!0)},p(_,[h]){h&4&&J(s,_[2]),h&1&&m(t,"for",_[0]),h&1&&m(o,"id",_[0]),h&2&&o.value!==_[1]&&(o.value=_[1]),_[3].length?b?b.p(_,h):(b=Ts(_),b.c(),b.m(l.parentNode,l)):b&&(b.d(1),b=null)},i:ge,o:ge,d(_){_&&z(e),_&&z(i),b&&b.d(_),_&&z(l),a=!1,d()}}}function Ri(n,e,t){const r=Tn();let{field:s}=e,{value:c}=e,{label:o}=e,i="";const l=a=>{const{value:d}=a.target;if(d!=="-"){if(!ur(d)){t(3,i=`${o} should be non floating point integer`);return}t(3,i=""),r("input",{value:d,field:s})}};return n.$$set=a=>{"field"in a&&t(0,s=a.field),"value"in a&&t(1,c=a.value),"label"in a&&t(2,o=a.label)},[s,c,o,i,l]}class ct extends De{constructor(e){super(),Ze(this,e,Ri,Hi,Le,{field:0,value:1,label:2})}}function qi(n){let e,t,r,s,c,o,i;return{c(){e=u("div"),t=u("input"),r=O(),s=u("label"),c=W(n[2]),m(t,"type","radio"),m(t,"name",n[0]),t.value=n[1],m(t,"id",n[1]),t.checked=n[3],m(s,"for",n[1]),m(e,"class","ecc-radio")},m(l,a){F(l,e,a),f(e,t),f(e,r),f(e,s),f(s,c),o||(i=Ee(t,"change",n[5]),o=!0)},p(l,[a]){a&1&&m(t,"name",l[0]),a&2&&(t.value=l[1]),a&2&&m(t,"id",l[1]),a&8&&(t.checked=l[3]),a&4&&J(c,l[2]),a&2&&m(s,"for",l[1])},i:ge,o:ge,d(l){l&&z(e),o=!1,i()}}}function Ti(n,e,t){const r=Tn();let{name:s}=e,{value:c}=e,{title:o}=e,{checked:i=!1}=e;const l=()=>{r("change",c)};return n.$$set=a=>{"name"in a&&t(0,s=a.name),"value"in a&&t(1,c=a.value),"title"in a&&t(2,o=a.title),"checked"in a&&t(3,i=a.checked)},[s,c,o,i,r,l]}class Lr extends De{constructor(e){super(),Ze(this,e,Ti,qi,Le,{name:0,value:1,title:2,checked:3})}}function Ns(n,e,t){const r=n.slice();return r[66]=e[t],r}function Ls(n,e,t){const r=n.slice();return r[69]=e[t],r[71]=t,r}function Gs(n,e,t){const r=n.slice();return r[72]=e[t],r}function Ni(n){let e,t,r=n[66].type+"",s,c,o,i,l,a,d=n[66].list,b=[];for(let p=0;p<d.length;p+=1)b[p]=Ms(Ls(n,d,p));const _=p=>ne(b[p],1,1,()=>{b[p]=null});let h=n[66].type==="ECDSA"&&Ui(n);return{c(){e=u("div"),t=u("div"),s=W(r),c=O(),o=u("div");for(let p=0;p<b.length;p+=1)b[p].c();i=O(),h&&h.c(),l=O(),m(t,"class","curves-list__title"),m(e,"class","curves-list")},m(p,g){F(p,e,g),f(e,t),f(t,s),f(e,c),f(e,o);for(let y=0;y<b.length;y+=1)b[y]&&b[y].m(o,null);f(e,i),h&&h.m(e,null),f(e,l),a=!0},p(p,g){if(g[0]&134217728){d=p[66].list;let y;for(y=0;y<d.length;y+=1){const B=Ls(p,d,y);b[y]?(b[y].p(B,g),Q(b[y],1)):(b[y]=Ms(B),b[y].c(),Q(b[y],1),b[y].m(o,null))}for(Qe(),y=d.length;y<b.length;y+=1)_(y);Je()}p[66].type==="ECDSA"&&h.p(p,g)},i(p){if(!a){for(let g=0;g<d.length;g+=1)Q(b[g]);Q(h),a=!0}},o(p){b=b.filter(Boolean);for(let g=0;g<b.length;g+=1)ne(b[g]);ne(h),a=!1},d(p){p&&z(e),ht(b,p),h&&h.d()}}}function Li(n){let e,t,r,s;return t=new Lr({props:{name:"points_curve",value:`points_${n[66].type}_${n[69]}`,checked:n[66].type=="ECDSA"&&n[71]==0,title:n[69]}}),t.$on("change",n[27]),{c(){e=u("div"),ue(t.$$.fragment),r=O(),m(e,"class","ecc-radio")},m(c,o){F(c,e,o),ie(t,e,null),f(e,r),s=!0},p:ge,i(c){s||(Q(t.$$.fragment,c),s=!0)},o(c){ne(t.$$.fragment,c),s=!1},d(c){c&&z(e),ae(t)}}}function Gi(n){let e,t,r=n[66].options,s=[];for(let o=0;o<r.length;o+=1)s[o]=Us(Gs(n,r,o));const c=o=>ne(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=pt()},m(o,i){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(o,i);F(o,e,i),t=!0},p(o,i){if(i[0]&134217728){r=o[66].options;let l;for(l=0;l<r.length;l+=1){const a=Gs(o,r,l);s[l]?(s[l].p(a,i),Q(s[l],1)):(s[l]=Us(a),s[l].c(),Q(s[l],1),s[l].m(e.parentNode,e))}for(Qe(),l=r.length;l<s.length;l+=1)c(l);Je()}},i(o){if(!t){for(let i=0;i<r.length;i+=1)Q(s[i]);t=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)ne(s[i]);t=!1},d(o){ht(s,o),o&&z(e)}}}function Us(n){let e,t;return e=new Lr({props:{name:"points_curve",value:`points_${n[66].type}_${n[69]}_${n[72]}`,title:`${n[69]} - ${n[72]}`}}),e.$on("change",n[27]),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p:ge,i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function Ms(n){let e,t,r,s;const c=[Gi,Li],o=[];function i(l,a){return l[69]=="bls12-381"?0:1}return e=i(n),t=o[e]=c[e](n),{c(){t.c(),r=pt()},m(l,a){o[e].m(l,a),F(l,r,a),s=!0},p(l,a){t.p(l,a)},i(l){s||(Q(t),s=!0)},o(l){ne(t),s=!1},d(l){o[e].d(l),l&&z(r)}}}function Ui(n){let e,t;return e=new Lr({props:{name:"points_curve",value:"points_custom",title:"create curve"}}),e.$on("change",n[27]),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p:ge,i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function Ks(n){let e,t,r=n[66].type!=="Schnorr"&&Ni(n);return{c(){r&&r.c(),e=pt()},m(s,c){r&&r.m(s,c),F(s,e,c),t=!0},p(s,c){s[66].type!=="Schnorr"&&r.p(s,c)},i(s){t||(Q(r),t=!0)},o(s){ne(r),t=!1},d(s){r&&r.d(s),s&&z(e)}}}function Zs(n){let e,t;return e=new Zc({props:{demo:2}}),e.$on("showData",n[28]),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p:ge,i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function Mi(n){let e,t,r,s;return e=new ct({props:{label:"x",field:"a_x",value:n[0]}}),e.$on("input",n[29]),r=new ct({props:{label:"y",field:"a_y",value:n[1]}}),r.$on("input",n[29]),{c(){ue(e.$$.fragment),t=O(),ue(r.$$.fragment)},m(c,o){ie(e,c,o),F(c,t,o),ie(r,c,o),s=!0},p(c,o){const i={};o[0]&1&&(i.value=c[0]),e.$set(i);const l={};o[0]&2&&(l.value=c[1]),r.$set(l)},i(c){s||(Q(e.$$.fragment,c),Q(r.$$.fragment,c),s=!0)},o(c){ne(e.$$.fragment,c),ne(r.$$.fragment,c),s=!1},d(c){ae(e,c),c&&z(t),ae(r,c)}}}function Ki(n){let e,t,r,s,c,o,i,l,a,d,b,_;return r=new ct({props:{label:"c0",field:"a_x_c0",value:n[6]}}),r.$on("input",n[29]),c=new ct({props:{label:"c1",field:"a_x_c1",value:n[7]}}),c.$on("input",n[29]),a=new ct({props:{label:"c0",field:"a_y_c0",value:n[8]}}),a.$on("input",n[29]),b=new ct({props:{label:"c1",field:"a_y_c1",value:n[9]}}),b.$on("input",n[29]),{c(){e=u("div"),e.innerHTML="<strong>x</strong>",t=O(),ue(r.$$.fragment),s=O(),ue(c.$$.fragment),o=O(),i=u("div"),i.innerHTML="<strong>y</strong>",l=O(),ue(a.$$.fragment),d=O(),ue(b.$$.fragment)},m(h,p){F(h,e,p),F(h,t,p),ie(r,h,p),F(h,s,p),ie(c,h,p),F(h,o,p),F(h,i,p),F(h,l,p),ie(a,h,p),F(h,d,p),ie(b,h,p),_=!0},p(h,p){const g={};p[0]&64&&(g.value=h[6]),r.$set(g);const y={};p[0]&128&&(y.value=h[7]),c.$set(y);const B={};p[0]&256&&(B.value=h[8]),a.$set(B);const I={};p[0]&512&&(I.value=h[9]),b.$set(I)},i(h){_||(Q(r.$$.fragment,h),Q(c.$$.fragment,h),Q(a.$$.fragment,h),Q(b.$$.fragment,h),_=!0)},o(h){ne(r.$$.fragment,h),ne(c.$$.fragment,h),ne(a.$$.fragment,h),ne(b.$$.fragment,h),_=!1},d(h){h&&z(e),h&&z(t),ae(r,h),h&&z(s),ae(c,h),h&&z(o),h&&z(i),h&&z(l),ae(a,h),h&&z(d),ae(b,h)}}}function Ds(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v;const P=[Di,Zi],N=[];function T(M,q){return M[23]?0:1}return p=T(n),g=N[p]=P[p](n),{c(){e=u("div"),t=u("div"),r=u("strong"),r.textContent="Point B",s=O(),c=u("small"),c.textContent="(x, y)",o=O(),i=u("span"),l=u("button"),l.textContent="Base",a=O(),d=u("button"),d.textContent="Zero",b=O(),_=u("button"),_.textContent="Random",h=O(),g.c(),y=O(),B=u("div"),I=W(n[21]),m(l,"class","point-header__btn button svelte-1qrewfu"),m(d,"class","point-header__btn button svelte-1qrewfu"),m(_,"class","point-header__btn button svelte-1qrewfu"),m(i,"class","point-header__btns svelte-1qrewfu"),m(t,"class","point-header svelte-1qrewfu"),m(B,"class","error svelte-1qrewfu"),m(e,"class","fields-block svelte-1qrewfu")},m(M,q){F(M,e,q),f(e,t),f(t,r),f(t,s),f(t,c),f(t,o),f(t,i),f(i,l),f(i,a),f(i,d),f(i,b),f(i,_),f(e,h),N[p].m(e,null),f(e,y),f(e,B),f(B,I),k=!0,E||(v=[Ee(l,"click",n[40]),Ee(d,"click",n[41]),Ee(_,"click",n[42])],E=!0)},p(M,q){let H=p;p=T(M),p===H?N[p].p(M,q):(Qe(),ne(N[H],1,1,()=>{N[H]=null}),Je(),g=N[p],g?g.p(M,q):(g=N[p]=P[p](M),g.c()),Q(g,1),g.m(e,y)),(!k||q[0]&2097152)&&J(I,M[21])},i(M){k||(Q(g),k=!0)},o(M){ne(g),k=!1},d(M){M&&z(e),N[p].d(),E=!1,bt(v)}}}function Zi(n){let e,t,r,s;return e=new ct({props:{label:"x",field:"b_x",value:n[2]}}),e.$on("input",n[29]),r=new ct({props:{label:"y",field:"b_y",value:n[3]}}),r.$on("input",n[29]),{c(){ue(e.$$.fragment),t=O(),ue(r.$$.fragment)},m(c,o){ie(e,c,o),F(c,t,o),ie(r,c,o),s=!0},p(c,o){const i={};o[0]&4&&(i.value=c[2]),e.$set(i);const l={};o[0]&8&&(l.value=c[3]),r.$set(l)},i(c){s||(Q(e.$$.fragment,c),Q(r.$$.fragment,c),s=!0)},o(c){ne(e.$$.fragment,c),ne(r.$$.fragment,c),s=!1},d(c){ae(e,c),c&&z(t),ae(r,c)}}}function Di(n){let e,t,r,s,c,o,i,l,a,d,b,_;return r=new ct({props:{label:"c0",field:"b_x_c0",value:n[10]}}),r.$on("input",n[29]),c=new ct({props:{label:"c1",field:"b_x_c1",value:n[11]}}),c.$on("input",n[29]),a=new ct({props:{label:"c0",field:"b_y_c0",value:n[12]}}),a.$on("input",n[29]),b=new ct({props:{label:"c1",field:"b_y_c1",value:n[13]}}),b.$on("input",n[29]),{c(){e=u("div"),e.innerHTML="<strong>x</strong>",t=O(),ue(r.$$.fragment),s=O(),ue(c.$$.fragment),o=O(),i=u("div"),i.innerHTML="<strong>y</strong>",l=O(),ue(a.$$.fragment),d=O(),ue(b.$$.fragment)},m(h,p){F(h,e,p),F(h,t,p),ie(r,h,p),F(h,s,p),ie(c,h,p),F(h,o,p),F(h,i,p),F(h,l,p),ie(a,h,p),F(h,d,p),ie(b,h,p),_=!0},p(h,p){const g={};p[0]&1024&&(g.value=h[10]),r.$set(g);const y={};p[0]&2048&&(y.value=h[11]),c.$set(y);const B={};p[0]&4096&&(B.value=h[12]),a.$set(B);const I={};p[0]&8192&&(I.value=h[13]),b.$set(I)},i(h){_||(Q(r.$$.fragment,h),Q(c.$$.fragment,h),Q(a.$$.fragment,h),Q(b.$$.fragment,h),_=!0)},o(h){ne(r.$$.fragment,h),ne(c.$$.fragment,h),ne(a.$$.fragment,h),ne(b.$$.fragment,h),_=!1},d(h){h&&z(e),h&&z(t),ae(r,h),h&&z(s),ae(c,h),h&&z(o),h&&z(i),h&&z(l),ae(a,h),h&&z(d),ae(b,h)}}}function js(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g;return{c(){e=u("div"),t=u("div"),t.innerHTML=`<strong>Scalar</strong> 
      <small>(number used for multiply operation)</small>`,r=O(),s=u("div"),c=u("input"),o=O(),i=u("div"),l=u("input"),a=O(),d=u("label"),d.textContent="Is hex",b=O(),_=u("div"),h=W(n[22]),m(t,"class","point-header svelte-1qrewfu"),m(c,"class","text-input"),m(c,"id","scalar"),m(c,"type","text"),c.value=n[18],m(s,"class","point-input svelte-1qrewfu"),m(l,"id","scalar-hex"),m(l,"class","scalar-checkbox svelte-1qrewfu"),m(l,"type","checkbox"),m(d,"for","scalar-hex"),m(_,"class","error svelte-1qrewfu"),m(e,"class","fields-block svelte-1qrewfu")},m(y,B){F(y,e,B),f(e,t),f(e,r),f(e,s),f(s,c),f(e,o),f(e,i),f(i,l),f(i,a),f(i,d),f(e,b),f(e,_),f(_,h),p||(g=[Ee(c,"input",n[30]),Ee(l,"click",n[31])],p=!0)},p(y,B){B[0]&262144&&c.value!==y[18]&&(c.value=y[18]),B[0]&4194304&&J(h,y[22])},d(y){y&&z(e),p=!1,bt(g)}}}function ji(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p;return{c(){e=u("table"),t=u("tr"),r=u("td"),r.innerHTML="<strong>x:</strong>",s=O(),c=u("td"),o=u("code"),i=W(n[4]),l=O(),a=u("tr"),d=u("td"),d.innerHTML="<strong>y:</strong>",b=O(),_=u("td"),h=u("code"),p=W(n[5]),m(r,"class","result__col result__col_title svelte-1qrewfu"),m(o,"class","svelte-1qrewfu"),m(c,"class","result__col svelte-1qrewfu"),m(t,"class","result__row"),m(d,"class","result__col result__col_title svelte-1qrewfu"),m(h,"class","svelte-1qrewfu"),m(_,"class","result__col svelte-1qrewfu"),m(a,"class","result__row"),m(e,"class","result")},m(g,y){F(g,e,y),f(e,t),f(t,r),f(t,s),f(t,c),f(c,o),f(o,i),f(e,l),f(e,a),f(a,d),f(a,b),f(a,_),f(_,h),f(h,p)},p(g,y){y[0]&16&&J(i,g[4]),y[0]&32&&J(p,g[5])},d(g){g&&z(e)}}}function Vi(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A,x;return{c(){e=u("table"),t=u("tr"),t.innerHTML='<td colspan="2"><strong>x</strong></td>',r=O(),s=u("tr"),c=u("td"),c.innerHTML="<strong>c0:</strong>",o=O(),i=u("td"),l=u("code"),a=W(n[14]),d=O(),b=u("tr"),_=u("td"),_.innerHTML="<strong>c1:</strong>",h=O(),p=u("td"),g=u("code"),y=W(n[15]),B=O(),I=u("tr"),I.innerHTML='<td colspan="2"><strong>y</strong></td>',k=O(),E=u("tr"),v=u("td"),v.innerHTML="<strong>c0:</strong>",P=O(),N=u("td"),T=u("code"),M=W(n[16]),q=O(),H=u("tr"),K=u("td"),K.innerHTML="<strong>c1:</strong>",j=O(),Z=u("td"),A=u("code"),x=W(n[17]),m(c,"class","result__col result__col_title svelte-1qrewfu"),m(l,"class","svelte-1qrewfu"),m(i,"class","result__col svelte-1qrewfu"),m(s,"class","result__row"),m(_,"class","result__col result__col_title svelte-1qrewfu"),m(g,"class","svelte-1qrewfu"),m(p,"class","result__col svelte-1qrewfu"),m(b,"class","result__row"),m(v,"class","result__col result__col_title svelte-1qrewfu"),m(T,"class","svelte-1qrewfu"),m(N,"class","result__col svelte-1qrewfu"),m(E,"class","result__row"),m(K,"class","result__col result__col_title svelte-1qrewfu"),m(A,"class","svelte-1qrewfu"),m(Z,"class","result__col svelte-1qrewfu"),m(H,"class","result__row"),m(e,"class","result")},m(S,C){F(S,e,C),f(e,t),f(e,r),f(e,s),f(s,c),f(s,o),f(s,i),f(i,l),f(l,a),f(e,d),f(e,b),f(b,_),f(b,h),f(b,p),f(p,g),f(g,y),f(e,B),f(e,I),f(e,k),f(e,E),f(E,v),f(E,P),f(E,N),f(N,T),f(T,M),f(e,q),f(e,H),f(H,K),f(H,j),f(H,Z),f(Z,A),f(A,x)},p(S,C){C[0]&16384&&J(a,S[14]),C[0]&32768&&J(y,S[15]),C[0]&65536&&J(M,S[16]),C[0]&131072&&J(x,S[17])},d(S){S&&z(e)}}}function Yi(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A,x,S,C,R,G,V,U,D,L,X,$,re,ce,fe,_e,be,xe,se,ye,et,at,rt=Rn,Be=[];for(let ee=0;ee<rt.length;ee+=1)Be[ee]=Ks(Ns(n,rt,ee));const Rt=ee=>ne(Be[ee],1,1,()=>{Be[ee]=null});let Ae=n[26]&&Zs(n);const xt=[Ki,Mi],ze=[];function Fe(ee,de){return ee[23]?0:1}B=Fe(n),I=ze[B]=xt[B](n);let Ce=n[25]&&Ds(n),Ge=n[24]&&js(n);function Mt(ee,de){return ee[23]?Vi:ji}let vt=Mt(n),Xe=vt(n);return{c(){e=u("div");for(let ee=0;ee<Be.length;ee+=1)Be[ee].c();t=O(),Ae&&Ae.c(),r=O(),s=u("div"),c=u("div"),o=u("strong"),o.textContent="Point A",i=O(),l=u("small"),l.textContent="(x, y)",a=O(),d=u("span"),b=u("button"),b.textContent="Base",_=O(),h=u("button"),h.textContent="Zero",p=O(),g=u("button"),g.textContent="Random",y=O(),I.c(),k=O(),E=u("div"),v=W(n[20]),P=O(),N=u("div"),T=u("span"),M=u("input"),q=O(),H=u("label"),H.textContent="Add",K=O(),j=u("span"),Z=u("input"),A=O(),x=u("label"),x.textContent="Subtract",S=O(),C=u("span"),R=u("input"),G=O(),V=u("label"),V.textContent="Multiply",U=O(),Ce&&Ce.c(),D=O(),Ge&&Ge.c(),L=O(),X=u("div"),$=u("button"),$.textContent="Calculate",re=O(),ce=u("div"),fe=W(n[19]),_e=O(),be=u("div"),be.innerHTML=`<strong>Result C</strong> 
  <small>(x, y)</small>`,xe=O(),Xe.c(),se=pt(),m(e,"class","curves-list-container svelte-1qrewfu"),m(b,"class","point-header__btn button svelte-1qrewfu"),m(h,"class","point-header__btn button svelte-1qrewfu"),m(g,"class","point-header__btn button svelte-1qrewfu"),m(d,"class","point-header__btns svelte-1qrewfu"),m(c,"class","point-header svelte-1qrewfu"),m(E,"class","error svelte-1qrewfu"),m(s,"class","fields-block svelte-1qrewfu"),m(M,"type","radio"),m(M,"name","operation"),M.value="add",m(M,"id","add"),M.checked=!0,m(H,"for","add"),m(T,"class","operation svelte-1qrewfu"),m(Z,"type","radio"),m(Z,"name","operation"),Z.value="subtract",m(Z,"id","subtract"),m(x,"for","subtract"),m(j,"class","operation svelte-1qrewfu"),m(R,"type","radio"),m(R,"name","operation"),R.value="multiply",m(R,"id","multiply"),m(V,"for","multiply"),m(C,"class","operation svelte-1qrewfu"),m(N,"class","operations svelte-1qrewfu"),m($,"class","button"),m(X,"class","operations svelte-1qrewfu"),m(ce,"class","error svelte-1qrewfu"),m(be,"class","point-header svelte-1qrewfu")},m(ee,de){F(ee,e,de);for(let ot=0;ot<Be.length;ot+=1)Be[ot]&&Be[ot].m(e,null);F(ee,t,de),Ae&&Ae.m(ee,de),F(ee,r,de),F(ee,s,de),f(s,c),f(c,o),f(c,i),f(c,l),f(c,a),f(c,d),f(d,b),f(d,_),f(d,h),f(d,p),f(d,g),f(s,y),ze[B].m(s,null),f(s,k),f(s,E),f(E,v),F(ee,P,de),F(ee,N,de),f(N,T),f(T,M),f(T,q),f(T,H),f(N,K),f(N,j),f(j,Z),f(j,A),f(j,x),f(N,S),f(N,C),f(C,R),f(C,G),f(C,V),F(ee,U,de),Ce&&Ce.m(ee,de),F(ee,D,de),Ge&&Ge.m(ee,de),F(ee,L,de),F(ee,X,de),f(X,$),F(ee,re,de),F(ee,ce,de),f(ce,fe),F(ee,_e,de),F(ee,be,de),F(ee,xe,de),Xe.m(ee,de),F(ee,se,de),ye=!0,et||(at=[Ee(b,"click",n[37]),Ee(h,"click",n[38]),Ee(g,"click",n[39]),Ee(M,"change",n[35]),Ee(Z,"change",n[35]),Ee(R,"change",n[35]),Ee($,"click",n[36])],et=!0)},p(ee,de){if(de[0]&134217728){rt=Rn;let Ue;for(Ue=0;Ue<rt.length;Ue+=1){const he=Ns(ee,rt,Ue);Be[Ue]?(Be[Ue].p(he,de),Q(Be[Ue],1)):(Be[Ue]=Ks(he),Be[Ue].c(),Q(Be[Ue],1),Be[Ue].m(e,null))}for(Qe(),Ue=rt.length;Ue<Be.length;Ue+=1)Rt(Ue);Je()}ee[26]?Ae?(Ae.p(ee,de),de[0]&67108864&&Q(Ae,1)):(Ae=Zs(ee),Ae.c(),Q(Ae,1),Ae.m(r.parentNode,r)):Ae&&(Qe(),ne(Ae,1,1,()=>{Ae=null}),Je());let ot=B;B=Fe(ee),B===ot?ze[B].p(ee,de):(Qe(),ne(ze[ot],1,1,()=>{ze[ot]=null}),Je(),I=ze[B],I?I.p(ee,de):(I=ze[B]=xt[B](ee),I.c()),Q(I,1),I.m(s,k)),(!ye||de[0]&1048576)&&J(v,ee[20]),ee[25]?Ce?(Ce.p(ee,de),de[0]&33554432&&Q(Ce,1)):(Ce=Ds(ee),Ce.c(),Q(Ce,1),Ce.m(D.parentNode,D)):Ce&&(Qe(),ne(Ce,1,1,()=>{Ce=null}),Je()),ee[24]?Ge?Ge.p(ee,de):(Ge=js(ee),Ge.c(),Ge.m(L.parentNode,L)):Ge&&(Ge.d(1),Ge=null),(!ye||de[0]&524288)&&J(fe,ee[19]),vt===(vt=Mt(ee))&&Xe?Xe.p(ee,de):(Xe.d(1),Xe=vt(ee),Xe&&(Xe.c(),Xe.m(se.parentNode,se)))},i(ee){if(!ye){for(let de=0;de<rt.length;de+=1)Q(Be[de]);Q(Ae),Q(I),Q(Ce),ye=!0}},o(ee){Be=Be.filter(Boolean);for(let de=0;de<Be.length;de+=1)ne(Be[de]);ne(Ae),ne(I),ne(Ce),ye=!1},d(ee){ee&&z(e),ht(Be,ee),ee&&z(t),Ae&&Ae.d(ee),ee&&z(r),ee&&z(s),ze[B].d(),ee&&z(P),ee&&z(N),ee&&z(U),Ce&&Ce.d(ee),ee&&z(D),Ge&&Ge.d(ee),ee&&z(L),ee&&z(X),ee&&z(re),ee&&z(ce),ee&&z(_e),ee&&z(be),ee&&z(xe),Xe.d(ee),ee&&z(se),et=!1,bt(at)}}}const zi="number must be positive and non-floating point integer, for hex click checkbox above",Fi="number must be a hex number, for decimals uncheck checkbox above";function Xi(n,e,t){let r;Se(n,hr,he=>t(47,r=he));let s=$e.ProjectivePoint,c=$e;const{a:o,b:i,p:l,n:a,h:d,Gx:b,Gy:_}=dr;let h="",p="",g="",y="",B="",I="",k="",E="",v="",P="",N="",T="",M="",q="",H="",K="",j="",Z="",A="31415",x="",S="",C="",R="",G=!1,V=!1,U=!0,D="add",L=!1,X=!1;Jc(()=>{Fe("A"),Fe("B")});const $=he=>{const pe=he.detail.toLowerCase().split("points_")[1];switch(pe){case"ecdsa_secp256k1":c=$e,s=$e.ProjectivePoint;break;case"ecdsa_p256":c=Gt,s=Gt.ProjectivePoint;break;case"ecdsa_p384":c=Vt,s=Vt.ProjectivePoint;break;case"ecdsa_p521":c=Yt,s=Yt.ProjectivePoint;break;case"eddsa_ed25519":c=zt,s=zt.ExtendedPoint;break;case"eddsa_ed448":c=Ft,s=Ft.ExtendedPoint;break;case"bls_bls12-381_g1":c=He,s=He.G1.ProjectivePoint;break;case"bls_bls12-381_g2":c=He,s=He.G2.ProjectivePoint;break;case"custom":try{c=Pc(o,i,l,a,d,b,_),s=c.ProjectivePoint}catch(le){Ne(hr,r=Ot(le),r)}break;default:c=$e,s=$e.ProjectivePoint;break}t(23,G=pe==="bls_bls12-381_g2"),t(26,X=pe==="custom"),Fe("A"),Fe("B"),Ce()},re=he=>{c=he.detail,s=c.ProjectivePoint,Fe("A"),Fe("B"),Ce()},ce=he=>{const pe=s.fromAffine(he);try{pe.assertValidity()}catch(le){if(le.message!=="bad point: ZERO")throw le}return pe},fe=()=>G?{x:{c0:BigInt(k),c1:BigInt(E)},y:{c0:BigInt(v),c1:BigInt(P)}}:{x:BigInt(h),y:BigInt(p)},_e=()=>G?{x:{c0:BigInt(N),c1:BigInt(T)},y:{c0:BigInt(M),c1:BigInt(q)}}:{x:BigInt(g),y:BigInt(y)},be=()=>{let he,pe;t(20,S=t(21,C=""));try{const le=fe();he=ce(le)}catch(le){t(20,S=Ot(le))}try{const le=_e();pe=ce(le)}catch(le){t(21,C=Ot(le))}return[he,pe]},xe=()=>{const[he,pe]=be();if(!(!he||!pe)){t(19,x="");try{const le=he.add(pe);Ae(le)}catch(le){t(19,x=Ot(le))}}},se=()=>{const[he,pe]=be();if(!(!he||!pe)){t(19,x="");try{const le=he.subtract(pe);Ae(le)}catch(le){t(19,x=Ot(le))}}},ye=()=>{if(!R){t(19,x="");try{const he=fe(),pe=ce(he),le=BigInt(L?`0x${A}`:A),qt=pe.multiply(le);Ae(qt)}catch(he){t(19,x=Ot(he))}}},et=he=>{const{field:pe,value:le}=he.detail;pe==="a_x"&&t(0,h=le),pe==="a_y"&&t(1,p=le),pe==="b_x"&&t(2,g=le),pe==="b_y"&&t(3,y=le),pe==="a_x_c0"&&t(6,k=le),pe==="a_x_c1"&&t(7,E=le),pe==="a_y_c0"&&t(8,v=le),pe==="a_y_c1"&&t(9,P=le),pe==="b_x_c0"&&t(10,N=le),pe==="b_x_c1"&&t(11,T=le),pe==="b_y_c0"&&t(12,M=le),pe==="b_y_c1"&&t(13,q=le)},at=he=>{t(18,A=he.target.value),Be()},rt=he=>{L=he.target.checked,Be()},Be=()=>{if(L){if(Ef(A)){t(22,R=Fi);return}}else if(!Sn(A)){t(22,R=zi);return}t(22,R="")},Rt=(he,pe)=>{const le=he.toAffine();if(G){const[qt,cn,wn,Gr]=[le.x.c0,le.x.c1,le.y.c0,le.y.c1].map(Dc=>Ke(Dc));pe==="A"?t(6,[k,E,v,P]=[qt,cn,wn,Gr],k,t(7,E),t(8,v),t(9,P)):t(10,[N,T,M,q]=[qt,cn,wn,Gr],N,t(11,T),t(12,M),t(13,q))}else{const[qt,cn]=[le.x,le.y].map(wn=>Ke(wn));pe==="A"?t(0,[h,p]=[qt,cn],h,t(1,p)):pe==="B"&&t(2,[g,y]=[qt,cn],g,t(3,y))}},Ae=he=>{const pe=he.toAffine();G?t(14,[H,K,j,Z]=[pe.x.c0,pe.x.c1,pe.y.c0,pe.y.c1].map(le=>Ke(le)),H,t(15,K),t(16,j),t(17,Z)):t(4,[B,I]=[pe.x,pe.y].map(le=>Ke(le)),B,t(5,I))},xt=he=>{Rt(s.BASE,he)},ze=he=>{Rt(s.ZERO,he)},Fe=he=>{const pe=c.utils.randomPrivateKey(),le=s.fromPrivateKey(pe);Rt(le,he)},Ce=()=>{t(4,B=t(5,I=t(14,H=t(15,K=t(16,j=t(17,Z=""))))))};return[h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K,j,Z,A,x,S,C,R,G,V,U,X,$,re,et,at,rt,xt,ze,Fe,he=>{D=he.target.value,t(24,V=D==="multiply"),t(25,U=!V),t(20,S=t(21,C=t(22,R="")))},()=>{D==="add"?xe():D==="subtract"?se():D==="multiply"&&ye()},()=>xt("A"),()=>ze("A"),()=>Fe("A"),()=>xt("B"),()=>ze("B"),()=>Fe("B")]}class $i extends De{constructor(e){super(),Ze(this,e,Xi,Yi,Le,{},null,[-1,-1,-1])}}function Vs(n,e,t){const r=n.slice();return r[10]=e[t],r}function Ys(n,e,t){const r=n.slice();return r[13]=e[t],r[15]=t,r}function Wi(n){let e;return{c(){e=W("Show apps")},m(t,r){F(t,e,r)},d(t){t&&z(e)}}}function Qi(n){let e;return{c(){e=W("Hide apps")},m(t,r){F(t,e,r)},d(t){t&&z(e)}}}function zs(n){let e,t,r,s,c=n[13]+"",o,i,l;return{c(){e=u("div"),t=u("input"),r=O(),s=u("label"),o=W(c),m(t,"type","radio"),m(t,"name","curve"),t.value=n[13],m(t,"id",`${n[10].type}_${n[13]}`),t.checked=n[10].type=="ECDSA"&&n[15]==0,m(s,"for",`${n[10].type}_${n[13]}`),m(e,"class","ecc-radio")},m(a,d){F(a,e,d),f(e,t),f(e,r),f(e,s),f(s,o),i||(l=Ee(t,"change",n[6]),i=!0)},p:ge,d(a){a&&z(e),i=!1,l()}}}function Ji(n){let e,t,r,s,c,o;return{c(){e=u("div"),t=u("input"),r=O(),s=u("label"),s.textContent="create curve",m(t,"type","radio"),m(t,"name","curve"),t.value="custom",m(t,"id","custom"),m(s,"for","custom"),m(e,"class","ecc-radio")},m(i,l){F(i,e,l),f(e,t),f(e,r),f(e,s),c||(o=Ee(t,"change",n[6]),c=!0)},p:ge,d(i){i&&z(e),c=!1,o()}}}function Fs(n){let e,t,r=n[10].type+"",s,c,o,i,l,a=n[10].list,d=[];for(let _=0;_<a.length;_+=1)d[_]=zs(Ys(n,a,_));let b=n[10].type==="ECDSA"&&Ji(n);return{c(){e=u("div"),t=u("div"),s=W(r),c=O(),o=u("div");for(let _=0;_<d.length;_+=1)d[_].c();i=O(),b&&b.c(),l=O(),m(t,"class","curves-list__title"),m(e,"class","curves-list")},m(_,h){F(_,e,h),f(e,t),f(t,s),f(e,c),f(e,o);for(let p=0;p<d.length;p+=1)d[p]&&d[p].m(o,null);f(o,i),b&&b.m(o,null),f(e,l)},p(_,h){if(h&64){a=_[10].list;let p;for(p=0;p<a.length;p+=1){const g=Ys(_,a,p);d[p]?d[p].p(g,h):(d[p]=zs(g),d[p].c(),d[p].m(o,i))}for(;p<d.length;p+=1)d[p].d(1);d.length=a.length}_[10].type==="ECDSA"&&b.p(_,h)},d(_){_&&z(e),ht(d,_),b&&b.d()}}}function Xs(n){let e,t;return e=new Zc({props:{demo:1}}),e.$on("showData",n[7]),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p:ge,i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function ea(n){let e,t;return e=new ki({props:{CURVE:n[1],privKey:n[5]}}),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p(r,s){const c={};s&2&&(c.CURVE=r[1]),s&32&&(c.privKey=r[5]),e.$set(c)},i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function ta(n){let e,t;return e=new mi({props:{privKey:n[5]}}),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p(r,s){const c={};s&32&&(c.privKey=r[5]),e.$set(c)},i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function na(n){let e,t;return e=new Fl({props:{privKey:n[5]}}),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p(r,s){const c={};s&32&&(c.privKey=r[5]),e.$set(c)},i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function ra(n){let e,t;return e=new Rl({props:{privKey:n[5]}}),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p(r,s){const c={};s&32&&(c.privKey=r[5]),e.$set(c)},i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function sa(n){let e,t;return e=new gl({props:{privKey:n[5]}}),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p(r,s){const c={};s&32&&(c.privKey=r[5]),e.$set(c)},i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function ca(n){let e,t;return e=new dl({props:{privKey:n[5]}}),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p(r,s){const c={};s&32&&(c.privKey=r[5]),e.$set(c)},i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function oa(n){let e,t;return e=new cl({props:{privKey:n[5]}}),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p(r,s){const c={};s&32&&(c.privKey=r[5]),e.$set(c)},i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function fa(n){let e,t;return e=new zf({props:{privKey:n[5]}}),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p(r,s){const c={};s&32&&(c.privKey=r[5]),e.$set(c)},i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function la(n){let e,t;return e=new Uf({props:{privKey:n[5]}}),{c(){ue(e.$$.fragment)},m(r,s){ie(e,r,s),t=!0},p(r,s){const c={};s&32&&(c.privKey=r[5]),e.$set(c)},i(r){t||(Q(e.$$.fragment,r),t=!0)},o(r){ne(e.$$.fragment,r),t=!1},d(r){ae(e,r)}}}function ia(n){let e,t,r,s,c,o,i,l,a,d,b,_,h,p,g,y,B,I,k,E,v,P,N,T,M,q,H,K;function j(U,D){return U[4]?Qi:Wi}let Z=j(n),A=Z(n);d=new Ai({props:{curve:n[3],keyLength:n[2]}});let x=Rn,S=[];for(let U=0;U<x.length;U+=1)S[U]=Fs(Vs(n,x,U));let C=n[0]&&Xs(n);const R=[la,fa,oa,ca,sa,ra,na,ta,ea],G=[];function V(U,D){return U[3]=="ecdsa_secp256k1"?0:U[3]=="ecdsa_p256"?1:U[3]=="ecdsa_p384"?2:U[3]=="ecdsa_p521"?3:U[3]=="schnorr_secp256k1"?4:U[3]=="eddsa_ed25519"?5:U[3]=="eddsa_ed448"?6:U[3]=="bls_bls12-381"?7:U[3]=="custom"?8:-1}return~(g=V(n))&&(y=G[g]=R[g](n)),T=new $i({}),{c(){e=u("button"),A.c(),t=O(),r=u("div"),s=u("hr"),c=O(),o=u("h3"),o.textContent="App I: Elliptic curve calculator",i=O(),l=u("p"),l.textContent="Calculate public keys and signatures with noble.",a=O(),ue(d.$$.fragment),b=O(),_=u("div");for(let U=0;U<S.length;U+=1)S[U].c();h=O(),C&&C.c(),p=O(),y&&y.c(),I=O(),k=u("div"),E=u("h3"),E.textContent="App II: Elliptic curve point operations",v=O(),P=u("p"),P.textContent="Add, subtract, multiply points on the chosen elliptic curve.",N=O(),ue(T.$$.fragment),m(o,"id","demo-name"),m(_,"class","curves-list-container"),m(r,"class","noble-demo"),r.hidden=B=!n[4],m(E,"class","header"),m(P,"class","subheader"),m(k,"class","noble-demo"),k.hidden=M=!n[4]},m(U,D){F(U,e,D),A.m(e,null),F(U,t,D),F(U,r,D),f(r,s),f(r,c),f(r,o),f(r,i),f(r,l),f(r,a),ie(d,r,null),f(r,b),f(r,_);for(let L=0;L<S.length;L+=1)S[L]&&S[L].m(_,null);f(r,h),C&&C.m(r,null),f(r,p),~g&&G[g].m(r,null),F(U,I,D),F(U,k,D),f(k,E),f(k,v),f(k,P),f(k,N),ie(T,k,null),q=!0,H||(K=Ee(e,"click",n[8]),H=!0)},p(U,[D]){Z!==(Z=j(U))&&(A.d(1),A=Z(U),A&&(A.c(),A.m(e,null)));const L={};if(D&8&&(L.curve=U[3]),D&4&&(L.keyLength=U[2]),d.$set(L),D&64){x=Rn;let $;for($=0;$<x.length;$+=1){const re=Vs(U,x,$);S[$]?S[$].p(re,D):(S[$]=Fs(re),S[$].c(),S[$].m(_,null))}for(;$<S.length;$+=1)S[$].d(1);S.length=x.length}U[0]?C?(C.p(U,D),D&1&&Q(C,1)):(C=Xs(U),C.c(),Q(C,1),C.m(r,p)):C&&(Qe(),ne(C,1,1,()=>{C=null}),Je());let X=g;g=V(U),g===X?~g&&G[g].p(U,D):(y&&(Qe(),ne(G[X],1,1,()=>{G[X]=null}),Je()),~g?(y=G[g],y?y.p(U,D):(y=G[g]=R[g](U),y.c()),Q(y,1),y.m(r,null)):y=null),(!q||D&16&&B!==(B=!U[4]))&&(r.hidden=B),(!q||D&16&&M!==(M=!U[4]))&&(k.hidden=M)},i(U){q||(Q(d.$$.fragment,U),Q(C),Q(y),Q(T.$$.fragment,U),q=!0)},o(U){ne(d.$$.fragment,U),ne(C),ne(y),ne(T.$$.fragment,U),q=!1},d(U){U&&z(e),A.d(),U&&z(t),U&&z(r),ae(d),ht(S,U),C&&C.d(),~g&&G[g].d(),U&&z(I),U&&z(k),ae(T),H=!1,K()}}}function aa(n,e,t){let r,s;Se(n,dt,h=>t(5,r=h)),Se(n,nt,h=>t(9,s=h)),Ne(dt,r=vn,r),Ne(nt,s="greetings from noble",s);let c=!1,o=Gt,i=vn.length,l="ecdsa_secp256k1",a=!1;const d=h=>{t(3,l=h.target.id.toLowerCase()),l==="ecdsa_p384"?Ne(dt,r=kf,r):l==="ecdsa_p521"?Ne(dt,r=Sf,r):l==="eddsa_ed448"?Ne(dt,r=If,r):Ne(dt,r=vn,r),t(2,i=r.length),t(0,c=l==="custom")},b=h=>{t(1,o=h.detail),t(3,l="custom"),Ne(dt,r=vn,r),t(2,i=r.length)};function _(){t(4,a=!a)}return[c,o,i,l,a,r,d,b,_]}class ua extends De{constructor(e){super(),Ze(this,e,aa,ia,Le,{})}}new ua({target:document.querySelector("#noble-demos")});
